(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Qy={exports:{}},ac={},Yy={exports:{}},ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lo=Symbol.for("react.element"),v1=Symbol.for("react.portal"),x1=Symbol.for("react.fragment"),_1=Symbol.for("react.strict_mode"),w1=Symbol.for("react.profiler"),E1=Symbol.for("react.provider"),I1=Symbol.for("react.context"),T1=Symbol.for("react.forward_ref"),N1=Symbol.for("react.suspense"),b1=Symbol.for("react.memo"),S1=Symbol.for("react.lazy"),ap=Symbol.iterator;function j1(t){return t===null||typeof t!="object"?null:(t=ap&&t[ap]||t["@@iterator"],typeof t=="function"?t:null)}var Xy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Jy=Object.assign,Zy={};function li(t,e,n){this.props=t,this.context=e,this.refs=Zy,this.updater=n||Xy}li.prototype.isReactComponent={};li.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};li.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function e0(){}e0.prototype=li.prototype;function Eh(t,e,n){this.props=t,this.context=e,this.refs=Zy,this.updater=n||Xy}var Ih=Eh.prototype=new e0;Ih.constructor=Eh;Jy(Ih,li.prototype);Ih.isPureReactComponent=!0;var lp=Array.isArray,t0=Object.prototype.hasOwnProperty,Th={current:null},n0={key:!0,ref:!0,__self:!0,__source:!0};function r0(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)t0.call(e,r)&&!n0.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:Lo,type:t,key:i,ref:o,props:s,_owner:Th.current}}function A1(t,e){return{$$typeof:Lo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Nh(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lo}function k1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cp=/\/+/g;function pu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?k1(""+t.key):e.toString(36)}function Ka(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Lo:case v1:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+pu(o,0):r,lp(s)?(n="",t!=null&&(n=t.replace(cp,"$&/")+"/"),Ka(s,e,n,"",function(d){return d})):s!=null&&(Nh(s)&&(s=A1(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(cp,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",lp(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+pu(i,c);o+=Ka(i,e,n,u,s)}else if(u=j1(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+pu(i,c++),o+=Ka(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function wa(t,e,n){if(t==null)return t;var r=[],s=0;return Ka(t,r,"","",function(i){return e.call(n,i,s++)}),r}function C1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var mt={current:null},Qa={transition:null},R1={ReactCurrentDispatcher:mt,ReactCurrentBatchConfig:Qa,ReactCurrentOwner:Th};function s0(){throw Error("act(...) is not supported in production builds of React.")}ie.Children={map:wa,forEach:function(t,e,n){wa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return wa(t,function(){e++}),e},toArray:function(t){return wa(t,function(e){return e})||[]},only:function(t){if(!Nh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ie.Component=li;ie.Fragment=x1;ie.Profiler=w1;ie.PureComponent=Eh;ie.StrictMode=_1;ie.Suspense=N1;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R1;ie.act=s0;ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Jy({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Th.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)t0.call(e,u)&&!n0.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:Lo,type:t.type,key:s,ref:i,props:r,_owner:o}};ie.createContext=function(t){return t={$$typeof:I1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:E1,_context:t},t.Consumer=t};ie.createElement=r0;ie.createFactory=function(t){var e=r0.bind(null,t);return e.type=t,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(t){return{$$typeof:T1,render:t}};ie.isValidElement=Nh;ie.lazy=function(t){return{$$typeof:S1,_payload:{_status:-1,_result:t},_init:C1}};ie.memo=function(t,e){return{$$typeof:b1,type:t,compare:e===void 0?null:e}};ie.startTransition=function(t){var e=Qa.transition;Qa.transition={};try{t()}finally{Qa.transition=e}};ie.unstable_act=s0;ie.useCallback=function(t,e){return mt.current.useCallback(t,e)};ie.useContext=function(t){return mt.current.useContext(t)};ie.useDebugValue=function(){};ie.useDeferredValue=function(t){return mt.current.useDeferredValue(t)};ie.useEffect=function(t,e){return mt.current.useEffect(t,e)};ie.useId=function(){return mt.current.useId()};ie.useImperativeHandle=function(t,e,n){return mt.current.useImperativeHandle(t,e,n)};ie.useInsertionEffect=function(t,e){return mt.current.useInsertionEffect(t,e)};ie.useLayoutEffect=function(t,e){return mt.current.useLayoutEffect(t,e)};ie.useMemo=function(t,e){return mt.current.useMemo(t,e)};ie.useReducer=function(t,e,n){return mt.current.useReducer(t,e,n)};ie.useRef=function(t){return mt.current.useRef(t)};ie.useState=function(t){return mt.current.useState(t)};ie.useSyncExternalStore=function(t,e,n){return mt.current.useSyncExternalStore(t,e,n)};ie.useTransition=function(){return mt.current.useTransition()};ie.version="18.3.1";Yy.exports=ie;var Y=Yy.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1=Y,D1=Symbol.for("react.element"),O1=Symbol.for("react.fragment"),V1=Object.prototype.hasOwnProperty,M1=P1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,L1={key:!0,ref:!0,__self:!0,__source:!0};function i0(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)V1.call(e,r)&&!L1.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:D1,type:t,key:i,ref:o,props:s,_owner:M1.current}}ac.Fragment=O1;ac.jsx=i0;ac.jsxs=i0;Qy.exports=ac;var a=Qy.exports,o0={exports:{}},Ct={},a0={exports:{}},l0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,q){var Q=$.length;$.push(q);e:for(;0<Q;){var re=Q-1>>>1,de=$[re];if(0<s(de,q))$[re]=q,$[Q]=de,Q=re;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var q=$[0],Q=$.pop();if(Q!==q){$[0]=Q;e:for(var re=0,de=$.length,Ie=de>>>1;re<Ie;){var tn=2*(re+1)-1,zt=$[tn],ke=tn+1,gn=$[ke];if(0>s(zt,Q))ke<de&&0>s(gn,zt)?($[re]=gn,$[ke]=Q,re=ke):($[re]=zt,$[tn]=Q,re=tn);else if(ke<de&&0>s(gn,Q))$[re]=gn,$[ke]=Q,re=ke;else break e}}return q}function s($,q){var Q=$.sortIndex-q.sortIndex;return Q!==0?Q:$.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],f=1,g=null,y=3,j=!1,k=!1,C=!1,V=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N($){for(var q=n(d);q!==null;){if(q.callback===null)r(d);else if(q.startTime<=$)r(d),q.sortIndex=q.expirationTime,e(u,q);else break;q=n(d)}}function R($){if(C=!1,N($),!k)if(n(u)!==null)k=!0,B(A);else{var q=n(d);q!==null&&X(R,q.startTime-$)}}function A($,q){k=!1,C&&(C=!1,T(v),v=-1),j=!0;var Q=y;try{for(N(q),g=n(u);g!==null&&(!(g.expirationTime>q)||$&&!b());){var re=g.callback;if(typeof re=="function"){g.callback=null,y=g.priorityLevel;var de=re(g.expirationTime<=q);q=t.unstable_now(),typeof de=="function"?g.callback=de:g===n(u)&&r(u),N(q)}else r(u);g=n(u)}if(g!==null)var Ie=!0;else{var tn=n(d);tn!==null&&X(R,tn.startTime-q),Ie=!1}return Ie}finally{g=null,y=Q,j=!1}}var O=!1,E=null,v=-1,p=5,I=-1;function b(){return!(t.unstable_now()-I<p)}function _(){if(E!==null){var $=t.unstable_now();I=$;var q=!0;try{q=E(!0,$)}finally{q?x():(O=!1,E=null)}}else O=!1}var x;if(typeof S=="function")x=function(){S(_)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,L=D.port2;D.port1.onmessage=_,x=function(){L.postMessage(null)}}else x=function(){V(_,0)};function B($){E=$,O||(O=!0,x())}function X($,q){v=V(function(){$(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){k||j||(k=!0,B(A))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):p=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function($){switch(y){case 1:case 2:case 3:var q=3;break;default:q=y}var Q=y;y=q;try{return $()}finally{y=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,q){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Q=y;y=$;try{return q()}finally{y=Q}},t.unstable_scheduleCallback=function($,q,Q){var re=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?re+Q:re):Q=re,$){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=Q+de,$={id:f++,callback:q,priorityLevel:$,startTime:Q,expirationTime:de,sortIndex:-1},Q>re?($.sortIndex=Q,e(d,$),n(u)===null&&$===n(d)&&(C?(T(v),v=-1):C=!0,X(R,Q-re))):($.sortIndex=de,e(u,$),k||j||(k=!0,B(A))),$},t.unstable_shouldYield=b,t.unstable_wrapCallback=function($){var q=y;return function(){var Q=y;y=q;try{return $.apply(this,arguments)}finally{y=Q}}}})(l0);a0.exports=l0;var F1=a0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U1=Y,kt=F1;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c0=new Set,ho={};function is(t,e){Qs(t,e),Qs(t+"Capture",e)}function Qs(t,e){for(ho[t]=e,t=0;t<e.length;t++)c0.add(e[t])}var jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ed=Object.prototype.hasOwnProperty,$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,up={},dp={};function z1(t){return ed.call(dp,t)?!0:ed.call(up,t)?!1:$1.test(t)?dp[t]=!0:(up[t]=!0,!1)}function B1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function q1(t,e,n,r){if(e===null||typeof e>"u"||B1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Xe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xe[t]=new pt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xe[e]=new pt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xe[t]=new pt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xe[t]=new pt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xe[t]=new pt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xe[t]=new pt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xe[t]=new pt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xe[t]=new pt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xe[t]=new pt(t,5,!1,t.toLowerCase(),null,!1,!1)});var bh=/[\-:]([a-z])/g;function Sh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(bh,Sh);Xe[e]=new pt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(bh,Sh);Xe[e]=new pt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(bh,Sh);Xe[e]=new pt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xe[t]=new pt(t,1,!1,t.toLowerCase(),null,!1,!1)});Xe.xlinkHref=new pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xe[t]=new pt(t,1,!1,t.toLowerCase(),null,!0,!0)});function jh(t,e,n,r){var s=Xe.hasOwnProperty(e)?Xe[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(q1(e,n,s,r)&&(n=null),r||s===null?z1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Mn=U1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ea=Symbol.for("react.element"),Is=Symbol.for("react.portal"),Ts=Symbol.for("react.fragment"),Ah=Symbol.for("react.strict_mode"),td=Symbol.for("react.profiler"),u0=Symbol.for("react.provider"),d0=Symbol.for("react.context"),kh=Symbol.for("react.forward_ref"),nd=Symbol.for("react.suspense"),rd=Symbol.for("react.suspense_list"),Ch=Symbol.for("react.memo"),Hn=Symbol.for("react.lazy"),h0=Symbol.for("react.offscreen"),hp=Symbol.iterator;function Pi(t){return t===null||typeof t!="object"?null:(t=hp&&t[hp]||t["@@iterator"],typeof t=="function"?t:null)}var be=Object.assign,gu;function $i(t){if(gu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);gu=e&&e[1]||""}return`
`+gu+t}var yu=!1;function vu(t,e){if(!t||yu)return"";yu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{yu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$i(t):""}function H1(t){switch(t.tag){case 5:return $i(t.type);case 16:return $i("Lazy");case 13:return $i("Suspense");case 19:return $i("SuspenseList");case 0:case 2:case 15:return t=vu(t.type,!1),t;case 11:return t=vu(t.type.render,!1),t;case 1:return t=vu(t.type,!0),t;default:return""}}function sd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ts:return"Fragment";case Is:return"Portal";case td:return"Profiler";case Ah:return"StrictMode";case nd:return"Suspense";case rd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case d0:return(t.displayName||"Context")+".Consumer";case u0:return(t._context.displayName||"Context")+".Provider";case kh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ch:return e=t.displayName||null,e!==null?e:sd(t.type)||"Memo";case Hn:e=t._payload,t=t._init;try{return sd(t(e))}catch{}}return null}function W1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sd(e);case 8:return e===Ah?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function f0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function G1(t){var e=f0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ia(t){t._valueTracker||(t._valueTracker=G1(t))}function m0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=f0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function yl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function id(t,e){var n=e.checked;return be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fp(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=yr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function p0(t,e){e=e.checked,e!=null&&jh(t,"checked",e,!1)}function od(t,e){p0(t,e);var n=yr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ad(t,e.type,n):e.hasOwnProperty("defaultValue")&&ad(t,e.type,yr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function mp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ad(t,e,n){(e!=="number"||yl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zi=Array.isArray;function Ms(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+yr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function ld(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function pp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(z(92));if(zi(n)){if(1<n.length)throw Error(z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:yr(n)}}function g0(t,e){var n=yr(e.value),r=yr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function gp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function y0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?y0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ta,v0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ta=Ta||document.createElement("div"),Ta.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ta.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Yi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},K1=["Webkit","ms","Moz","O"];Object.keys(Yi).forEach(function(t){K1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yi[e]=Yi[t]})});function x0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Yi.hasOwnProperty(t)&&Yi[t]?(""+e).trim():e+"px"}function _0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=x0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Q1=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ud(t,e){if(e){if(Q1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function dd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hd=null;function Rh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fd=null,Ls=null,Fs=null;function yp(t){if(t=$o(t)){if(typeof fd!="function")throw Error(z(280));var e=t.stateNode;e&&(e=hc(e),fd(t.stateNode,t.type,e))}}function w0(t){Ls?Fs?Fs.push(t):Fs=[t]:Ls=t}function E0(){if(Ls){var t=Ls,e=Fs;if(Fs=Ls=null,yp(t),e)for(t=0;t<e.length;t++)yp(e[t])}}function I0(t,e){return t(e)}function T0(){}var xu=!1;function N0(t,e,n){if(xu)return t(e,n);xu=!0;try{return I0(t,e,n)}finally{xu=!1,(Ls!==null||Fs!==null)&&(T0(),E0())}}function mo(t,e){var n=t.stateNode;if(n===null)return null;var r=hc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(z(231,e,typeof n));return n}var md=!1;if(jn)try{var Di={};Object.defineProperty(Di,"passive",{get:function(){md=!0}}),window.addEventListener("test",Di,Di),window.removeEventListener("test",Di,Di)}catch{md=!1}function Y1(t,e,n,r,s,i,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var Xi=!1,vl=null,xl=!1,pd=null,X1={onError:function(t){Xi=!0,vl=t}};function J1(t,e,n,r,s,i,o,c,u){Xi=!1,vl=null,Y1.apply(X1,arguments)}function Z1(t,e,n,r,s,i,o,c,u){if(J1.apply(this,arguments),Xi){if(Xi){var d=vl;Xi=!1,vl=null}else throw Error(z(198));xl||(xl=!0,pd=d)}}function os(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function b0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vp(t){if(os(t)!==t)throw Error(z(188))}function eE(t){var e=t.alternate;if(!e){if(e=os(t),e===null)throw Error(z(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return vp(s),t;if(i===r)return vp(s),e;i=i.sibling}throw Error(z(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(z(189))}}if(n.alternate!==r)throw Error(z(190))}if(n.tag!==3)throw Error(z(188));return n.stateNode.current===n?t:e}function S0(t){return t=eE(t),t!==null?j0(t):null}function j0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=j0(t);if(e!==null)return e;t=t.sibling}return null}var A0=kt.unstable_scheduleCallback,xp=kt.unstable_cancelCallback,tE=kt.unstable_shouldYield,nE=kt.unstable_requestPaint,Pe=kt.unstable_now,rE=kt.unstable_getCurrentPriorityLevel,Ph=kt.unstable_ImmediatePriority,k0=kt.unstable_UserBlockingPriority,_l=kt.unstable_NormalPriority,sE=kt.unstable_LowPriority,C0=kt.unstable_IdlePriority,lc=null,an=null;function iE(t){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(lc,t,void 0,(t.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:lE,oE=Math.log,aE=Math.LN2;function lE(t){return t>>>=0,t===0?32:31-(oE(t)/aE|0)|0}var Na=64,ba=4194304;function Bi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function wl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=Bi(c):(i&=o,i!==0&&(r=Bi(i)))}else o=n&~s,o!==0?r=Bi(o):i!==0&&(r=Bi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yt(e),s=1<<n,r|=t[n],e&=~s;return r}function cE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Yt(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=cE(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function gd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function R0(){var t=Na;return Na<<=1,!(Na&4194240)&&(Na=64),t}function _u(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yt(e),t[e]=n}function dE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Yt(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Dh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yt(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var fe=0;function P0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var D0,Oh,O0,V0,M0,yd=!1,Sa=[],nr=null,rr=null,sr=null,po=new Map,go=new Map,Gn=[],hE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _p(t,e){switch(t){case"focusin":case"focusout":nr=null;break;case"dragenter":case"dragleave":rr=null;break;case"mouseover":case"mouseout":sr=null;break;case"pointerover":case"pointerout":po.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":go.delete(e.pointerId)}}function Oi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=$o(e),e!==null&&Oh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function fE(t,e,n,r,s){switch(e){case"focusin":return nr=Oi(nr,t,e,n,r,s),!0;case"dragenter":return rr=Oi(rr,t,e,n,r,s),!0;case"mouseover":return sr=Oi(sr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return po.set(i,Oi(po.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,go.set(i,Oi(go.get(i)||null,t,e,n,r,s)),!0}return!1}function L0(t){var e=Ur(t.target);if(e!==null){var n=os(e);if(n!==null){if(e=n.tag,e===13){if(e=b0(n),e!==null){t.blockedOn=e,M0(t.priority,function(){O0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ya(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hd=r,n.target.dispatchEvent(r),hd=null}else return e=$o(n),e!==null&&Oh(e),t.blockedOn=n,!1;e.shift()}return!0}function wp(t,e,n){Ya(t)&&n.delete(e)}function mE(){yd=!1,nr!==null&&Ya(nr)&&(nr=null),rr!==null&&Ya(rr)&&(rr=null),sr!==null&&Ya(sr)&&(sr=null),po.forEach(wp),go.forEach(wp)}function Vi(t,e){t.blockedOn===e&&(t.blockedOn=null,yd||(yd=!0,kt.unstable_scheduleCallback(kt.unstable_NormalPriority,mE)))}function yo(t){function e(s){return Vi(s,t)}if(0<Sa.length){Vi(Sa[0],t);for(var n=1;n<Sa.length;n++){var r=Sa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(nr!==null&&Vi(nr,t),rr!==null&&Vi(rr,t),sr!==null&&Vi(sr,t),po.forEach(e),go.forEach(e),n=0;n<Gn.length;n++)r=Gn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Gn.length&&(n=Gn[0],n.blockedOn===null);)L0(n),n.blockedOn===null&&Gn.shift()}var Us=Mn.ReactCurrentBatchConfig,El=!0;function pE(t,e,n,r){var s=fe,i=Us.transition;Us.transition=null;try{fe=1,Vh(t,e,n,r)}finally{fe=s,Us.transition=i}}function gE(t,e,n,r){var s=fe,i=Us.transition;Us.transition=null;try{fe=4,Vh(t,e,n,r)}finally{fe=s,Us.transition=i}}function Vh(t,e,n,r){if(El){var s=vd(t,e,n,r);if(s===null)ku(t,e,r,Il,n),_p(t,r);else if(fE(s,t,e,n,r))r.stopPropagation();else if(_p(t,r),e&4&&-1<hE.indexOf(t)){for(;s!==null;){var i=$o(s);if(i!==null&&D0(i),i=vd(t,e,n,r),i===null&&ku(t,e,r,Il,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ku(t,e,r,null,n)}}var Il=null;function vd(t,e,n,r){if(Il=null,t=Rh(r),t=Ur(t),t!==null)if(e=os(t),e===null)t=null;else if(n=e.tag,n===13){if(t=b0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Il=t,null}function F0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rE()){case Ph:return 1;case k0:return 4;case _l:case sE:return 16;case C0:return 536870912;default:return 16}default:return 16}}var Zn=null,Mh=null,Xa=null;function U0(){if(Xa)return Xa;var t,e=Mh,n=e.length,r,s="value"in Zn?Zn.value:Zn.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Xa=s.slice(t,1<r?1-r:void 0)}function Ja(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ja(){return!0}function Ep(){return!1}function Rt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ja:Ep,this.isPropagationStopped=Ep,this}return be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ja)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ja)},persist:function(){},isPersistent:ja}),e}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lh=Rt(ci),Uo=be({},ci,{view:0,detail:0}),yE=Rt(Uo),wu,Eu,Mi,cc=be({},Uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mi&&(Mi&&t.type==="mousemove"?(wu=t.screenX-Mi.screenX,Eu=t.screenY-Mi.screenY):Eu=wu=0,Mi=t),wu)},movementY:function(t){return"movementY"in t?t.movementY:Eu}}),Ip=Rt(cc),vE=be({},cc,{dataTransfer:0}),xE=Rt(vE),_E=be({},Uo,{relatedTarget:0}),Iu=Rt(_E),wE=be({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),EE=Rt(wE),IE=be({},ci,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),TE=Rt(IE),NE=be({},ci,{data:0}),Tp=Rt(NE),bE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},SE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=jE[t])?!!e[t]:!1}function Fh(){return AE}var kE=be({},Uo,{key:function(t){if(t.key){var e=bE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ja(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?SE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fh,charCode:function(t){return t.type==="keypress"?Ja(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ja(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),CE=Rt(kE),RE=be({},cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Np=Rt(RE),PE=be({},Uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fh}),DE=Rt(PE),OE=be({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),VE=Rt(OE),ME=be({},cc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),LE=Rt(ME),FE=[9,13,27,32],Uh=jn&&"CompositionEvent"in window,Ji=null;jn&&"documentMode"in document&&(Ji=document.documentMode);var UE=jn&&"TextEvent"in window&&!Ji,$0=jn&&(!Uh||Ji&&8<Ji&&11>=Ji),bp=" ",Sp=!1;function z0(t,e){switch(t){case"keyup":return FE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function B0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ns=!1;function $E(t,e){switch(t){case"compositionend":return B0(e);case"keypress":return e.which!==32?null:(Sp=!0,bp);case"textInput":return t=e.data,t===bp&&Sp?null:t;default:return null}}function zE(t,e){if(Ns)return t==="compositionend"||!Uh&&z0(t,e)?(t=U0(),Xa=Mh=Zn=null,Ns=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $0&&e.locale!=="ko"?null:e.data;default:return null}}var BE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!BE[t.type]:e==="textarea"}function q0(t,e,n,r){w0(r),e=Tl(e,"onChange"),0<e.length&&(n=new Lh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Zi=null,vo=null;function qE(t){tv(t,0)}function uc(t){var e=js(t);if(m0(e))return t}function HE(t,e){if(t==="change")return e}var H0=!1;if(jn){var Tu;if(jn){var Nu="oninput"in document;if(!Nu){var Ap=document.createElement("div");Ap.setAttribute("oninput","return;"),Nu=typeof Ap.oninput=="function"}Tu=Nu}else Tu=!1;H0=Tu&&(!document.documentMode||9<document.documentMode)}function kp(){Zi&&(Zi.detachEvent("onpropertychange",W0),vo=Zi=null)}function W0(t){if(t.propertyName==="value"&&uc(vo)){var e=[];q0(e,vo,t,Rh(t)),N0(qE,e)}}function WE(t,e,n){t==="focusin"?(kp(),Zi=e,vo=n,Zi.attachEvent("onpropertychange",W0)):t==="focusout"&&kp()}function GE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uc(vo)}function KE(t,e){if(t==="click")return uc(e)}function QE(t,e){if(t==="input"||t==="change")return uc(e)}function YE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Jt=typeof Object.is=="function"?Object.is:YE;function xo(t,e){if(Jt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ed.call(e,s)||!Jt(t[s],e[s]))return!1}return!0}function Cp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Rp(t,e){var n=Cp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Cp(n)}}function G0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?G0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function K0(){for(var t=window,e=yl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=yl(t.document)}return e}function $h(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function XE(t){var e=K0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&G0(n.ownerDocument.documentElement,n)){if(r!==null&&$h(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Rp(n,i);var o=Rp(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var JE=jn&&"documentMode"in document&&11>=document.documentMode,bs=null,xd=null,eo=null,_d=!1;function Pp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_d||bs==null||bs!==yl(r)||(r=bs,"selectionStart"in r&&$h(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),eo&&xo(eo,r)||(eo=r,r=Tl(xd,"onSelect"),0<r.length&&(e=new Lh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=bs)))}function Aa(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ss={animationend:Aa("Animation","AnimationEnd"),animationiteration:Aa("Animation","AnimationIteration"),animationstart:Aa("Animation","AnimationStart"),transitionend:Aa("Transition","TransitionEnd")},bu={},Q0={};jn&&(Q0=document.createElement("div").style,"AnimationEvent"in window||(delete Ss.animationend.animation,delete Ss.animationiteration.animation,delete Ss.animationstart.animation),"TransitionEvent"in window||delete Ss.transitionend.transition);function dc(t){if(bu[t])return bu[t];if(!Ss[t])return t;var e=Ss[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Q0)return bu[t]=e[n];return t}var Y0=dc("animationend"),X0=dc("animationiteration"),J0=dc("animationstart"),Z0=dc("transitionend"),ev=new Map,Dp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function br(t,e){ev.set(t,e),is(e,[t])}for(var Su=0;Su<Dp.length;Su++){var ju=Dp[Su],ZE=ju.toLowerCase(),eI=ju[0].toUpperCase()+ju.slice(1);br(ZE,"on"+eI)}br(Y0,"onAnimationEnd");br(X0,"onAnimationIteration");br(J0,"onAnimationStart");br("dblclick","onDoubleClick");br("focusin","onFocus");br("focusout","onBlur");br(Z0,"onTransitionEnd");Qs("onMouseEnter",["mouseout","mouseover"]);Qs("onMouseLeave",["mouseout","mouseover"]);Qs("onPointerEnter",["pointerout","pointerover"]);Qs("onPointerLeave",["pointerout","pointerover"]);is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));is("onBeforeInput",["compositionend","keypress","textInput","paste"]);is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tI=new Set("cancel close invalid load scroll toggle".split(" ").concat(qi));function Op(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Z1(r,e,void 0,t),t.currentTarget=null}function tv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Op(s,c,d),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Op(s,c,d),i=u}}}if(xl)throw t=pd,xl=!1,pd=null,t}function xe(t,e){var n=e[Nd];n===void 0&&(n=e[Nd]=new Set);var r=t+"__bubble";n.has(r)||(nv(e,t,2,!1),n.add(r))}function Au(t,e,n){var r=0;e&&(r|=4),nv(n,t,r,e)}var ka="_reactListening"+Math.random().toString(36).slice(2);function _o(t){if(!t[ka]){t[ka]=!0,c0.forEach(function(n){n!=="selectionchange"&&(tI.has(n)||Au(n,!1,t),Au(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ka]||(e[ka]=!0,Au("selectionchange",!1,e))}}function nv(t,e,n,r){switch(F0(e)){case 1:var s=pE;break;case 4:s=gE;break;default:s=Vh}n=s.bind(null,e,n,t),s=void 0,!md||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ku(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=Ur(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}N0(function(){var d=i,f=Rh(n),g=[];e:{var y=ev.get(t);if(y!==void 0){var j=Lh,k=t;switch(t){case"keypress":if(Ja(n)===0)break e;case"keydown":case"keyup":j=CE;break;case"focusin":k="focus",j=Iu;break;case"focusout":k="blur",j=Iu;break;case"beforeblur":case"afterblur":j=Iu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=Ip;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=xE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=DE;break;case Y0:case X0:case J0:j=EE;break;case Z0:j=VE;break;case"scroll":j=yE;break;case"wheel":j=LE;break;case"copy":case"cut":case"paste":j=TE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=Np}var C=(e&4)!==0,V=!C&&t==="scroll",T=C?y!==null?y+"Capture":null:y;C=[];for(var S=d,N;S!==null;){N=S;var R=N.stateNode;if(N.tag===5&&R!==null&&(N=R,T!==null&&(R=mo(S,T),R!=null&&C.push(wo(S,R,N)))),V)break;S=S.return}0<C.length&&(y=new j(y,k,null,n,f),g.push({event:y,listeners:C}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",j=t==="mouseout"||t==="pointerout",y&&n!==hd&&(k=n.relatedTarget||n.fromElement)&&(Ur(k)||k[An]))break e;if((j||y)&&(y=f.window===f?f:(y=f.ownerDocument)?y.defaultView||y.parentWindow:window,j?(k=n.relatedTarget||n.toElement,j=d,k=k?Ur(k):null,k!==null&&(V=os(k),k!==V||k.tag!==5&&k.tag!==6)&&(k=null)):(j=null,k=d),j!==k)){if(C=Ip,R="onMouseLeave",T="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(C=Np,R="onPointerLeave",T="onPointerEnter",S="pointer"),V=j==null?y:js(j),N=k==null?y:js(k),y=new C(R,S+"leave",j,n,f),y.target=V,y.relatedTarget=N,R=null,Ur(f)===d&&(C=new C(T,S+"enter",k,n,f),C.target=N,C.relatedTarget=V,R=C),V=R,j&&k)t:{for(C=j,T=k,S=0,N=C;N;N=ms(N))S++;for(N=0,R=T;R;R=ms(R))N++;for(;0<S-N;)C=ms(C),S--;for(;0<N-S;)T=ms(T),N--;for(;S--;){if(C===T||T!==null&&C===T.alternate)break t;C=ms(C),T=ms(T)}C=null}else C=null;j!==null&&Vp(g,y,j,C,!1),k!==null&&V!==null&&Vp(g,V,k,C,!0)}}e:{if(y=d?js(d):window,j=y.nodeName&&y.nodeName.toLowerCase(),j==="select"||j==="input"&&y.type==="file")var A=HE;else if(jp(y))if(H0)A=QE;else{A=GE;var O=WE}else(j=y.nodeName)&&j.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(A=KE);if(A&&(A=A(t,d))){q0(g,A,n,f);break e}O&&O(t,y,d),t==="focusout"&&(O=y._wrapperState)&&O.controlled&&y.type==="number"&&ad(y,"number",y.value)}switch(O=d?js(d):window,t){case"focusin":(jp(O)||O.contentEditable==="true")&&(bs=O,xd=d,eo=null);break;case"focusout":eo=xd=bs=null;break;case"mousedown":_d=!0;break;case"contextmenu":case"mouseup":case"dragend":_d=!1,Pp(g,n,f);break;case"selectionchange":if(JE)break;case"keydown":case"keyup":Pp(g,n,f)}var E;if(Uh)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Ns?z0(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&($0&&n.locale!=="ko"&&(Ns||v!=="onCompositionStart"?v==="onCompositionEnd"&&Ns&&(E=U0()):(Zn=f,Mh="value"in Zn?Zn.value:Zn.textContent,Ns=!0)),O=Tl(d,v),0<O.length&&(v=new Tp(v,t,null,n,f),g.push({event:v,listeners:O}),E?v.data=E:(E=B0(n),E!==null&&(v.data=E)))),(E=UE?$E(t,n):zE(t,n))&&(d=Tl(d,"onBeforeInput"),0<d.length&&(f=new Tp("onBeforeInput","beforeinput",null,n,f),g.push({event:f,listeners:d}),f.data=E))}tv(g,e)})}function wo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Tl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=mo(t,n),i!=null&&r.unshift(wo(t,i,s)),i=mo(t,e),i!=null&&r.push(wo(t,i,s))),t=t.return}return r}function ms(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Vp(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=mo(n,i),u!=null&&o.unshift(wo(n,u,c))):s||(u=mo(n,i),u!=null&&o.push(wo(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var nI=/\r\n?/g,rI=/\u0000|\uFFFD/g;function Mp(t){return(typeof t=="string"?t:""+t).replace(nI,`
`).replace(rI,"")}function Ca(t,e,n){if(e=Mp(e),Mp(t)!==e&&n)throw Error(z(425))}function Nl(){}var wd=null,Ed=null;function Id(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Td=typeof setTimeout=="function"?setTimeout:void 0,sI=typeof clearTimeout=="function"?clearTimeout:void 0,Lp=typeof Promise=="function"?Promise:void 0,iI=typeof queueMicrotask=="function"?queueMicrotask:typeof Lp<"u"?function(t){return Lp.resolve(null).then(t).catch(oI)}:Td;function oI(t){setTimeout(function(){throw t})}function Cu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),yo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);yo(e)}function ir(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ui=Math.random().toString(36).slice(2),on="__reactFiber$"+ui,Eo="__reactProps$"+ui,An="__reactContainer$"+ui,Nd="__reactEvents$"+ui,aI="__reactListeners$"+ui,lI="__reactHandles$"+ui;function Ur(t){var e=t[on];if(e)return e;for(var n=t.parentNode;n;){if(e=n[An]||n[on]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Fp(t);t!==null;){if(n=t[on])return n;t=Fp(t)}return e}t=n,n=t.parentNode}return null}function $o(t){return t=t[on]||t[An],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function js(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function hc(t){return t[Eo]||null}var bd=[],As=-1;function Sr(t){return{current:t}}function we(t){0>As||(t.current=bd[As],bd[As]=null,As--)}function ye(t,e){As++,bd[As]=t.current,t.current=e}var vr={},lt=Sr(vr),Et=Sr(!1),Wr=vr;function Ys(t,e){var n=t.type.contextTypes;if(!n)return vr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function It(t){return t=t.childContextTypes,t!=null}function bl(){we(Et),we(lt)}function Up(t,e,n){if(lt.current!==vr)throw Error(z(168));ye(lt,e),ye(Et,n)}function rv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(z(108,W1(t)||"Unknown",s));return be({},n,r)}function Sl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||vr,Wr=lt.current,ye(lt,t),ye(Et,Et.current),!0}function $p(t,e,n){var r=t.stateNode;if(!r)throw Error(z(169));n?(t=rv(t,e,Wr),r.__reactInternalMemoizedMergedChildContext=t,we(Et),we(lt),ye(lt,t)):we(Et),ye(Et,n)}var _n=null,fc=!1,Ru=!1;function sv(t){_n===null?_n=[t]:_n.push(t)}function cI(t){fc=!0,sv(t)}function jr(){if(!Ru&&_n!==null){Ru=!0;var t=0,e=fe;try{var n=_n;for(fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}_n=null,fc=!1}catch(s){throw _n!==null&&(_n=_n.slice(t+1)),A0(Ph,jr),s}finally{fe=e,Ru=!1}}return null}var ks=[],Cs=0,jl=null,Al=0,Pt=[],Dt=0,Gr=null,En=1,In="";function Mr(t,e){ks[Cs++]=Al,ks[Cs++]=jl,jl=t,Al=e}function iv(t,e,n){Pt[Dt++]=En,Pt[Dt++]=In,Pt[Dt++]=Gr,Gr=t;var r=En;t=In;var s=32-Yt(r)-1;r&=~(1<<s),n+=1;var i=32-Yt(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,En=1<<32-Yt(e)+s|n<<s|r,In=i+t}else En=1<<i|n<<s|r,In=t}function zh(t){t.return!==null&&(Mr(t,1),iv(t,1,0))}function Bh(t){for(;t===jl;)jl=ks[--Cs],ks[Cs]=null,Al=ks[--Cs],ks[Cs]=null;for(;t===Gr;)Gr=Pt[--Dt],Pt[Dt]=null,In=Pt[--Dt],Pt[Dt]=null,En=Pt[--Dt],Pt[Dt]=null}var At=null,St=null,Ee=!1,Gt=null;function ov(t,e){var n=Mt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function zp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,At=t,St=ir(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,At=t,St=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Gr!==null?{id:En,overflow:In}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Mt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,At=t,St=null,!0):!1;default:return!1}}function Sd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function jd(t){if(Ee){var e=St;if(e){var n=e;if(!zp(t,e)){if(Sd(t))throw Error(z(418));e=ir(n.nextSibling);var r=At;e&&zp(t,e)?ov(r,n):(t.flags=t.flags&-4097|2,Ee=!1,At=t)}}else{if(Sd(t))throw Error(z(418));t.flags=t.flags&-4097|2,Ee=!1,At=t}}}function Bp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;At=t}function Ra(t){if(t!==At)return!1;if(!Ee)return Bp(t),Ee=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Id(t.type,t.memoizedProps)),e&&(e=St)){if(Sd(t))throw av(),Error(z(418));for(;e;)ov(t,e),e=ir(e.nextSibling)}if(Bp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){St=ir(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}St=null}}else St=At?ir(t.stateNode.nextSibling):null;return!0}function av(){for(var t=St;t;)t=ir(t.nextSibling)}function Xs(){St=At=null,Ee=!1}function qh(t){Gt===null?Gt=[t]:Gt.push(t)}var uI=Mn.ReactCurrentBatchConfig;function Li(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(z(309));var r=n.stateNode}if(!r)throw Error(z(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(z(284));if(!n._owner)throw Error(z(290,t))}return t}function Pa(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qp(t){var e=t._init;return e(t._payload)}function lv(t){function e(T,S){if(t){var N=T.deletions;N===null?(T.deletions=[S],T.flags|=16):N.push(S)}}function n(T,S){if(!t)return null;for(;S!==null;)e(T,S),S=S.sibling;return null}function r(T,S){for(T=new Map;S!==null;)S.key!==null?T.set(S.key,S):T.set(S.index,S),S=S.sibling;return T}function s(T,S){return T=cr(T,S),T.index=0,T.sibling=null,T}function i(T,S,N){return T.index=N,t?(N=T.alternate,N!==null?(N=N.index,N<S?(T.flags|=2,S):N):(T.flags|=2,S)):(T.flags|=1048576,S)}function o(T){return t&&T.alternate===null&&(T.flags|=2),T}function c(T,S,N,R){return S===null||S.tag!==6?(S=Fu(N,T.mode,R),S.return=T,S):(S=s(S,N),S.return=T,S)}function u(T,S,N,R){var A=N.type;return A===Ts?f(T,S,N.props.children,R,N.key):S!==null&&(S.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Hn&&qp(A)===S.type)?(R=s(S,N.props),R.ref=Li(T,S,N),R.return=T,R):(R=il(N.type,N.key,N.props,null,T.mode,R),R.ref=Li(T,S,N),R.return=T,R)}function d(T,S,N,R){return S===null||S.tag!==4||S.stateNode.containerInfo!==N.containerInfo||S.stateNode.implementation!==N.implementation?(S=Uu(N,T.mode,R),S.return=T,S):(S=s(S,N.children||[]),S.return=T,S)}function f(T,S,N,R,A){return S===null||S.tag!==7?(S=Hr(N,T.mode,R,A),S.return=T,S):(S=s(S,N),S.return=T,S)}function g(T,S,N){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Fu(""+S,T.mode,N),S.return=T,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ea:return N=il(S.type,S.key,S.props,null,T.mode,N),N.ref=Li(T,null,S),N.return=T,N;case Is:return S=Uu(S,T.mode,N),S.return=T,S;case Hn:var R=S._init;return g(T,R(S._payload),N)}if(zi(S)||Pi(S))return S=Hr(S,T.mode,N,null),S.return=T,S;Pa(T,S)}return null}function y(T,S,N,R){var A=S!==null?S.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return A!==null?null:c(T,S,""+N,R);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ea:return N.key===A?u(T,S,N,R):null;case Is:return N.key===A?d(T,S,N,R):null;case Hn:return A=N._init,y(T,S,A(N._payload),R)}if(zi(N)||Pi(N))return A!==null?null:f(T,S,N,R,null);Pa(T,N)}return null}function j(T,S,N,R,A){if(typeof R=="string"&&R!==""||typeof R=="number")return T=T.get(N)||null,c(S,T,""+R,A);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Ea:return T=T.get(R.key===null?N:R.key)||null,u(S,T,R,A);case Is:return T=T.get(R.key===null?N:R.key)||null,d(S,T,R,A);case Hn:var O=R._init;return j(T,S,N,O(R._payload),A)}if(zi(R)||Pi(R))return T=T.get(N)||null,f(S,T,R,A,null);Pa(S,R)}return null}function k(T,S,N,R){for(var A=null,O=null,E=S,v=S=0,p=null;E!==null&&v<N.length;v++){E.index>v?(p=E,E=null):p=E.sibling;var I=y(T,E,N[v],R);if(I===null){E===null&&(E=p);break}t&&E&&I.alternate===null&&e(T,E),S=i(I,S,v),O===null?A=I:O.sibling=I,O=I,E=p}if(v===N.length)return n(T,E),Ee&&Mr(T,v),A;if(E===null){for(;v<N.length;v++)E=g(T,N[v],R),E!==null&&(S=i(E,S,v),O===null?A=E:O.sibling=E,O=E);return Ee&&Mr(T,v),A}for(E=r(T,E);v<N.length;v++)p=j(E,T,v,N[v],R),p!==null&&(t&&p.alternate!==null&&E.delete(p.key===null?v:p.key),S=i(p,S,v),O===null?A=p:O.sibling=p,O=p);return t&&E.forEach(function(b){return e(T,b)}),Ee&&Mr(T,v),A}function C(T,S,N,R){var A=Pi(N);if(typeof A!="function")throw Error(z(150));if(N=A.call(N),N==null)throw Error(z(151));for(var O=A=null,E=S,v=S=0,p=null,I=N.next();E!==null&&!I.done;v++,I=N.next()){E.index>v?(p=E,E=null):p=E.sibling;var b=y(T,E,I.value,R);if(b===null){E===null&&(E=p);break}t&&E&&b.alternate===null&&e(T,E),S=i(b,S,v),O===null?A=b:O.sibling=b,O=b,E=p}if(I.done)return n(T,E),Ee&&Mr(T,v),A;if(E===null){for(;!I.done;v++,I=N.next())I=g(T,I.value,R),I!==null&&(S=i(I,S,v),O===null?A=I:O.sibling=I,O=I);return Ee&&Mr(T,v),A}for(E=r(T,E);!I.done;v++,I=N.next())I=j(E,T,v,I.value,R),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?v:I.key),S=i(I,S,v),O===null?A=I:O.sibling=I,O=I);return t&&E.forEach(function(_){return e(T,_)}),Ee&&Mr(T,v),A}function V(T,S,N,R){if(typeof N=="object"&&N!==null&&N.type===Ts&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case Ea:e:{for(var A=N.key,O=S;O!==null;){if(O.key===A){if(A=N.type,A===Ts){if(O.tag===7){n(T,O.sibling),S=s(O,N.props.children),S.return=T,T=S;break e}}else if(O.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Hn&&qp(A)===O.type){n(T,O.sibling),S=s(O,N.props),S.ref=Li(T,O,N),S.return=T,T=S;break e}n(T,O);break}else e(T,O);O=O.sibling}N.type===Ts?(S=Hr(N.props.children,T.mode,R,N.key),S.return=T,T=S):(R=il(N.type,N.key,N.props,null,T.mode,R),R.ref=Li(T,S,N),R.return=T,T=R)}return o(T);case Is:e:{for(O=N.key;S!==null;){if(S.key===O)if(S.tag===4&&S.stateNode.containerInfo===N.containerInfo&&S.stateNode.implementation===N.implementation){n(T,S.sibling),S=s(S,N.children||[]),S.return=T,T=S;break e}else{n(T,S);break}else e(T,S);S=S.sibling}S=Uu(N,T.mode,R),S.return=T,T=S}return o(T);case Hn:return O=N._init,V(T,S,O(N._payload),R)}if(zi(N))return k(T,S,N,R);if(Pi(N))return C(T,S,N,R);Pa(T,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,S!==null&&S.tag===6?(n(T,S.sibling),S=s(S,N),S.return=T,T=S):(n(T,S),S=Fu(N,T.mode,R),S.return=T,T=S),o(T)):n(T,S)}return V}var Js=lv(!0),cv=lv(!1),kl=Sr(null),Cl=null,Rs=null,Hh=null;function Wh(){Hh=Rs=Cl=null}function Gh(t){var e=kl.current;we(kl),t._currentValue=e}function Ad(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function $s(t,e){Cl=t,Hh=Rs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wt=!0),t.firstContext=null)}function Ut(t){var e=t._currentValue;if(Hh!==t)if(t={context:t,memoizedValue:e,next:null},Rs===null){if(Cl===null)throw Error(z(308));Rs=t,Cl.dependencies={lanes:0,firstContext:t}}else Rs=Rs.next=t;return e}var $r=null;function Kh(t){$r===null?$r=[t]:$r.push(t)}function uv(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Kh(e)):(n.next=s.next,s.next=n),e.interleaved=n,kn(t,r)}function kn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Wn=!1;function Qh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function bn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function or(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ce&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,kn(t,n)}return s=r.interleaved,s===null?(e.next=e,Kh(r)):(e.next=s.next,s.next=e),r.interleaved=e,kn(t,n)}function Za(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dh(t,n)}}function Hp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Rl(t,e,n,r){var s=t.updateQueue;Wn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==o&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;o=0,f=d=u=null,c=i;do{var y=c.lane,j=c.eventTime;if((r&y)===y){f!==null&&(f=f.next={eventTime:j,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var k=t,C=c;switch(y=e,j=n,C.tag){case 1:if(k=C.payload,typeof k=="function"){g=k.call(j,g,y);break e}g=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=C.payload,y=typeof k=="function"?k.call(j,g,y):k,y==null)break e;g=be({},g,y);break e;case 2:Wn=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[c]:y.push(c))}else j={eventTime:j,lane:y,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=j,u=g):f=f.next=j,o|=y;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;y=c,c=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(f===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Qr|=o,t.lanes=o,t.memoizedState=g}}function Wp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(z(191,s));s.call(r)}}}var zo={},ln=Sr(zo),Io=Sr(zo),To=Sr(zo);function zr(t){if(t===zo)throw Error(z(174));return t}function Yh(t,e){switch(ye(To,e),ye(Io,t),ye(ln,zo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=cd(e,t)}we(ln),ye(ln,e)}function Zs(){we(ln),we(Io),we(To)}function hv(t){zr(To.current);var e=zr(ln.current),n=cd(e,t.type);e!==n&&(ye(Io,t),ye(ln,n))}function Xh(t){Io.current===t&&(we(ln),we(Io))}var Te=Sr(0);function Pl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pu=[];function Jh(){for(var t=0;t<Pu.length;t++)Pu[t]._workInProgressVersionPrimary=null;Pu.length=0}var el=Mn.ReactCurrentDispatcher,Du=Mn.ReactCurrentBatchConfig,Kr=0,Ne=null,Fe=null,Be=null,Dl=!1,to=!1,No=0,dI=0;function nt(){throw Error(z(321))}function Zh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Jt(t[n],e[n]))return!1;return!0}function ef(t,e,n,r,s,i){if(Kr=i,Ne=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,el.current=t===null||t.memoizedState===null?pI:gI,t=n(r,s),to){i=0;do{if(to=!1,No=0,25<=i)throw Error(z(301));i+=1,Be=Fe=null,e.updateQueue=null,el.current=yI,t=n(r,s)}while(to)}if(el.current=Ol,e=Fe!==null&&Fe.next!==null,Kr=0,Be=Fe=Ne=null,Dl=!1,e)throw Error(z(300));return t}function tf(){var t=No!==0;return No=0,t}function rn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?Ne.memoizedState=Be=t:Be=Be.next=t,Be}function $t(){if(Fe===null){var t=Ne.alternate;t=t!==null?t.memoizedState:null}else t=Fe.next;var e=Be===null?Ne.memoizedState:Be.next;if(e!==null)Be=e,Fe=t;else{if(t===null)throw Error(z(310));Fe=t,t={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},Be===null?Ne.memoizedState=Be=t:Be=Be.next=t}return Be}function bo(t,e){return typeof e=="function"?e(t):e}function Ou(t){var e=$t(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=Fe,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,d=i;do{var f=d.lane;if((Kr&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var g={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=g,o=r):u=u.next=g,Ne.lanes|=f,Qr|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=c,Jt(r,e.memoizedState)||(wt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ne.lanes|=i,Qr|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vu(t){var e=$t(),n=e.queue;if(n===null)throw Error(z(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Jt(i,e.memoizedState)||(wt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function fv(){}function mv(t,e){var n=Ne,r=$t(),s=e(),i=!Jt(r.memoizedState,s);if(i&&(r.memoizedState=s,wt=!0),r=r.queue,nf(yv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Be!==null&&Be.memoizedState.tag&1){if(n.flags|=2048,So(9,gv.bind(null,n,r,s,e),void 0,null),qe===null)throw Error(z(349));Kr&30||pv(n,e,s)}return s}function pv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function gv(t,e,n,r){e.value=n,e.getSnapshot=r,vv(e)&&xv(t)}function yv(t,e,n){return n(function(){vv(e)&&xv(t)})}function vv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Jt(t,n)}catch{return!0}}function xv(t){var e=kn(t,1);e!==null&&Xt(e,t,1,-1)}function Gp(t){var e=rn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:t},e.queue=t,t=t.dispatch=mI.bind(null,Ne,t),[e.memoizedState,t]}function So(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function _v(){return $t().memoizedState}function tl(t,e,n,r){var s=rn();Ne.flags|=t,s.memoizedState=So(1|e,n,void 0,r===void 0?null:r)}function mc(t,e,n,r){var s=$t();r=r===void 0?null:r;var i=void 0;if(Fe!==null){var o=Fe.memoizedState;if(i=o.destroy,r!==null&&Zh(r,o.deps)){s.memoizedState=So(e,n,i,r);return}}Ne.flags|=t,s.memoizedState=So(1|e,n,i,r)}function Kp(t,e){return tl(8390656,8,t,e)}function nf(t,e){return mc(2048,8,t,e)}function wv(t,e){return mc(4,2,t,e)}function Ev(t,e){return mc(4,4,t,e)}function Iv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Tv(t,e,n){return n=n!=null?n.concat([t]):null,mc(4,4,Iv.bind(null,e,t),n)}function rf(){}function Nv(t,e){var n=$t();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function bv(t,e){var n=$t();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Sv(t,e,n){return Kr&21?(Jt(n,e)||(n=R0(),Ne.lanes|=n,Qr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wt=!0),t.memoizedState=n)}function hI(t,e){var n=fe;fe=n!==0&&4>n?n:4,t(!0);var r=Du.transition;Du.transition={};try{t(!1),e()}finally{fe=n,Du.transition=r}}function jv(){return $t().memoizedState}function fI(t,e,n){var r=lr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Av(t))kv(e,n);else if(n=uv(t,e,n,r),n!==null){var s=ft();Xt(n,t,r,s),Cv(n,e,r)}}function mI(t,e,n){var r=lr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Av(t))kv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,Jt(c,o)){var u=e.interleaved;u===null?(s.next=s,Kh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=uv(t,e,s,r),n!==null&&(s=ft(),Xt(n,t,r,s),Cv(n,e,r))}}function Av(t){var e=t.alternate;return t===Ne||e!==null&&e===Ne}function kv(t,e){to=Dl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Cv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dh(t,n)}}var Ol={readContext:Ut,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useInsertionEffect:nt,useLayoutEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useMutableSource:nt,useSyncExternalStore:nt,useId:nt,unstable_isNewReconciler:!1},pI={readContext:Ut,useCallback:function(t,e){return rn().memoizedState=[t,e===void 0?null:e],t},useContext:Ut,useEffect:Kp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,tl(4194308,4,Iv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return tl(4194308,4,t,e)},useInsertionEffect:function(t,e){return tl(4,2,t,e)},useMemo:function(t,e){var n=rn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=rn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=fI.bind(null,Ne,t),[r.memoizedState,t]},useRef:function(t){var e=rn();return t={current:t},e.memoizedState=t},useState:Gp,useDebugValue:rf,useDeferredValue:function(t){return rn().memoizedState=t},useTransition:function(){var t=Gp(!1),e=t[0];return t=hI.bind(null,t[1]),rn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ne,s=rn();if(Ee){if(n===void 0)throw Error(z(407));n=n()}else{if(n=e(),qe===null)throw Error(z(349));Kr&30||pv(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Kp(yv.bind(null,r,i,t),[t]),r.flags|=2048,So(9,gv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=rn(),e=qe.identifierPrefix;if(Ee){var n=In,r=En;n=(r&~(1<<32-Yt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=No++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=dI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gI={readContext:Ut,useCallback:Nv,useContext:Ut,useEffect:nf,useImperativeHandle:Tv,useInsertionEffect:wv,useLayoutEffect:Ev,useMemo:bv,useReducer:Ou,useRef:_v,useState:function(){return Ou(bo)},useDebugValue:rf,useDeferredValue:function(t){var e=$t();return Sv(e,Fe.memoizedState,t)},useTransition:function(){var t=Ou(bo)[0],e=$t().memoizedState;return[t,e]},useMutableSource:fv,useSyncExternalStore:mv,useId:jv,unstable_isNewReconciler:!1},yI={readContext:Ut,useCallback:Nv,useContext:Ut,useEffect:nf,useImperativeHandle:Tv,useInsertionEffect:wv,useLayoutEffect:Ev,useMemo:bv,useReducer:Vu,useRef:_v,useState:function(){return Vu(bo)},useDebugValue:rf,useDeferredValue:function(t){var e=$t();return Fe===null?e.memoizedState=t:Sv(e,Fe.memoizedState,t)},useTransition:function(){var t=Vu(bo)[0],e=$t().memoizedState;return[t,e]},useMutableSource:fv,useSyncExternalStore:mv,useId:jv,unstable_isNewReconciler:!1};function Ht(t,e){if(t&&t.defaultProps){e=be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function kd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var pc={isMounted:function(t){return(t=t._reactInternals)?os(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ft(),s=lr(t),i=bn(r,s);i.payload=e,n!=null&&(i.callback=n),e=or(t,i,s),e!==null&&(Xt(e,t,s,r),Za(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ft(),s=lr(t),i=bn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=or(t,i,s),e!==null&&(Xt(e,t,s,r),Za(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ft(),r=lr(t),s=bn(n,r);s.tag=2,e!=null&&(s.callback=e),e=or(t,s,r),e!==null&&(Xt(e,t,r,n),Za(e,t,r))}};function Qp(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!xo(n,r)||!xo(s,i):!0}function Rv(t,e,n){var r=!1,s=vr,i=e.contextType;return typeof i=="object"&&i!==null?i=Ut(i):(s=It(e)?Wr:lt.current,r=e.contextTypes,i=(r=r!=null)?Ys(t,s):vr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Yp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&pc.enqueueReplaceState(e,e.state,null)}function Cd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Qh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Ut(i):(i=It(e)?Wr:lt.current,s.context=Ys(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(kd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&pc.enqueueReplaceState(s,s.state,null),Rl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ei(t,e){try{var n="",r=e;do n+=H1(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Mu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Rd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var vI=typeof WeakMap=="function"?WeakMap:Map;function Pv(t,e,n){n=bn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ml||(Ml=!0,zd=r),Rd(t,e)},n}function Dv(t,e,n){n=bn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Rd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Rd(t,e),typeof r!="function"&&(ar===null?ar=new Set([this]):ar.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Xp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new vI;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=RI.bind(null,t,e,n),e.then(t,t))}function Jp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=bn(-1,1),e.tag=2,or(n,e,1))),n.lanes|=1),t)}var xI=Mn.ReactCurrentOwner,wt=!1;function ht(t,e,n,r){e.child=t===null?cv(e,null,n,r):Js(e,t.child,n,r)}function eg(t,e,n,r,s){n=n.render;var i=e.ref;return $s(e,s),r=ef(t,e,n,r,i,s),n=tf(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Cn(t,e,s)):(Ee&&n&&zh(e),e.flags|=1,ht(t,e,r,s),e.child)}function tg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!hf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Ov(t,e,i,r,s)):(t=il(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:xo,n(o,r)&&t.ref===e.ref)return Cn(t,e,s)}return e.flags|=1,t=cr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Ov(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(xo(i,r)&&t.ref===e.ref)if(wt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(wt=!0);else return e.lanes=t.lanes,Cn(t,e,s)}return Pd(t,e,n,r,s)}function Vv(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ye(Ds,bt),bt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ye(Ds,bt),bt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ye(Ds,bt),bt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ye(Ds,bt),bt|=r;return ht(t,e,s,n),e.child}function Mv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pd(t,e,n,r,s){var i=It(n)?Wr:lt.current;return i=Ys(e,i),$s(e,s),n=ef(t,e,n,r,i,s),r=tf(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Cn(t,e,s)):(Ee&&r&&zh(e),e.flags|=1,ht(t,e,n,s),e.child)}function ng(t,e,n,r,s){if(It(n)){var i=!0;Sl(e)}else i=!1;if($s(e,s),e.stateNode===null)nl(t,e),Rv(e,n,r),Cd(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Ut(d):(d=It(n)?Wr:lt.current,d=Ys(e,d));var f=n.getDerivedStateFromProps,g=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";g||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Yp(e,o,r,d),Wn=!1;var y=e.memoizedState;o.state=y,Rl(e,r,o,s),u=e.memoizedState,c!==r||y!==u||Et.current||Wn?(typeof f=="function"&&(kd(e,n,f,r),u=e.memoizedState),(c=Wn||Qp(e,n,c,r,y,u,d))?(g||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,dv(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:Ht(e.type,c),o.props=d,g=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Ut(u):(u=It(n)?Wr:lt.current,u=Ys(e,u));var j=n.getDerivedStateFromProps;(f=typeof j=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==g||y!==u)&&Yp(e,o,r,u),Wn=!1,y=e.memoizedState,o.state=y,Rl(e,r,o,s);var k=e.memoizedState;c!==g||y!==k||Et.current||Wn?(typeof j=="function"&&(kd(e,n,j,r),k=e.memoizedState),(d=Wn||Qp(e,n,d,r,y,k,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,k,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,k,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),o.props=r,o.state=k,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return Dd(t,e,n,r,i,s)}function Dd(t,e,n,r,s,i){Mv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&$p(e,n,!1),Cn(t,e,i);r=e.stateNode,xI.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Js(e,t.child,null,i),e.child=Js(e,null,c,i)):ht(t,e,c,i),e.memoizedState=r.state,s&&$p(e,n,!0),e.child}function Lv(t){var e=t.stateNode;e.pendingContext?Up(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Up(t,e.context,!1),Yh(t,e.containerInfo)}function rg(t,e,n,r,s){return Xs(),qh(s),e.flags|=256,ht(t,e,n,r),e.child}var Od={dehydrated:null,treeContext:null,retryLane:0};function Vd(t){return{baseLanes:t,cachePool:null,transitions:null}}function Fv(t,e,n){var r=e.pendingProps,s=Te.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ye(Te,s&1),t===null)return jd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=vc(o,r,0,null),t=Hr(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Vd(n),e.memoizedState=Od,t):sf(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return _I(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=cr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=cr(c,i):(i=Hr(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Vd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Od,r}return i=t.child,t=i.sibling,r=cr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function sf(t,e){return e=vc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Da(t,e,n,r){return r!==null&&qh(r),Js(e,t.child,null,n),t=sf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _I(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Mu(Error(z(422))),Da(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=vc({mode:"visible",children:r.children},s,0,null),i=Hr(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Js(e,t.child,null,o),e.child.memoizedState=Vd(o),e.memoizedState=Od,i);if(!(e.mode&1))return Da(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(z(419)),r=Mu(i,r,void 0),Da(t,e,o,r)}if(c=(o&t.childLanes)!==0,wt||c){if(r=qe,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,kn(t,s),Xt(r,t,s,-1))}return df(),r=Mu(Error(z(421))),Da(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=PI.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,St=ir(s.nextSibling),At=e,Ee=!0,Gt=null,t!==null&&(Pt[Dt++]=En,Pt[Dt++]=In,Pt[Dt++]=Gr,En=t.id,In=t.overflow,Gr=e),e=sf(e,r.children),e.flags|=4096,e)}function sg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ad(t.return,e,n)}function Lu(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Uv(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(ht(t,e,r.children,n),r=Te.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sg(t,n,e);else if(t.tag===19)sg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ye(Te,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Pl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Lu(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Pl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Lu(e,!0,n,null,i);break;case"together":Lu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Cn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,n=cr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=cr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function wI(t,e,n){switch(e.tag){case 3:Lv(e),Xs();break;case 5:hv(e);break;case 1:It(e.type)&&Sl(e);break;case 4:Yh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ye(kl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ye(Te,Te.current&1),e.flags|=128,null):n&e.child.childLanes?Fv(t,e,n):(ye(Te,Te.current&1),t=Cn(t,e,n),t!==null?t.sibling:null);ye(Te,Te.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Uv(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ye(Te,Te.current),r)break;return null;case 22:case 23:return e.lanes=0,Vv(t,e,n)}return Cn(t,e,n)}var $v,Md,zv,Bv;$v=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Md=function(){};zv=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,zr(ln.current);var i=null;switch(n){case"input":s=id(t,s),r=id(t,r),i=[];break;case"select":s=be({},s,{value:void 0}),r=be({},r,{value:void 0}),i=[];break;case"textarea":s=ld(t,s),r=ld(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Nl)}ud(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ho.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ho.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&xe("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Bv=function(t,e,n,r){n!==r&&(e.flags|=4)};function Fi(t,e){if(!Ee)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function rt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function EI(t,e,n){var r=e.pendingProps;switch(Bh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(e),null;case 1:return It(e.type)&&bl(),rt(e),null;case 3:return r=e.stateNode,Zs(),we(Et),we(lt),Jh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ra(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gt!==null&&(Hd(Gt),Gt=null))),Md(t,e),rt(e),null;case 5:Xh(e);var s=zr(To.current);if(n=e.type,t!==null&&e.stateNode!=null)zv(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return rt(e),null}if(t=zr(ln.current),Ra(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[on]=e,r[Eo]=i,t=(e.mode&1)!==0,n){case"dialog":xe("cancel",r),xe("close",r);break;case"iframe":case"object":case"embed":xe("load",r);break;case"video":case"audio":for(s=0;s<qi.length;s++)xe(qi[s],r);break;case"source":xe("error",r);break;case"img":case"image":case"link":xe("error",r),xe("load",r);break;case"details":xe("toggle",r);break;case"input":fp(r,i),xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},xe("invalid",r);break;case"textarea":pp(r,i),xe("invalid",r)}ud(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Ca(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Ca(r.textContent,c,t),s=["children",""+c]):ho.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&xe("scroll",r)}switch(n){case"input":Ia(r),mp(r,i,!0);break;case"textarea":Ia(r),gp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Nl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=y0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[on]=e,t[Eo]=r,$v(t,e,!1,!1),e.stateNode=t;e:{switch(o=dd(n,r),n){case"dialog":xe("cancel",t),xe("close",t),s=r;break;case"iframe":case"object":case"embed":xe("load",t),s=r;break;case"video":case"audio":for(s=0;s<qi.length;s++)xe(qi[s],t);s=r;break;case"source":xe("error",t),s=r;break;case"img":case"image":case"link":xe("error",t),xe("load",t),s=r;break;case"details":xe("toggle",t),s=r;break;case"input":fp(t,r),s=id(t,r),xe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=be({},r,{value:void 0}),xe("invalid",t);break;case"textarea":pp(t,r),s=ld(t,r),xe("invalid",t);break;default:s=r}ud(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?_0(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&v0(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&fo(t,u):typeof u=="number"&&fo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ho.hasOwnProperty(i)?u!=null&&i==="onScroll"&&xe("scroll",t):u!=null&&jh(t,i,u,o))}switch(n){case"input":Ia(t),mp(t,r,!1);break;case"textarea":Ia(t),gp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+yr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ms(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ms(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Nl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return rt(e),null;case 6:if(t&&e.stateNode!=null)Bv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(n=zr(To.current),zr(ln.current),Ra(e)){if(r=e.stateNode,n=e.memoizedProps,r[on]=e,(i=r.nodeValue!==n)&&(t=At,t!==null))switch(t.tag){case 3:Ca(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ca(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[on]=e,e.stateNode=r}return rt(e),null;case 13:if(we(Te),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ee&&St!==null&&e.mode&1&&!(e.flags&128))av(),Xs(),e.flags|=98560,i=!1;else if(i=Ra(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[on]=e}else Xs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;rt(e),i=!1}else Gt!==null&&(Hd(Gt),Gt=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Te.current&1?Ue===0&&(Ue=3):df())),e.updateQueue!==null&&(e.flags|=4),rt(e),null);case 4:return Zs(),Md(t,e),t===null&&_o(e.stateNode.containerInfo),rt(e),null;case 10:return Gh(e.type._context),rt(e),null;case 17:return It(e.type)&&bl(),rt(e),null;case 19:if(we(Te),i=e.memoizedState,i===null)return rt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Fi(i,!1);else{if(Ue!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Pl(t),o!==null){for(e.flags|=128,Fi(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ye(Te,Te.current&1|2),e.child}t=t.sibling}i.tail!==null&&Pe()>ti&&(e.flags|=128,r=!0,Fi(i,!1),e.lanes=4194304)}else{if(!r)if(t=Pl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Fi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ee)return rt(e),null}else 2*Pe()-i.renderingStartTime>ti&&n!==1073741824&&(e.flags|=128,r=!0,Fi(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Pe(),e.sibling=null,n=Te.current,ye(Te,r?n&1|2:n&1),e):(rt(e),null);case 22:case 23:return uf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bt&1073741824&&(rt(e),e.subtreeFlags&6&&(e.flags|=8192)):rt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function II(t,e){switch(Bh(e),e.tag){case 1:return It(e.type)&&bl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zs(),we(Et),we(lt),Jh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Xh(e),null;case 13:if(we(Te),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));Xs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return we(Te),null;case 4:return Zs(),null;case 10:return Gh(e.type._context),null;case 22:case 23:return uf(),null;case 24:return null;default:return null}}var Oa=!1,ot=!1,TI=typeof WeakSet=="function"?WeakSet:Set,K=null;function Ps(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ae(t,e,r)}else n.current=null}function Ld(t,e,n){try{n()}catch(r){Ae(t,e,r)}}var ig=!1;function NI(t,e){if(wd=El,t=K0(),$h(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,d=0,f=0,g=t,y=null;t:for(;;){for(var j;g!==n||s!==0&&g.nodeType!==3||(c=o+s),g!==i||r!==0&&g.nodeType!==3||(u=o+r),g.nodeType===3&&(o+=g.nodeValue.length),(j=g.firstChild)!==null;)y=g,g=j;for(;;){if(g===t)break t;if(y===n&&++d===s&&(c=o),y===i&&++f===r&&(u=o),(j=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=j}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ed={focusedElem:t,selectionRange:n},El=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var C=k.memoizedProps,V=k.memoizedState,T=e.stateNode,S=T.getSnapshotBeforeUpdate(e.elementType===e.type?C:Ht(e.type,C),V);T.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(R){Ae(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return k=ig,ig=!1,k}function no(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ld(e,n,i)}s=s.next}while(s!==r)}}function gc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Fd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function qv(t){var e=t.alternate;e!==null&&(t.alternate=null,qv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[on],delete e[Eo],delete e[Nd],delete e[aI],delete e[lI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Hv(t){return t.tag===5||t.tag===3||t.tag===4}function og(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Hv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ud(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Nl));else if(r!==4&&(t=t.child,t!==null))for(Ud(t,e,n),t=t.sibling;t!==null;)Ud(t,e,n),t=t.sibling}function $d(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($d(t,e,n),t=t.sibling;t!==null;)$d(t,e,n),t=t.sibling}var Ge=null,Wt=!1;function zn(t,e,n){for(n=n.child;n!==null;)Wv(t,e,n),n=n.sibling}function Wv(t,e,n){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(lc,n)}catch{}switch(n.tag){case 5:ot||Ps(n,e);case 6:var r=Ge,s=Wt;Ge=null,zn(t,e,n),Ge=r,Wt=s,Ge!==null&&(Wt?(t=Ge,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ge.removeChild(n.stateNode));break;case 18:Ge!==null&&(Wt?(t=Ge,n=n.stateNode,t.nodeType===8?Cu(t.parentNode,n):t.nodeType===1&&Cu(t,n),yo(t)):Cu(Ge,n.stateNode));break;case 4:r=Ge,s=Wt,Ge=n.stateNode.containerInfo,Wt=!0,zn(t,e,n),Ge=r,Wt=s;break;case 0:case 11:case 14:case 15:if(!ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Ld(n,e,o),s=s.next}while(s!==r)}zn(t,e,n);break;case 1:if(!ot&&(Ps(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Ae(n,e,c)}zn(t,e,n);break;case 21:zn(t,e,n);break;case 22:n.mode&1?(ot=(r=ot)||n.memoizedState!==null,zn(t,e,n),ot=r):zn(t,e,n);break;default:zn(t,e,n)}}function ag(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new TI),e.forEach(function(r){var s=DI.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function qt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:Ge=c.stateNode,Wt=!1;break e;case 3:Ge=c.stateNode.containerInfo,Wt=!0;break e;case 4:Ge=c.stateNode.containerInfo,Wt=!0;break e}c=c.return}if(Ge===null)throw Error(z(160));Wv(i,o,s),Ge=null,Wt=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ae(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Gv(e,t),e=e.sibling}function Gv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qt(e,t),nn(t),r&4){try{no(3,t,t.return),gc(3,t)}catch(C){Ae(t,t.return,C)}try{no(5,t,t.return)}catch(C){Ae(t,t.return,C)}}break;case 1:qt(e,t),nn(t),r&512&&n!==null&&Ps(n,n.return);break;case 5:if(qt(e,t),nn(t),r&512&&n!==null&&Ps(n,n.return),t.flags&32){var s=t.stateNode;try{fo(s,"")}catch(C){Ae(t,t.return,C)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&p0(s,i),dd(c,o);var d=dd(c,i);for(o=0;o<u.length;o+=2){var f=u[o],g=u[o+1];f==="style"?_0(s,g):f==="dangerouslySetInnerHTML"?v0(s,g):f==="children"?fo(s,g):jh(s,f,g,d)}switch(c){case"input":od(s,i);break;case"textarea":g0(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var j=i.value;j!=null?Ms(s,!!i.multiple,j,!1):y!==!!i.multiple&&(i.defaultValue!=null?Ms(s,!!i.multiple,i.defaultValue,!0):Ms(s,!!i.multiple,i.multiple?[]:"",!1))}s[Eo]=i}catch(C){Ae(t,t.return,C)}}break;case 6:if(qt(e,t),nn(t),r&4){if(t.stateNode===null)throw Error(z(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(C){Ae(t,t.return,C)}}break;case 3:if(qt(e,t),nn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{yo(e.containerInfo)}catch(C){Ae(t,t.return,C)}break;case 4:qt(e,t),nn(t);break;case 13:qt(e,t),nn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(lf=Pe())),r&4&&ag(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(ot=(d=ot)||f,qt(e,t),ot=d):qt(e,t),nn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(K=t,f=t.child;f!==null;){for(g=K=f;K!==null;){switch(y=K,j=y.child,y.tag){case 0:case 11:case 14:case 15:no(4,y,y.return);break;case 1:Ps(y,y.return);var k=y.stateNode;if(typeof k.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(C){Ae(r,n,C)}}break;case 5:Ps(y,y.return);break;case 22:if(y.memoizedState!==null){cg(g);continue}}j!==null?(j.return=y,K=j):cg(g)}f=f.sibling}e:for(f=null,g=t;;){if(g.tag===5){if(f===null){f=g;try{s=g.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=g.stateNode,u=g.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=x0("display",o))}catch(C){Ae(t,t.return,C)}}}else if(g.tag===6){if(f===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(C){Ae(t,t.return,C)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;f===g&&(f=null),g=g.return}f===g&&(f=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:qt(e,t),nn(t),r&4&&ag(t);break;case 21:break;default:qt(e,t),nn(t)}}function nn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Hv(n)){var r=n;break e}n=n.return}throw Error(z(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(fo(s,""),r.flags&=-33);var i=og(t);$d(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=og(t);Ud(t,c,o);break;default:throw Error(z(161))}}catch(u){Ae(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function bI(t,e,n){K=t,Kv(t)}function Kv(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var s=K,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Oa;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||ot;c=Oa;var d=ot;if(Oa=o,(ot=u)&&!d)for(K=s;K!==null;)o=K,u=o.child,o.tag===22&&o.memoizedState!==null?ug(s):u!==null?(u.return=o,K=u):ug(s);for(;i!==null;)K=i,Kv(i),i=i.sibling;K=s,Oa=c,ot=d}lg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,K=i):lg(t)}}function lg(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ot||gc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ot)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ht(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Wp(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Wp(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var g=f.dehydrated;g!==null&&yo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}ot||e.flags&512&&Fd(e)}catch(y){Ae(e,e.return,y)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function cg(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function ug(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{gc(4,e)}catch(u){Ae(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ae(e,s,u)}}var i=e.return;try{Fd(e)}catch(u){Ae(e,i,u)}break;case 5:var o=e.return;try{Fd(e)}catch(u){Ae(e,o,u)}}}catch(u){Ae(e,e.return,u)}if(e===t){K=null;break}var c=e.sibling;if(c!==null){c.return=e.return,K=c;break}K=e.return}}var SI=Math.ceil,Vl=Mn.ReactCurrentDispatcher,of=Mn.ReactCurrentOwner,Lt=Mn.ReactCurrentBatchConfig,ce=0,qe=null,Oe=null,Ye=0,bt=0,Ds=Sr(0),Ue=0,jo=null,Qr=0,yc=0,af=0,ro=null,xt=null,lf=0,ti=1/0,xn=null,Ml=!1,zd=null,ar=null,Va=!1,er=null,Ll=0,so=0,Bd=null,rl=-1,sl=0;function ft(){return ce&6?Pe():rl!==-1?rl:rl=Pe()}function lr(t){return t.mode&1?ce&2&&Ye!==0?Ye&-Ye:uI.transition!==null?(sl===0&&(sl=R0()),sl):(t=fe,t!==0||(t=window.event,t=t===void 0?16:F0(t.type)),t):1}function Xt(t,e,n,r){if(50<so)throw so=0,Bd=null,Error(z(185));Fo(t,n,r),(!(ce&2)||t!==qe)&&(t===qe&&(!(ce&2)&&(yc|=n),Ue===4&&Kn(t,Ye)),Tt(t,r),n===1&&ce===0&&!(e.mode&1)&&(ti=Pe()+500,fc&&jr()))}function Tt(t,e){var n=t.callbackNode;uE(t,e);var r=wl(t,t===qe?Ye:0);if(r===0)n!==null&&xp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&xp(n),e===1)t.tag===0?cI(dg.bind(null,t)):sv(dg.bind(null,t)),iI(function(){!(ce&6)&&jr()}),n=null;else{switch(P0(r)){case 1:n=Ph;break;case 4:n=k0;break;case 16:n=_l;break;case 536870912:n=C0;break;default:n=_l}n=nx(n,Qv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Qv(t,e){if(rl=-1,sl=0,ce&6)throw Error(z(327));var n=t.callbackNode;if(zs()&&t.callbackNode!==n)return null;var r=wl(t,t===qe?Ye:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Fl(t,r);else{e=r;var s=ce;ce|=2;var i=Xv();(qe!==t||Ye!==e)&&(xn=null,ti=Pe()+500,qr(t,e));do try{kI();break}catch(c){Yv(t,c)}while(!0);Wh(),Vl.current=i,ce=s,Oe!==null?e=0:(qe=null,Ye=0,e=Ue)}if(e!==0){if(e===2&&(s=gd(t),s!==0&&(r=s,e=qd(t,s))),e===1)throw n=jo,qr(t,0),Kn(t,r),Tt(t,Pe()),n;if(e===6)Kn(t,r);else{if(s=t.current.alternate,!(r&30)&&!jI(s)&&(e=Fl(t,r),e===2&&(i=gd(t),i!==0&&(r=i,e=qd(t,i))),e===1))throw n=jo,qr(t,0),Kn(t,r),Tt(t,Pe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:Lr(t,xt,xn);break;case 3:if(Kn(t,r),(r&130023424)===r&&(e=lf+500-Pe(),10<e)){if(wl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ft(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Td(Lr.bind(null,t,xt,xn),e);break}Lr(t,xt,xn);break;case 4:if(Kn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Yt(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Pe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*SI(r/1960))-r,10<r){t.timeoutHandle=Td(Lr.bind(null,t,xt,xn),r);break}Lr(t,xt,xn);break;case 5:Lr(t,xt,xn);break;default:throw Error(z(329))}}}return Tt(t,Pe()),t.callbackNode===n?Qv.bind(null,t):null}function qd(t,e){var n=ro;return t.current.memoizedState.isDehydrated&&(qr(t,e).flags|=256),t=Fl(t,e),t!==2&&(e=xt,xt=n,e!==null&&Hd(e)),t}function Hd(t){xt===null?xt=t:xt.push.apply(xt,t)}function jI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Jt(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Kn(t,e){for(e&=~af,e&=~yc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yt(e),r=1<<n;t[n]=-1,e&=~r}}function dg(t){if(ce&6)throw Error(z(327));zs();var e=wl(t,0);if(!(e&1))return Tt(t,Pe()),null;var n=Fl(t,e);if(t.tag!==0&&n===2){var r=gd(t);r!==0&&(e=r,n=qd(t,r))}if(n===1)throw n=jo,qr(t,0),Kn(t,e),Tt(t,Pe()),n;if(n===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Lr(t,xt,xn),Tt(t,Pe()),null}function cf(t,e){var n=ce;ce|=1;try{return t(e)}finally{ce=n,ce===0&&(ti=Pe()+500,fc&&jr())}}function Yr(t){er!==null&&er.tag===0&&!(ce&6)&&zs();var e=ce;ce|=1;var n=Lt.transition,r=fe;try{if(Lt.transition=null,fe=1,t)return t()}finally{fe=r,Lt.transition=n,ce=e,!(ce&6)&&jr()}}function uf(){bt=Ds.current,we(Ds)}function qr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,sI(n)),Oe!==null)for(n=Oe.return;n!==null;){var r=n;switch(Bh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&bl();break;case 3:Zs(),we(Et),we(lt),Jh();break;case 5:Xh(r);break;case 4:Zs();break;case 13:we(Te);break;case 19:we(Te);break;case 10:Gh(r.type._context);break;case 22:case 23:uf()}n=n.return}if(qe=t,Oe=t=cr(t.current,null),Ye=bt=e,Ue=0,jo=null,af=yc=Qr=0,xt=ro=null,$r!==null){for(e=0;e<$r.length;e++)if(n=$r[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}$r=null}return t}function Yv(t,e){do{var n=Oe;try{if(Wh(),el.current=Ol,Dl){for(var r=Ne.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Dl=!1}if(Kr=0,Be=Fe=Ne=null,to=!1,No=0,of.current=null,n===null||n.return===null){Ue=1,jo=e,Oe=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=Ye,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,g=f.tag;if(!(f.mode&1)&&(g===0||g===11||g===15)){var y=f.alternate;y?(f.updateQueue=y.updateQueue,f.memoizedState=y.memoizedState,f.lanes=y.lanes):(f.updateQueue=null,f.memoizedState=null)}var j=Jp(o);if(j!==null){j.flags&=-257,Zp(j,o,c,i,e),j.mode&1&&Xp(i,d,e),e=j,u=d;var k=e.updateQueue;if(k===null){var C=new Set;C.add(u),e.updateQueue=C}else k.add(u);break e}else{if(!(e&1)){Xp(i,d,e),df();break e}u=Error(z(426))}}else if(Ee&&c.mode&1){var V=Jp(o);if(V!==null){!(V.flags&65536)&&(V.flags|=256),Zp(V,o,c,i,e),qh(ei(u,c));break e}}i=u=ei(u,c),Ue!==4&&(Ue=2),ro===null?ro=[i]:ro.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var T=Pv(i,u,e);Hp(i,T);break e;case 1:c=u;var S=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof S.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(ar===null||!ar.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=Dv(i,c,e);Hp(i,R);break e}}i=i.return}while(i!==null)}Zv(n)}catch(A){e=A,Oe===n&&n!==null&&(Oe=n=n.return);continue}break}while(!0)}function Xv(){var t=Vl.current;return Vl.current=Ol,t===null?Ol:t}function df(){(Ue===0||Ue===3||Ue===2)&&(Ue=4),qe===null||!(Qr&268435455)&&!(yc&268435455)||Kn(qe,Ye)}function Fl(t,e){var n=ce;ce|=2;var r=Xv();(qe!==t||Ye!==e)&&(xn=null,qr(t,e));do try{AI();break}catch(s){Yv(t,s)}while(!0);if(Wh(),ce=n,Vl.current=r,Oe!==null)throw Error(z(261));return qe=null,Ye=0,Ue}function AI(){for(;Oe!==null;)Jv(Oe)}function kI(){for(;Oe!==null&&!tE();)Jv(Oe)}function Jv(t){var e=tx(t.alternate,t,bt);t.memoizedProps=t.pendingProps,e===null?Zv(t):Oe=e,of.current=null}function Zv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=II(n,e),n!==null){n.flags&=32767,Oe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ue=6,Oe=null;return}}else if(n=EI(n,e,bt),n!==null){Oe=n;return}if(e=e.sibling,e!==null){Oe=e;return}Oe=e=t}while(e!==null);Ue===0&&(Ue=5)}function Lr(t,e,n){var r=fe,s=Lt.transition;try{Lt.transition=null,fe=1,CI(t,e,n,r)}finally{Lt.transition=s,fe=r}return null}function CI(t,e,n,r){do zs();while(er!==null);if(ce&6)throw Error(z(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(dE(t,i),t===qe&&(Oe=qe=null,Ye=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Va||(Va=!0,nx(_l,function(){return zs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Lt.transition,Lt.transition=null;var o=fe;fe=1;var c=ce;ce|=4,of.current=null,NI(t,n),Gv(n,t),XE(Ed),El=!!wd,Ed=wd=null,t.current=n,bI(n),nE(),ce=c,fe=o,Lt.transition=i}else t.current=n;if(Va&&(Va=!1,er=t,Ll=s),i=t.pendingLanes,i===0&&(ar=null),iE(n.stateNode),Tt(t,Pe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ml)throw Ml=!1,t=zd,zd=null,t;return Ll&1&&t.tag!==0&&zs(),i=t.pendingLanes,i&1?t===Bd?so++:(so=0,Bd=t):so=0,jr(),null}function zs(){if(er!==null){var t=P0(Ll),e=Lt.transition,n=fe;try{if(Lt.transition=null,fe=16>t?16:t,er===null)var r=!1;else{if(t=er,er=null,Ll=0,ce&6)throw Error(z(331));var s=ce;for(ce|=4,K=t.current;K!==null;){var i=K,o=i.child;if(K.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(K=d;K!==null;){var f=K;switch(f.tag){case 0:case 11:case 15:no(8,f,i)}var g=f.child;if(g!==null)g.return=f,K=g;else for(;K!==null;){f=K;var y=f.sibling,j=f.return;if(qv(f),f===d){K=null;break}if(y!==null){y.return=j,K=y;break}K=j}}}var k=i.alternate;if(k!==null){var C=k.child;if(C!==null){k.child=null;do{var V=C.sibling;C.sibling=null,C=V}while(C!==null)}}K=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,K=o;else e:for(;K!==null;){if(i=K,i.flags&2048)switch(i.tag){case 0:case 11:case 15:no(9,i,i.return)}var T=i.sibling;if(T!==null){T.return=i.return,K=T;break e}K=i.return}}var S=t.current;for(K=S;K!==null;){o=K;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,K=N;else e:for(o=S;K!==null;){if(c=K,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:gc(9,c)}}catch(A){Ae(c,c.return,A)}if(c===o){K=null;break e}var R=c.sibling;if(R!==null){R.return=c.return,K=R;break e}K=c.return}}if(ce=s,jr(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(lc,t)}catch{}r=!0}return r}finally{fe=n,Lt.transition=e}}return!1}function hg(t,e,n){e=ei(n,e),e=Pv(t,e,1),t=or(t,e,1),e=ft(),t!==null&&(Fo(t,1,e),Tt(t,e))}function Ae(t,e,n){if(t.tag===3)hg(t,t,n);else for(;e!==null;){if(e.tag===3){hg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ar===null||!ar.has(r))){t=ei(n,t),t=Dv(e,t,1),e=or(e,t,1),t=ft(),e!==null&&(Fo(e,1,t),Tt(e,t));break}}e=e.return}}function RI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ft(),t.pingedLanes|=t.suspendedLanes&n,qe===t&&(Ye&n)===n&&(Ue===4||Ue===3&&(Ye&130023424)===Ye&&500>Pe()-lf?qr(t,0):af|=n),Tt(t,e)}function ex(t,e){e===0&&(t.mode&1?(e=ba,ba<<=1,!(ba&130023424)&&(ba=4194304)):e=1);var n=ft();t=kn(t,e),t!==null&&(Fo(t,e,n),Tt(t,n))}function PI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ex(t,n)}function DI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),ex(t,n)}var tx;tx=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Et.current)wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wt=!1,wI(t,e,n);wt=!!(t.flags&131072)}else wt=!1,Ee&&e.flags&1048576&&iv(e,Al,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;nl(t,e),t=e.pendingProps;var s=Ys(e,lt.current);$s(e,n),s=ef(null,e,r,t,s,n);var i=tf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,It(r)?(i=!0,Sl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Qh(e),s.updater=pc,e.stateNode=s,s._reactInternals=e,Cd(e,r,t,n),e=Dd(null,e,r,!0,i,n)):(e.tag=0,Ee&&i&&zh(e),ht(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(nl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=VI(r),t=Ht(r,t),s){case 0:e=Pd(null,e,r,t,n);break e;case 1:e=ng(null,e,r,t,n);break e;case 11:e=eg(null,e,r,t,n);break e;case 14:e=tg(null,e,r,Ht(r.type,t),n);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ht(r,s),Pd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ht(r,s),ng(t,e,r,s,n);case 3:e:{if(Lv(e),t===null)throw Error(z(387));r=e.pendingProps,i=e.memoizedState,s=i.element,dv(t,e),Rl(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ei(Error(z(423)),e),e=rg(t,e,r,n,s);break e}else if(r!==s){s=ei(Error(z(424)),e),e=rg(t,e,r,n,s);break e}else for(St=ir(e.stateNode.containerInfo.firstChild),At=e,Ee=!0,Gt=null,n=cv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xs(),r===s){e=Cn(t,e,n);break e}ht(t,e,r,n)}e=e.child}return e;case 5:return hv(e),t===null&&jd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Id(r,s)?o=null:i!==null&&Id(r,i)&&(e.flags|=32),Mv(t,e),ht(t,e,o,n),e.child;case 6:return t===null&&jd(e),null;case 13:return Fv(t,e,n);case 4:return Yh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Js(e,null,r,n):ht(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ht(r,s),eg(t,e,r,s,n);case 7:return ht(t,e,e.pendingProps,n),e.child;case 8:return ht(t,e,e.pendingProps.children,n),e.child;case 12:return ht(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ye(kl,r._currentValue),r._currentValue=o,i!==null)if(Jt(i.value,o)){if(i.children===s.children&&!Et.current){e=Cn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=bn(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Ad(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(z(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Ad(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ht(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,$s(e,n),s=Ut(s),r=r(s),e.flags|=1,ht(t,e,r,n),e.child;case 14:return r=e.type,s=Ht(r,e.pendingProps),s=Ht(r.type,s),tg(t,e,r,s,n);case 15:return Ov(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ht(r,s),nl(t,e),e.tag=1,It(r)?(t=!0,Sl(e)):t=!1,$s(e,n),Rv(e,r,s),Cd(e,r,s,n),Dd(null,e,r,!0,t,n);case 19:return Uv(t,e,n);case 22:return Vv(t,e,n)}throw Error(z(156,e.tag))};function nx(t,e){return A0(t,e)}function OI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mt(t,e,n,r){return new OI(t,e,n,r)}function hf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function VI(t){if(typeof t=="function")return hf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kh)return 11;if(t===Ch)return 14}return 2}function cr(t,e){var n=t.alternate;return n===null?(n=Mt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function il(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")hf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ts:return Hr(n.children,s,i,e);case Ah:o=8,s|=8;break;case td:return t=Mt(12,n,e,s|2),t.elementType=td,t.lanes=i,t;case nd:return t=Mt(13,n,e,s),t.elementType=nd,t.lanes=i,t;case rd:return t=Mt(19,n,e,s),t.elementType=rd,t.lanes=i,t;case h0:return vc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case u0:o=10;break e;case d0:o=9;break e;case kh:o=11;break e;case Ch:o=14;break e;case Hn:o=16,r=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=Mt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Hr(t,e,n,r){return t=Mt(7,t,r,e),t.lanes=n,t}function vc(t,e,n,r){return t=Mt(22,t,r,e),t.elementType=h0,t.lanes=n,t.stateNode={isHidden:!1},t}function Fu(t,e,n){return t=Mt(6,t,null,e),t.lanes=n,t}function Uu(t,e,n){return e=Mt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MI(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_u(0),this.expirationTimes=_u(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_u(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ff(t,e,n,r,s,i,o,c,u){return t=new MI(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Mt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qh(i),t}function LI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Is,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function rx(t){if(!t)return vr;t=t._reactInternals;e:{if(os(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(It(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var n=t.type;if(It(n))return rv(t,n,e)}return e}function sx(t,e,n,r,s,i,o,c,u){return t=ff(n,r,!0,t,s,i,o,c,u),t.context=rx(null),n=t.current,r=ft(),s=lr(n),i=bn(r,s),i.callback=e??null,or(n,i,s),t.current.lanes=s,Fo(t,s,r),Tt(t,r),t}function xc(t,e,n,r){var s=e.current,i=ft(),o=lr(s);return n=rx(n),e.context===null?e.context=n:e.pendingContext=n,e=bn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=or(s,e,o),t!==null&&(Xt(t,s,o,i),Za(t,s,o)),o}function Ul(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function mf(t,e){fg(t,e),(t=t.alternate)&&fg(t,e)}function FI(){return null}var ix=typeof reportError=="function"?reportError:function(t){console.error(t)};function pf(t){this._internalRoot=t}_c.prototype.render=pf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));xc(t,e,null,null)};_c.prototype.unmount=pf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Yr(function(){xc(null,t,null,null)}),e[An]=null}};function _c(t){this._internalRoot=t}_c.prototype.unstable_scheduleHydration=function(t){if(t){var e=V0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Gn.length&&e!==0&&e<Gn[n].priority;n++);Gn.splice(n,0,t),n===0&&L0(t)}};function gf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mg(){}function UI(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Ul(o);i.call(d)}}var o=sx(e,r,t,0,null,!1,!1,"",mg);return t._reactRootContainer=o,t[An]=o.current,_o(t.nodeType===8?t.parentNode:t),Yr(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=Ul(u);c.call(d)}}var u=ff(t,0,!1,null,null,!1,!1,"",mg);return t._reactRootContainer=u,t[An]=u.current,_o(t.nodeType===8?t.parentNode:t),Yr(function(){xc(e,u,n,r)}),u}function Ec(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=Ul(o);c.call(u)}}xc(e,o,t,s)}else o=UI(n,e,t,s,r);return Ul(o)}D0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Bi(e.pendingLanes);n!==0&&(Dh(e,n|1),Tt(e,Pe()),!(ce&6)&&(ti=Pe()+500,jr()))}break;case 13:Yr(function(){var r=kn(t,1);if(r!==null){var s=ft();Xt(r,t,1,s)}}),mf(t,1)}};Oh=function(t){if(t.tag===13){var e=kn(t,134217728);if(e!==null){var n=ft();Xt(e,t,134217728,n)}mf(t,134217728)}};O0=function(t){if(t.tag===13){var e=lr(t),n=kn(t,e);if(n!==null){var r=ft();Xt(n,t,e,r)}mf(t,e)}};V0=function(){return fe};M0=function(t,e){var n=fe;try{return fe=t,e()}finally{fe=n}};fd=function(t,e,n){switch(e){case"input":if(od(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=hc(r);if(!s)throw Error(z(90));m0(r),od(r,s)}}}break;case"textarea":g0(t,n);break;case"select":e=n.value,e!=null&&Ms(t,!!n.multiple,e,!1)}};I0=cf;T0=Yr;var $I={usingClientEntryPoint:!1,Events:[$o,js,hc,w0,E0,cf]},Ui={findFiberByHostInstance:Ur,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zI={bundleType:Ui.bundleType,version:Ui.version,rendererPackageName:Ui.rendererPackageName,rendererConfig:Ui.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=S0(t),t===null?null:t.stateNode},findFiberByHostInstance:Ui.findFiberByHostInstance||FI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ma=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ma.isDisabled&&Ma.supportsFiber)try{lc=Ma.inject(zI),an=Ma}catch{}}Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$I;Ct.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gf(e))throw Error(z(200));return LI(t,e,null,n)};Ct.createRoot=function(t,e){if(!gf(t))throw Error(z(299));var n=!1,r="",s=ix;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=ff(t,1,!1,null,null,n,!1,r,s),t[An]=e.current,_o(t.nodeType===8?t.parentNode:t),new pf(e)};Ct.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=S0(e),t=t===null?null:t.stateNode,t};Ct.flushSync=function(t){return Yr(t)};Ct.hydrate=function(t,e,n){if(!wc(e))throw Error(z(200));return Ec(null,t,e,!0,n)};Ct.hydrateRoot=function(t,e,n){if(!gf(t))throw Error(z(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=ix;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=sx(e,null,t,1,n??null,s,!1,i,o),t[An]=e.current,_o(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new _c(e)};Ct.render=function(t,e,n){if(!wc(e))throw Error(z(200));return Ec(null,t,e,!1,n)};Ct.unmountComponentAtNode=function(t){if(!wc(t))throw Error(z(40));return t._reactRootContainer?(Yr(function(){Ec(null,null,t,!1,function(){t._reactRootContainer=null,t[An]=null})}),!0):!1};Ct.unstable_batchedUpdates=cf;Ct.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!wc(n))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return Ec(t,e,n,!1,r)};Ct.version="18.3.1-next-f1338f8080-20240426";function ox(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ox)}catch(t){console.error(t)}}ox(),o0.exports=Ct;var BI=o0.exports,ax,pg=BI;ax=pg.createRoot,pg.hydrateRoot;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI=()=>{};var gg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},HI=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},cx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,g=(i&3)<<4|c>>4;let y=(c&15)<<2|d>>6,j=d&63;u||(j=64,o||(y=64)),r.push(n[f],n[g],n[y],n[j])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(lx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||g==null)throw new WI;const y=i<<2|c>>4;if(r.push(y),d!==64){const j=c<<4&240|d>>2;if(r.push(j),g!==64){const k=d<<6&192|g;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GI=function(t){const e=lx(t);return cx.encodeByteArray(e,!0)},$l=function(t){return GI(t).replace(/\./g,"")},ux=function(t){try{return cx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI=()=>KI().__FIREBASE_DEFAULTS__,YI=()=>{if(typeof process>"u"||typeof gg>"u")return;const t=gg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},XI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ux(t[1]);return e&&JSON.parse(e)},Ic=()=>{try{return qI()||QI()||YI()||XI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},dx=t=>{var e,n;return(n=(e=Ic())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},JI=t=>{const e=dx(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},hx=()=>{var t;return(t=Ic())===null||t===void 0?void 0:t.config},fx=t=>{var e;return(e=Ic())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function mx(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[$l(JSON.stringify(n)),$l(JSON.stringify(o)),""].join(".")}const io={};function tT(){const t={prod:[],emulator:[]};for(const e of Object.keys(io))io[e]?t.emulator.push(e):t.prod.push(e);return t}function nT(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let yg=!1;function px(t,e){if(typeof window>"u"||typeof document>"u"||!di(window.location.host)||io[t]===e||io[t]||yg)return;io[t]=e;function n(y){return`__firebase__banner__${y}`}const r="__firebase__banner",i=tT().prod.length>0;function o(){const y=document.getElementById(r);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,j){y.setAttribute("width","24"),y.setAttribute("id",j),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{yg=!0,o()},y}function f(y,j){y.setAttribute("id",j),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){const y=nT(r),j=n("text"),k=document.getElementById(j)||document.createElement("span"),C=n("learnmore"),V=document.getElementById(C)||document.createElement("a"),T=n("preprendIcon"),S=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const N=y.element;c(N),f(V,C);const R=d();u(S,T),N.append(S,k,V,R),document.body.appendChild(N)}i?(k.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ct())}function sT(){var t;const e=(t=Ic())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function aT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function lT(){const t=ct();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function cT(){return!sT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uT(){try{return typeof indexedDB=="object"}catch{return!1}}function dT(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="FirebaseError";class Ln extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=hT,Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bo.prototype.create)}}class Bo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?fT(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Ln(s,c,r)}}function fT(t,e){return t.replace(mT,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const mT=/\{\$([^}]+)}/g;function pT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(vg(i)&&vg(o)){if(!Xr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function vg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Hi(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Wi(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function gT(t,e){const n=new yT(t,e);return n.subscribe.bind(n)}class yT{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");vT(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=$u),s.error===void 0&&(s.error=$u),s.complete===void 0&&(s.complete=$u);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vT(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function $u(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function He(t){return t&&t._delegate?t._delegate:t}class Jr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ZI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wT(e))try{this.getOrInitializeService({instanceIdentifier:Fr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Fr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fr){return this.instances.has(e)}getOptions(e=Fr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:_T(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Fr){return this.component?this.component.multipleInstances?e:Fr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _T(t){return t===Fr?void 0:t}function wT(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new xT(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(oe||(oe={}));const IT={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},TT=oe.INFO,NT={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},bT=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=NT[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class yf{constructor(e){this.name=e,this._logLevel=TT,this._logHandler=bT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?IT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}}const ST=(t,e)=>e.some(n=>t instanceof n);let xg,_g;function jT(){return xg||(xg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AT(){return _g||(_g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gx=new WeakMap,Wd=new WeakMap,yx=new WeakMap,zu=new WeakMap,vf=new WeakMap;function kT(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ur(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&gx.set(n,t)}).catch(()=>{}),vf.set(e,t),e}function CT(t){if(Wd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Wd.set(t,e)}let Gd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Wd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||yx.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ur(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function RT(t){Gd=t(Gd)}function PT(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Bu(this),e,...n);return yx.set(r,e.sort?e.sort():[e]),ur(r)}:AT().includes(t)?function(...e){return t.apply(Bu(this),e),ur(gx.get(this))}:function(...e){return ur(t.apply(Bu(this),e))}}function DT(t){return typeof t=="function"?PT(t):(t instanceof IDBTransaction&&CT(t),ST(t,jT())?new Proxy(t,Gd):t)}function ur(t){if(t instanceof IDBRequest)return kT(t);if(zu.has(t))return zu.get(t);const e=DT(t);return e!==t&&(zu.set(t,e),vf.set(e,t)),e}const Bu=t=>vf.get(t);function OT(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=ur(o);return r&&o.addEventListener("upgradeneeded",u=>{r(ur(o.result),u.oldVersion,u.newVersion,ur(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const VT=["get","getKey","getAll","getAllKeys","count"],MT=["put","add","delete","clear"],qu=new Map;function wg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qu.get(e))return qu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=MT.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||VT.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return qu.set(e,i),i}RT(t=>({...t,get:(e,n,r)=>wg(e,n)||t.get(e,n,r),has:(e,n)=>!!wg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(FT(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function FT(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kd="@firebase/app",Eg="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new yf("@firebase/app"),UT="@firebase/app-compat",$T="@firebase/analytics-compat",zT="@firebase/analytics",BT="@firebase/app-check-compat",qT="@firebase/app-check",HT="@firebase/auth",WT="@firebase/auth-compat",GT="@firebase/database",KT="@firebase/data-connect",QT="@firebase/database-compat",YT="@firebase/functions",XT="@firebase/functions-compat",JT="@firebase/installations",ZT="@firebase/installations-compat",eN="@firebase/messaging",tN="@firebase/messaging-compat",nN="@firebase/performance",rN="@firebase/performance-compat",sN="@firebase/remote-config",iN="@firebase/remote-config-compat",oN="@firebase/storage",aN="@firebase/storage-compat",lN="@firebase/firestore",cN="@firebase/ai",uN="@firebase/firestore-compat",dN="firebase",hN="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd="[DEFAULT]",fN={[Kd]:"fire-core",[UT]:"fire-core-compat",[zT]:"fire-analytics",[$T]:"fire-analytics-compat",[qT]:"fire-app-check",[BT]:"fire-app-check-compat",[HT]:"fire-auth",[WT]:"fire-auth-compat",[GT]:"fire-rtdb",[KT]:"fire-data-connect",[QT]:"fire-rtdb-compat",[YT]:"fire-fn",[XT]:"fire-fn-compat",[JT]:"fire-iid",[ZT]:"fire-iid-compat",[eN]:"fire-fcm",[tN]:"fire-fcm-compat",[nN]:"fire-perf",[rN]:"fire-perf-compat",[sN]:"fire-rc",[iN]:"fire-rc-compat",[oN]:"fire-gcs",[aN]:"fire-gcs-compat",[lN]:"fire-fst",[uN]:"fire-fst-compat",[cN]:"fire-vertex","fire-js":"fire-js",[dN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zl=new Map,mN=new Map,Yd=new Map;function Ig(t,e){try{t.container.addComponent(e)}catch(n){Rn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ni(t){const e=t.name;if(Yd.has(e))return Rn.debug(`There were multiple attempts to register component ${e}.`),!1;Yd.set(e,t);for(const n of zl.values())Ig(n,t);for(const n of mN.values())Ig(n,t);return!0}function xf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ot(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dr=new Bo("app","Firebase",pN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Jr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=hN;function vx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Qd,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw dr.create("bad-app-name",{appName:String(s)});if(n||(n=hx()),!n)throw dr.create("no-options");const i=zl.get(s);if(i){if(Xr(n,i.options)&&Xr(r,i.config))return i;throw dr.create("duplicate-app",{appName:s})}const o=new ET(s);for(const u of Yd.values())o.addComponent(u);const c=new gN(n,r,o);return zl.set(s,c),c}function xx(t=Qd){const e=zl.get(t);if(!e&&t===Qd&&hx())return vx();if(!e)throw dr.create("no-app",{appName:t});return e}function hr(t,e,n){var r;let s=(r=fN[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Rn.warn(c.join(" "));return}ni(new Jr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN="firebase-heartbeat-database",vN=1,Ao="firebase-heartbeat-store";let Hu=null;function _x(){return Hu||(Hu=OT(yN,vN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ao)}catch(n){console.warn(n)}}}}).catch(t=>{throw dr.create("idb-open",{originalErrorMessage:t.message})})),Hu}async function xN(t){try{const n=(await _x()).transaction(Ao),r=await n.objectStore(Ao).get(wx(t));return await n.done,r}catch(e){if(e instanceof Ln)Rn.warn(e.message);else{const n=dr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Rn.warn(n.message)}}}async function Tg(t,e){try{const r=(await _x()).transaction(Ao,"readwrite");await r.objectStore(Ao).put(e,wx(t)),await r.done}catch(n){if(n instanceof Ln)Rn.warn(n.message);else{const r=dr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Rn.warn(r.message)}}}function wx(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N=1024,wN=30;class EN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new TN(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Ng();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>wN){const o=NN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Rn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ng(),{heartbeatsToSend:r,unsentEntries:s}=IN(this._heartbeatsCache.heartbeats),i=$l(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Rn.warn(n),""}}}function Ng(){return new Date().toISOString().substring(0,10)}function IN(t,e=_N){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),bg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),bg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class TN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uT()?dT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await xN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Tg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Tg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function bg(t){return $l(JSON.stringify({version:2,heartbeats:t})).length}function NN(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bN(t){ni(new Jr("platform-logger",e=>new LT(e),"PRIVATE")),ni(new Jr("heartbeat",e=>new EN(e),"PRIVATE")),hr(Kd,Eg,t),hr(Kd,Eg,"esm2017"),hr("fire-js","")}bN("");function _f(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Ex(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const SN=Ex,Ix=new Bo("auth","Firebase",Ex());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl=new yf("@firebase/auth");function jN(t,...e){Bl.logLevel<=oe.WARN&&Bl.warn(`Auth (${hi}): ${t}`,...e)}function ol(t,...e){Bl.logLevel<=oe.ERROR&&Bl.error(`Auth (${hi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(t,...e){throw wf(t,...e)}function cn(t,...e){return wf(t,...e)}function Tx(t,e,n){const r=Object.assign(Object.assign({},SN()),{[e]:n});return new Bo("auth","Firebase",r).create(e,{appName:t.name})}function Sn(t){return Tx(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Ix.create(t,...e)}function Z(t,e,...n){if(!t)throw wf(e,...n)}function Tn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ol(e),new Error(e)}function Pn(t,e){t||Tn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function AN(){return Sg()==="http:"||Sg()==="https:"}function Sg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AN()||oT()||"connection"in navigator)?navigator.onLine:!0}function CN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e,n){this.shortDelay=e,this.longDelay=n,Pn(n>e,"Short delay should be less than long delay!"),this.isMobile=rT()||aT()}get(){return kN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ef(t,e){Pn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],DN=new Ho(3e4,6e4);function Ar(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function kr(t,e,n,r,s={}){return bx(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=qo(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return iT()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&di(t.emulatorConfig.host)&&(d.credentials="include"),Nx.fetch()(await Sx(t,t.config.apiHost,n,c),d)})}async function bx(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},RN),e);try{const s=new VN(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw La(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw La(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw La(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw La(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Tx(t,f,d);Zt(t,f)}}catch(s){if(s instanceof Ln)throw s;Zt(t,"network-request-failed",{message:String(s)})}}async function Wo(t,e,n,r,s={}){const i=await kr(t,e,n,r,s);return"mfaPendingCredential"in i&&Zt(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Sx(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Ef(t.config,s):`${t.config.apiScheme}://${s}`;return PN.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function ON(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class VN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(cn(this.auth,"network-request-failed")),DN.get())})}}function La(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=cn(t,e,r);return s.customData._tokenResponse=n,s}function jg(t){return t!==void 0&&t.enterprise!==void 0}class MN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return ON(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function LN(t,e){return kr(t,"GET","/v2/recaptchaConfig",Ar(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FN(t,e){return kr(t,"POST","/v1/accounts:delete",e)}async function ql(t,e){return kr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UN(t,e=!1){const n=He(t),r=await n.getIdToken(e),s=If(r);Z(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:oo(Wu(s.auth_time)),issuedAtTime:oo(Wu(s.iat)),expirationTime:oo(Wu(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Wu(t){return Number(t)*1e3}function If(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ol("JWT malformed, contained fewer than 3 sections"),null;try{const s=ux(n);return s?JSON.parse(s):(ol("Failed to decode base64 JWT payload"),null)}catch(s){return ol("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Ag(t){const e=If(t);return Z(e,"internal-error"),Z(typeof e.exp<"u","internal-error"),Z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ln&&$N(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function $N({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=oo(this.lastLoginAt),this.creationTime=oo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hl(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ko(t,ql(n,{idToken:r}));Z(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?jx(i.providerUserInfo):[],c=qN(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),f=u?d:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new Jd(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,g)}async function BN(t){const e=He(t);await Hl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qN(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function jx(t){return t.map(e=>{var{providerId:n}=e,r=_f(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HN(t,e){const n=await bx(t,{},async()=>{const r=qo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Sx(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&di(t.emulatorConfig.host)&&(u.credentials="include"),Nx.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function WN(t,e){return kr(t,"POST","/v2/accounts:revokeToken",Ar(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Z(e.idToken,"internal-error"),Z(typeof e.idToken<"u","internal-error"),Z(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ag(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Z(e.length!==0,"internal-error");const n=Ag(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await HN(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Bs;return r&&(Z(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Z(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Z(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bs,this.toJSON())}_performRefresh(){return Tn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t,e){Z(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Qt{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=_f(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Jd(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ko(this,this.stsTokenManager.getToken(this.auth,e));return Z(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return UN(this,e)}reload(){return BN(this)}_assign(e){this!==e&&(Z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Qt(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Hl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ot(this.auth.app))return Promise.reject(Sn(this.auth));const e=await this.getIdToken();return await ko(this,FN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,c,u,d,f;const g=(r=n.displayName)!==null&&r!==void 0?r:void 0,y=(s=n.email)!==null&&s!==void 0?s:void 0,j=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,k=(o=n.photoURL)!==null&&o!==void 0?o:void 0,C=(c=n.tenantId)!==null&&c!==void 0?c:void 0,V=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,T=(d=n.createdAt)!==null&&d!==void 0?d:void 0,S=(f=n.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:N,emailVerified:R,isAnonymous:A,providerData:O,stsTokenManager:E}=n;Z(N&&E,e,"internal-error");const v=Bs.fromJSON(this.name,E);Z(typeof N=="string",e,"internal-error"),Bn(g,e.name),Bn(y,e.name),Z(typeof R=="boolean",e,"internal-error"),Z(typeof A=="boolean",e,"internal-error"),Bn(j,e.name),Bn(k,e.name),Bn(C,e.name),Bn(V,e.name),Bn(T,e.name),Bn(S,e.name);const p=new Qt({uid:N,auth:e,email:y,emailVerified:R,displayName:g,isAnonymous:A,photoURL:k,phoneNumber:j,tenantId:C,stsTokenManager:v,createdAt:T,lastLoginAt:S});return O&&Array.isArray(O)&&(p.providerData=O.map(I=>Object.assign({},I))),V&&(p._redirectEventId=V),p}static async _fromIdTokenResponse(e,n,r=!1){const s=new Bs;s.updateFromServerResponse(n);const i=new Qt({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Hl(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Z(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?jx(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new Bs;c.updateFromIdToken(r);const u=new Qt({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Jd(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg=new Map;function Nn(t){Pn(t instanceof Function,"Expected a class definition");let e=kg.get(t);return e?(Pn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,kg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Ax.type="NONE";const Cg=Ax;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(t,e,n){return`firebase:${t}:${e}:${n}`}class qs{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=al(this.userKey,s.apiKey,i),this.fullPersistenceKey=al("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ql(this.auth,{idToken:e}).catch(()=>{});return n?Qt._fromGetAccountInfoResponse(this.auth,n,e):null}return Qt._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new qs(Nn(Cg),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Nn(Cg);const o=al(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const f=await d._get(o);if(f){let g;if(typeof f=="string"){const y=await ql(e,{idToken:f}).catch(()=>{});if(!y)break;g=await Qt._fromGetAccountInfoResponse(e,y,f)}else g=Qt._fromJSON(e,f);d!==i&&(c=g),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new qs(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new qs(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Px(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(kx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Ox(e))return"Blackberry";if(Vx(e))return"Webos";if(Cx(e))return"Safari";if((e.includes("chrome/")||Rx(e))&&!e.includes("edge/"))return"Chrome";if(Dx(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function kx(t=ct()){return/firefox\//i.test(t)}function Cx(t=ct()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Rx(t=ct()){return/crios\//i.test(t)}function Px(t=ct()){return/iemobile/i.test(t)}function Dx(t=ct()){return/android/i.test(t)}function Ox(t=ct()){return/blackberry/i.test(t)}function Vx(t=ct()){return/webos/i.test(t)}function Tf(t=ct()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function GN(t=ct()){var e;return Tf(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KN(){return lT()&&document.documentMode===10}function Mx(t=ct()){return Tf(t)||Dx(t)||Vx(t)||Ox(t)||/windows phone/i.test(t)||Px(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx(t,e=[]){let n;switch(t){case"Browser":n=Rg(ct());break;case"Worker":n=`${Rg(ct())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YN(t,e={}){return kr(t,"GET","/v2/passwordPolicy",Ar(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN=6;class JN{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:XN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Pg(this),this.idTokenSubscription=new Pg(this),this.beforeStateQueue=new QN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ix,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Nn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await qs.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ql(this,{idToken:e}),r=await Qt._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Ot(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Z(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Hl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ot(this.app))return Promise.reject(Sn(this));const n=e?He(e):null;return n&&Z(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ot(this.app)?Promise.reject(Sn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ot(this.app)?Promise.reject(Sn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Nn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YN(this),n=new JN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await WN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Nn(e)||this._popupRedirectResolver;Z(n,this,"argument-error"),this.redirectPersistenceManager=await qs.create(this,[Nn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Z(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Lx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(Ot(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&jN(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function as(t){return He(t)}class Pg{constructor(e){this.auth=e,this.observer=null,this.addObserver=gT(n=>this.observer=n)}get next(){return Z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function eb(t){Tc=t}function Fx(t){return Tc.loadJS(t)}function tb(){return Tc.recaptchaEnterpriseScript}function nb(){return Tc.gapiScript}function rb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class sb{constructor(){this.enterprise=new ib}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class ib{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const ob="recaptcha-enterprise",Ux="NO_RECAPTCHA";class ab{constructor(e){this.type=ob,this.auth=as(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{LN(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new MN(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,o,c){const u=window.grecaptcha;jg(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(Ux)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new sb().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(c=>{if(!n&&jg(window.grecaptcha))s(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=tb();u.length!==0&&(u+=c),Fx(u).then(()=>{s(c,i,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function Dg(t,e,n,r=!1,s=!1){const i=new ab(t);let o;if(s)o=Ux;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const c=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Zd(t,e,n,r,s){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Dg(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Dg(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(t,e){const n=xf(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Xr(i,e??{}))return s;Zt(s,"already-initialized")}return n.initialize({options:e})}function cb(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Nn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function ub(t,e,n){const r=as(t);Z(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=$x(e),{host:o,port:c}=db(e),u=c===null?"":`:${c}`,d={url:`${i}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Z(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Z(Xr(d,r.config.emulator)&&Xr(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,di(o)?(mx(`${i}//${o}${u}`),px("Auth",!0)):hb()}function $x(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function db(t){const e=$x(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Og(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Og(o)}}}function Og(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function hb(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Tn("not implemented")}_getIdTokenResponse(e){return Tn("not implemented")}_linkToIdToken(e,n){return Tn("not implemented")}_getReauthenticationResolver(e){return Tn("not implemented")}}async function fb(t,e){return kr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mb(t,e){return Wo(t,"POST","/v1/accounts:signInWithPassword",Ar(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pb(t,e){return Wo(t,"POST","/v1/accounts:signInWithEmailLink",Ar(t,e))}async function gb(t,e){return Wo(t,"POST","/v1/accounts:signInWithEmailLink",Ar(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co extends Nf{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Co(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Co(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zd(e,n,"signInWithPassword",mb);case"emailLink":return pb(e,{email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zd(e,r,"signUpPassword",fb);case"emailLink":return gb(e,{idToken:n,email:this._email,oobCode:this._password});default:Zt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hs(t,e){return Wo(t,"POST","/v1/accounts:signInWithIdp",Ar(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb="http://localhost";class Zr extends Nf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Zr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=_f(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Zr(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Hs(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Hs(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Hs(e,n)}buildRequest(){const e={requestUri:yb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=qo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vb(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function xb(t){const e=Hi(Wi(t)).link,n=e?Hi(Wi(e)).deep_link_id:null,r=Hi(Wi(t)).deep_link_id;return(r?Hi(Wi(r)).link:null)||r||n||e||t}class bf{constructor(e){var n,r,s,i,o,c;const u=Hi(Wi(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,f=(r=u.oobCode)!==null&&r!==void 0?r:null,g=vb((s=u.mode)!==null&&s!==void 0?s:null);Z(d&&f&&g,"argument-error"),this.apiKey=d,this.operation=g,this.code=f,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const n=xb(e);try{return new bf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.providerId=fi.PROVIDER_ID}static credential(e,n){return Co._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=bf.parseLink(n);return Z(r,"argument-error"),Co._fromEmailAndCode(e,r.code,r.tenantId)}}fi.PROVIDER_ID="password";fi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";fi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends zx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn extends Go{constructor(){super("facebook.com")}static credential(e){return Zr._fromParams({providerId:Qn.PROVIDER_ID,signInMethod:Qn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qn.credentialFromTaggedObject(e)}static credentialFromError(e){return Qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qn.credential(e.oauthAccessToken)}catch{return null}}}Qn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn extends Go{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Zr._fromParams({providerId:Yn.PROVIDER_ID,signInMethod:Yn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Yn.credentialFromTaggedObject(e)}static credentialFromError(e){return Yn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Yn.credential(n,r)}catch{return null}}}Yn.GOOGLE_SIGN_IN_METHOD="google.com";Yn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn extends Go{constructor(){super("github.com")}static credential(e){return Zr._fromParams({providerId:Xn.PROVIDER_ID,signInMethod:Xn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xn.credentialFromTaggedObject(e)}static credentialFromError(e){return Xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xn.credential(e.oauthAccessToken)}catch{return null}}}Xn.GITHUB_SIGN_IN_METHOD="github.com";Xn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn extends Go{constructor(){super("twitter.com")}static credential(e,n){return Zr._fromParams({providerId:Jn.PROVIDER_ID,signInMethod:Jn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Jn.credentialFromTaggedObject(e)}static credentialFromError(e){return Jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Jn.credential(n,r)}catch{return null}}}Jn.TWITTER_SIGN_IN_METHOD="twitter.com";Jn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(t,e){return Wo(t,"POST","/v1/accounts:signUp",Ar(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Qt._fromIdTokenResponse(e,r,s),o=Vg(r);return new es({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Vg(r);return new es({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Vg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl extends Ln{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Wl.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Wl(e,n,r,s)}}function Bx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Wl._fromErrorAndOperation(t,i,e,r):i})}async function wb(t,e,n=!1){const r=await ko(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return es._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eb(t,e,n=!1){const{auth:r}=t;if(Ot(r.app))return Promise.reject(Sn(r));const s="reauthenticate";try{const i=await ko(t,Bx(r,s,e,t),n);Z(i.idToken,r,"internal-error");const o=If(i.idToken);Z(o,r,"internal-error");const{sub:c}=o;return Z(t.uid===c,r,"user-mismatch"),es._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Zt(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qx(t,e,n=!1){if(Ot(t.app))return Promise.reject(Sn(t));const r="signIn",s=await Bx(t,r,e),i=await es._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Ib(t,e){return qx(as(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hx(t){const e=as(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Tb(t,e,n){if(Ot(t.app))return Promise.reject(Sn(t));const r=as(t),o=await Zd(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_b).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Hx(t),u}),c=await es._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function Nb(t,e,n){return Ot(t.app)?Promise.reject(Sn(t)):Ib(He(t),fi.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Hx(t),r})}function bb(t,e,n,r){return He(t).onIdTokenChanged(e,n,r)}function Sb(t,e,n){return He(t).beforeAuthStateChanged(e,n)}function jb(t,e,n,r){return He(t).onAuthStateChanged(e,n,r)}function Ab(t){return He(t).signOut()}const Gl="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Gl,"1"),this.storage.removeItem(Gl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb=1e3,Cb=10;class Gx extends Wx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);KN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Cb):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},kb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Gx.type="LOCAL";const Rb=Gx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx extends Wx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Kx.type="SESSION";const Qx=Kx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Nc(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async d=>d(n.origin,i)),u=await Pb(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nc.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const d=Sf("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(g){const y=g;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(y.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(){return window}function Ob(t){un().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(){return typeof un().WorkerGlobalScope<"u"&&typeof un().importScripts=="function"}async function Vb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Mb(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Lb(){return Yx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx="firebaseLocalStorageDb",Fb=1,Kl="firebaseLocalStorage",Jx="fbase_key";class Ko{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function bc(t,e){return t.transaction([Kl],e?"readwrite":"readonly").objectStore(Kl)}function Ub(){const t=indexedDB.deleteDatabase(Xx);return new Ko(t).toPromise()}function eh(){const t=indexedDB.open(Xx,Fb);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Kl,{keyPath:Jx})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Kl)?e(r):(r.close(),await Ub(),e(await eh()))})})}async function Mg(t,e,n){const r=bc(t,!0).put({[Jx]:e,value:n});return new Ko(r).toPromise()}async function $b(t,e){const n=bc(t,!1).get(e),r=await new Ko(n).toPromise();return r===void 0?null:r.value}function Lg(t,e){const n=bc(t,!0).delete(e);return new Ko(n).toPromise()}const zb=800,Bb=3;class Zx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await eh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Bb)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nc._getInstance(Lb()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Vb(),!this.activeServiceWorker)return;this.sender=new Db(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Mb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await eh();return await Mg(e,Gl,"1"),await Lg(e,Gl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Mg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>$b(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Lg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=bc(s,!1).getAll();return new Ko(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Zx.type="LOCAL";const qb=Zx;new Ho(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hb(t,e){return e?Nn(e):(Z(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf extends Nf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Hs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Hs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Wb(t){return qx(t.auth,new jf(t),t.bypassAuthState)}function Gb(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),Eb(n,new jf(t),t.bypassAuthState)}async function Kb(t){const{auth:e,user:n}=t;return Z(n,e,"internal-error"),wb(n,new jf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Wb;case"linkViaPopup":case"linkViaRedirect":return Kb;case"reauthViaPopup":case"reauthViaRedirect":return Gb;default:Zt(this.auth,"internal-error")}}resolve(e){Pn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb=new Ho(2e3,1e4);class Os extends e_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Os.currentPopupAction&&Os.currentPopupAction.cancel(),Os.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Z(e,this.auth,"internal-error"),e}async onExecution(){Pn(this.filter.length===1,"Popup operations only handle one event");const e=Sf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(cn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(cn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Os.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(cn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Qb.get())};e()}}Os.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb="pendingRedirect",ll=new Map;class Xb extends e_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ll.get(this.auth._key());if(!e){try{const r=await Jb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ll.set(this.auth._key(),e)}return this.bypassAuthState||ll.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Jb(t,e){const n=tS(e),r=eS(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Zb(t,e){ll.set(t._key(),e)}function eS(t){return Nn(t._redirectPersistence)}function tS(t){return al(Yb,t.config.apiKey,t.name)}async function nS(t,e,n=!1){if(Ot(t.app))return Promise.reject(Sn(t));const r=as(t),s=Hb(r,e),o=await new Xb(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=10*60*1e3;class sS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!iS(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!t_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(cn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rS&&this.cachedEventUids.clear(),this.cachedEventUids.has(Fg(e))}saveEventToCache(e){this.cachedEventUids.add(Fg(e)),this.lastProcessedEventTime=Date.now()}}function Fg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function t_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function iS(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return t_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oS(t,e={}){return kr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lS=/^https?/;async function cS(t){if(t.config.emulator)return;const{authorizedDomains:e}=await oS(t);for(const n of e)try{if(uS(n))return}catch{}Zt(t,"unauthorized-domain")}function uS(t){const e=Xd(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!lS.test(n))return!1;if(aS.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS=new Ho(3e4,6e4);function Ug(){const t=un().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function hS(t){return new Promise((e,n)=>{var r,s,i;function o(){Ug(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ug(),n(cn(t,"network-request-failed"))},timeout:dS.get()})}if(!((s=(r=un().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=un().gapi)===null||i===void 0)&&i.load)o();else{const c=rb("iframefcb");return un()[c]=()=>{gapi.load?o():n(cn(t,"network-request-failed"))},Fx(`${nb()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw cl=null,e})}let cl=null;function fS(t){return cl=cl||hS(t),cl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS=new Ho(5e3,15e3),pS="__/auth/iframe",gS="emulator/auth/iframe",yS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xS(t){const e=t.config;Z(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ef(e,gS):`https://${t.config.authDomain}/${pS}`,r={apiKey:e.apiKey,appName:t.name,v:hi},s=vS.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${qo(r).slice(1)}`}async function _S(t){const e=await fS(t),n=un().gapi;return Z(n,t,"internal-error"),e.open({where:document.body,url:xS(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yS,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=cn(t,"network-request-failed"),c=un().setTimeout(()=>{i(o)},mS.get());function u(){un().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ES=500,IS=600,TS="_blank",NS="http://localhost";class $g{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bS(t,e,n,r=ES,s=IS){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},wS),{width:r.toString(),height:s.toString(),top:i,left:o}),d=ct().toLowerCase();n&&(c=Rx(d)?TS:n),kx(d)&&(e=e||NS,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[j,k])=>`${y}${j}=${k},`,"");if(GN(d)&&c!=="_self")return SS(e||"",c),new $g(null);const g=window.open(e||"",c,f);Z(g,t,"popup-blocked");try{g.focus()}catch{}return new $g(g)}function SS(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jS="__/auth/handler",AS="emulator/auth/handler",kS=encodeURIComponent("fac");async function zg(t,e,n,r,s,i){Z(t.config.authDomain,t,"auth-domain-config-required"),Z(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:hi,eventId:s};if(e instanceof zx){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",pT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,g]of Object.entries({}))o[f]=g}if(e instanceof Go){const f=e.getScopes().filter(g=>g!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${kS}=${encodeURIComponent(u)}`:"";return`${CS(t)}?${qo(c).slice(1)}${d}`}function CS({config:t}){return t.emulator?Ef(t,AS):`https://${t.authDomain}/${jS}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gu="webStorageSupport";class RS{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qx,this._completeRedirectFn=nS,this._overrideRedirectResult=Zb}async _openPopup(e,n,r,s){var i;Pn((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await zg(e,n,r,Xd(),s);return bS(e,o,Sf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await zg(e,n,r,Xd(),s);return Ob(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Pn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await _S(e),r=new sS(e);return n.register("authEvent",s=>(Z(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Gu,{type:Gu},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Gu];o!==void 0&&n(!!o),Zt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=cS(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Mx()||Cx()||Tf()}}const PS=RS;var Bg="@firebase/auth",qg="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function VS(t){ni(new Jr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;Z(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Lx(t)},d=new ZN(r,s,i,u);return cb(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ni(new Jr("auth-internal",e=>{const n=as(e.getProvider("auth").getImmediate());return(r=>new DS(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),hr(Bg,qg,OS(t)),hr(Bg,qg,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS=5*60,LS=fx("authIdTokenMaxAge")||MS;let Hg=null;const FS=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>LS)return;const s=n==null?void 0:n.token;Hg!==s&&(Hg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function US(t=xx()){const e=xf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=lb(t,{popupRedirectResolver:PS,persistence:[qb,Rb,Qx]}),r=fx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=FS(i.toString());Sb(n,o,()=>o(n.currentUser)),bb(n,c=>o(c))}}const s=dx("auth");return s&&ub(n,`http://${s}`),n}function $S(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}eb({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=cn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",$S().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});VS("Browser");var Wg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fr,n_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,v){function p(){}p.prototype=v.prototype,E.D=v.prototype,E.prototype=new p,E.prototype.constructor=E,E.C=function(I,b,_){for(var x=Array(arguments.length-2),D=2;D<arguments.length;D++)x[D-2]=arguments[D];return v.prototype[b].apply(I,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,v,p){p||(p=0);var I=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)I[b]=v.charCodeAt(p++)|v.charCodeAt(p++)<<8|v.charCodeAt(p++)<<16|v.charCodeAt(p++)<<24;else for(b=0;16>b;++b)I[b]=v[p++]|v[p++]<<8|v[p++]<<16|v[p++]<<24;v=E.g[0],p=E.g[1],b=E.g[2];var _=E.g[3],x=v+(_^p&(b^_))+I[0]+3614090360&4294967295;v=p+(x<<7&4294967295|x>>>25),x=_+(b^v&(p^b))+I[1]+3905402710&4294967295,_=v+(x<<12&4294967295|x>>>20),x=b+(p^_&(v^p))+I[2]+606105819&4294967295,b=_+(x<<17&4294967295|x>>>15),x=p+(v^b&(_^v))+I[3]+3250441966&4294967295,p=b+(x<<22&4294967295|x>>>10),x=v+(_^p&(b^_))+I[4]+4118548399&4294967295,v=p+(x<<7&4294967295|x>>>25),x=_+(b^v&(p^b))+I[5]+1200080426&4294967295,_=v+(x<<12&4294967295|x>>>20),x=b+(p^_&(v^p))+I[6]+2821735955&4294967295,b=_+(x<<17&4294967295|x>>>15),x=p+(v^b&(_^v))+I[7]+4249261313&4294967295,p=b+(x<<22&4294967295|x>>>10),x=v+(_^p&(b^_))+I[8]+1770035416&4294967295,v=p+(x<<7&4294967295|x>>>25),x=_+(b^v&(p^b))+I[9]+2336552879&4294967295,_=v+(x<<12&4294967295|x>>>20),x=b+(p^_&(v^p))+I[10]+4294925233&4294967295,b=_+(x<<17&4294967295|x>>>15),x=p+(v^b&(_^v))+I[11]+2304563134&4294967295,p=b+(x<<22&4294967295|x>>>10),x=v+(_^p&(b^_))+I[12]+1804603682&4294967295,v=p+(x<<7&4294967295|x>>>25),x=_+(b^v&(p^b))+I[13]+4254626195&4294967295,_=v+(x<<12&4294967295|x>>>20),x=b+(p^_&(v^p))+I[14]+2792965006&4294967295,b=_+(x<<17&4294967295|x>>>15),x=p+(v^b&(_^v))+I[15]+1236535329&4294967295,p=b+(x<<22&4294967295|x>>>10),x=v+(b^_&(p^b))+I[1]+4129170786&4294967295,v=p+(x<<5&4294967295|x>>>27),x=_+(p^b&(v^p))+I[6]+3225465664&4294967295,_=v+(x<<9&4294967295|x>>>23),x=b+(v^p&(_^v))+I[11]+643717713&4294967295,b=_+(x<<14&4294967295|x>>>18),x=p+(_^v&(b^_))+I[0]+3921069994&4294967295,p=b+(x<<20&4294967295|x>>>12),x=v+(b^_&(p^b))+I[5]+3593408605&4294967295,v=p+(x<<5&4294967295|x>>>27),x=_+(p^b&(v^p))+I[10]+38016083&4294967295,_=v+(x<<9&4294967295|x>>>23),x=b+(v^p&(_^v))+I[15]+3634488961&4294967295,b=_+(x<<14&4294967295|x>>>18),x=p+(_^v&(b^_))+I[4]+3889429448&4294967295,p=b+(x<<20&4294967295|x>>>12),x=v+(b^_&(p^b))+I[9]+568446438&4294967295,v=p+(x<<5&4294967295|x>>>27),x=_+(p^b&(v^p))+I[14]+3275163606&4294967295,_=v+(x<<9&4294967295|x>>>23),x=b+(v^p&(_^v))+I[3]+4107603335&4294967295,b=_+(x<<14&4294967295|x>>>18),x=p+(_^v&(b^_))+I[8]+1163531501&4294967295,p=b+(x<<20&4294967295|x>>>12),x=v+(b^_&(p^b))+I[13]+2850285829&4294967295,v=p+(x<<5&4294967295|x>>>27),x=_+(p^b&(v^p))+I[2]+4243563512&4294967295,_=v+(x<<9&4294967295|x>>>23),x=b+(v^p&(_^v))+I[7]+1735328473&4294967295,b=_+(x<<14&4294967295|x>>>18),x=p+(_^v&(b^_))+I[12]+2368359562&4294967295,p=b+(x<<20&4294967295|x>>>12),x=v+(p^b^_)+I[5]+4294588738&4294967295,v=p+(x<<4&4294967295|x>>>28),x=_+(v^p^b)+I[8]+2272392833&4294967295,_=v+(x<<11&4294967295|x>>>21),x=b+(_^v^p)+I[11]+1839030562&4294967295,b=_+(x<<16&4294967295|x>>>16),x=p+(b^_^v)+I[14]+4259657740&4294967295,p=b+(x<<23&4294967295|x>>>9),x=v+(p^b^_)+I[1]+2763975236&4294967295,v=p+(x<<4&4294967295|x>>>28),x=_+(v^p^b)+I[4]+1272893353&4294967295,_=v+(x<<11&4294967295|x>>>21),x=b+(_^v^p)+I[7]+4139469664&4294967295,b=_+(x<<16&4294967295|x>>>16),x=p+(b^_^v)+I[10]+3200236656&4294967295,p=b+(x<<23&4294967295|x>>>9),x=v+(p^b^_)+I[13]+681279174&4294967295,v=p+(x<<4&4294967295|x>>>28),x=_+(v^p^b)+I[0]+3936430074&4294967295,_=v+(x<<11&4294967295|x>>>21),x=b+(_^v^p)+I[3]+3572445317&4294967295,b=_+(x<<16&4294967295|x>>>16),x=p+(b^_^v)+I[6]+76029189&4294967295,p=b+(x<<23&4294967295|x>>>9),x=v+(p^b^_)+I[9]+3654602809&4294967295,v=p+(x<<4&4294967295|x>>>28),x=_+(v^p^b)+I[12]+3873151461&4294967295,_=v+(x<<11&4294967295|x>>>21),x=b+(_^v^p)+I[15]+530742520&4294967295,b=_+(x<<16&4294967295|x>>>16),x=p+(b^_^v)+I[2]+3299628645&4294967295,p=b+(x<<23&4294967295|x>>>9),x=v+(b^(p|~_))+I[0]+4096336452&4294967295,v=p+(x<<6&4294967295|x>>>26),x=_+(p^(v|~b))+I[7]+1126891415&4294967295,_=v+(x<<10&4294967295|x>>>22),x=b+(v^(_|~p))+I[14]+2878612391&4294967295,b=_+(x<<15&4294967295|x>>>17),x=p+(_^(b|~v))+I[5]+4237533241&4294967295,p=b+(x<<21&4294967295|x>>>11),x=v+(b^(p|~_))+I[12]+1700485571&4294967295,v=p+(x<<6&4294967295|x>>>26),x=_+(p^(v|~b))+I[3]+2399980690&4294967295,_=v+(x<<10&4294967295|x>>>22),x=b+(v^(_|~p))+I[10]+4293915773&4294967295,b=_+(x<<15&4294967295|x>>>17),x=p+(_^(b|~v))+I[1]+2240044497&4294967295,p=b+(x<<21&4294967295|x>>>11),x=v+(b^(p|~_))+I[8]+1873313359&4294967295,v=p+(x<<6&4294967295|x>>>26),x=_+(p^(v|~b))+I[15]+4264355552&4294967295,_=v+(x<<10&4294967295|x>>>22),x=b+(v^(_|~p))+I[6]+2734768916&4294967295,b=_+(x<<15&4294967295|x>>>17),x=p+(_^(b|~v))+I[13]+1309151649&4294967295,p=b+(x<<21&4294967295|x>>>11),x=v+(b^(p|~_))+I[4]+4149444226&4294967295,v=p+(x<<6&4294967295|x>>>26),x=_+(p^(v|~b))+I[11]+3174756917&4294967295,_=v+(x<<10&4294967295|x>>>22),x=b+(v^(_|~p))+I[2]+718787259&4294967295,b=_+(x<<15&4294967295|x>>>17),x=p+(_^(b|~v))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+v&4294967295,E.g[1]=E.g[1]+(b+(x<<21&4294967295|x>>>11))&4294967295,E.g[2]=E.g[2]+b&4294967295,E.g[3]=E.g[3]+_&4294967295}r.prototype.u=function(E,v){v===void 0&&(v=E.length);for(var p=v-this.blockSize,I=this.B,b=this.h,_=0;_<v;){if(b==0)for(;_<=p;)s(this,E,_),_+=this.blockSize;if(typeof E=="string"){for(;_<v;)if(I[b++]=E.charCodeAt(_++),b==this.blockSize){s(this,I),b=0;break}}else for(;_<v;)if(I[b++]=E[_++],b==this.blockSize){s(this,I),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var v=1;v<E.length-8;++v)E[v]=0;var p=8*this.o;for(v=E.length-8;v<E.length;++v)E[v]=p&255,p/=256;for(this.u(E),E=Array(16),v=p=0;4>v;++v)for(var I=0;32>I;I+=8)E[p++]=this.g[v]>>>I&255;return E};function i(E,v){var p=c;return Object.prototype.hasOwnProperty.call(p,E)?p[E]:p[E]=v(E)}function o(E,v){this.h=v;for(var p=[],I=!0,b=E.length-1;0<=b;b--){var _=E[b]|0;I&&_==v||(p[b]=_,I=!1)}this.g=p}var c={};function u(E){return-128<=E&&128>E?i(E,function(v){return new o([v|0],0>v?-1:0)}):new o([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return g;if(0>E)return V(d(-E));for(var v=[],p=1,I=0;E>=p;I++)v[I]=E/p|0,p*=4294967296;return new o(v,0)}function f(E,v){if(E.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(E.charAt(0)=="-")return V(f(E.substring(1),v));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var p=d(Math.pow(v,8)),I=g,b=0;b<E.length;b+=8){var _=Math.min(8,E.length-b),x=parseInt(E.substring(b,b+_),v);8>_?(_=d(Math.pow(v,_)),I=I.j(_).add(d(x))):(I=I.j(p),I=I.add(d(x)))}return I}var g=u(0),y=u(1),j=u(16777216);t=o.prototype,t.m=function(){if(C(this))return-V(this).m();for(var E=0,v=1,p=0;p<this.g.length;p++){var I=this.i(p);E+=(0<=I?I:4294967296+I)*v,v*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(k(this))return"0";if(C(this))return"-"+V(this).toString(E);for(var v=d(Math.pow(E,6)),p=this,I="";;){var b=R(p,v).g;p=T(p,b.j(v));var _=((0<p.g.length?p.g[0]:p.h)>>>0).toString(E);if(p=b,k(p))return _+I;for(;6>_.length;)_="0"+_;I=_+I}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function k(E){if(E.h!=0)return!1;for(var v=0;v<E.g.length;v++)if(E.g[v]!=0)return!1;return!0}function C(E){return E.h==-1}t.l=function(E){return E=T(this,E),C(E)?-1:k(E)?0:1};function V(E){for(var v=E.g.length,p=[],I=0;I<v;I++)p[I]=~E.g[I];return new o(p,~E.h).add(y)}t.abs=function(){return C(this)?V(this):this},t.add=function(E){for(var v=Math.max(this.g.length,E.g.length),p=[],I=0,b=0;b<=v;b++){var _=I+(this.i(b)&65535)+(E.i(b)&65535),x=(_>>>16)+(this.i(b)>>>16)+(E.i(b)>>>16);I=x>>>16,_&=65535,x&=65535,p[b]=x<<16|_}return new o(p,p[p.length-1]&-2147483648?-1:0)};function T(E,v){return E.add(V(v))}t.j=function(E){if(k(this)||k(E))return g;if(C(this))return C(E)?V(this).j(V(E)):V(V(this).j(E));if(C(E))return V(this.j(V(E)));if(0>this.l(j)&&0>E.l(j))return d(this.m()*E.m());for(var v=this.g.length+E.g.length,p=[],I=0;I<2*v;I++)p[I]=0;for(I=0;I<this.g.length;I++)for(var b=0;b<E.g.length;b++){var _=this.i(I)>>>16,x=this.i(I)&65535,D=E.i(b)>>>16,L=E.i(b)&65535;p[2*I+2*b]+=x*L,S(p,2*I+2*b),p[2*I+2*b+1]+=_*L,S(p,2*I+2*b+1),p[2*I+2*b+1]+=x*D,S(p,2*I+2*b+1),p[2*I+2*b+2]+=_*D,S(p,2*I+2*b+2)}for(I=0;I<v;I++)p[I]=p[2*I+1]<<16|p[2*I];for(I=v;I<2*v;I++)p[I]=0;return new o(p,0)};function S(E,v){for(;(E[v]&65535)!=E[v];)E[v+1]+=E[v]>>>16,E[v]&=65535,v++}function N(E,v){this.g=E,this.h=v}function R(E,v){if(k(v))throw Error("division by zero");if(k(E))return new N(g,g);if(C(E))return v=R(V(E),v),new N(V(v.g),V(v.h));if(C(v))return v=R(E,V(v)),new N(V(v.g),v.h);if(30<E.g.length){if(C(E)||C(v))throw Error("slowDivide_ only works with positive integers.");for(var p=y,I=v;0>=I.l(E);)p=A(p),I=A(I);var b=O(p,1),_=O(I,1);for(I=O(I,2),p=O(p,2);!k(I);){var x=_.add(I);0>=x.l(E)&&(b=b.add(p),_=x),I=O(I,1),p=O(p,1)}return v=T(E,b.j(v)),new N(b,v)}for(b=g;0<=E.l(v);){for(p=Math.max(1,Math.floor(E.m()/v.m())),I=Math.ceil(Math.log(p)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),_=d(p),x=_.j(v);C(x)||0<x.l(E);)p-=I,_=d(p),x=_.j(v);k(_)&&(_=y),b=b.add(_),E=T(E,x)}return new N(b,E)}t.A=function(E){return R(this,E).h},t.and=function(E){for(var v=Math.max(this.g.length,E.g.length),p=[],I=0;I<v;I++)p[I]=this.i(I)&E.i(I);return new o(p,this.h&E.h)},t.or=function(E){for(var v=Math.max(this.g.length,E.g.length),p=[],I=0;I<v;I++)p[I]=this.i(I)|E.i(I);return new o(p,this.h|E.h)},t.xor=function(E){for(var v=Math.max(this.g.length,E.g.length),p=[],I=0;I<v;I++)p[I]=this.i(I)^E.i(I);return new o(p,this.h^E.h)};function A(E){for(var v=E.g.length+1,p=[],I=0;I<v;I++)p[I]=E.i(I)<<1|E.i(I-1)>>>31;return new o(p,E.h)}function O(E,v){var p=v>>5;v%=32;for(var I=E.g.length-p,b=[],_=0;_<I;_++)b[_]=0<v?E.i(_+p)>>>v|E.i(_+p+1)<<32-v:E.i(_+p);return new o(b,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,n_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,fr=o}).apply(typeof Wg<"u"?Wg:typeof self<"u"?self:typeof window<"u"?window:{});var Fa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var r_,Gi,s_,ul,th,i_,o_,a_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,m){return l==Array.prototype||l==Object.prototype||(l[h]=m.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fa=="object"&&Fa];for(var h=0;h<l.length;++h){var m=l[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=n(this);function s(l,h){if(h)e:{var m=r;l=l.split(".");for(var w=0;w<l.length-1;w++){var P=l[w];if(!(P in m))break e;m=m[P]}l=l[l.length-1],w=m[l],h=h(w),h!=w&&h!=null&&e(m,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var m=0,w=!1,P={next:function(){if(!w&&m<l.length){var M=m++;return{value:h(M,l[M]),done:!1}}return w=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,m){return l.call.apply(l.bind,arguments)}function g(l,h,m){if(!l)throw Error();if(2<arguments.length){var w=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,w),l.apply(h,P)}}return function(){return l.apply(h,arguments)}}function y(l,h,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:g,y.apply(null,arguments)}function j(l,h){var m=Array.prototype.slice.call(arguments,1);return function(){var w=m.slice();return w.push.apply(w,arguments),l.apply(this,w)}}function k(l,h){function m(){}m.prototype=h.prototype,l.aa=h.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(w,P,M){for(var H=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)H[pe-2]=arguments[pe];return h.prototype[P].apply(w,H)}}function C(l){const h=l.length;if(0<h){const m=Array(h);for(let w=0;w<h;w++)m[w]=l[w];return m}return[]}function V(l,h){for(let m=1;m<arguments.length;m++){const w=arguments[m];if(u(w)){const P=l.length||0,M=w.length||0;l.length=P+M;for(let H=0;H<M;H++)l[P+H]=w[H]}else l.push(w)}}class T{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function S(l){return/^[\s\xa0]*$/.test(l)}function N(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function R(l){return R[" "](l),l}R[" "]=function(){};var A=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function O(l,h,m){for(const w in l)h.call(m,l[w],w,l)}function E(l,h){for(const m in l)h.call(void 0,l[m],m,l)}function v(l){const h={};for(const m in l)h[m]=l[m];return h}const p="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(l,h){let m,w;for(let P=1;P<arguments.length;P++){w=arguments[P];for(m in w)l[m]=w[m];for(let M=0;M<p.length;M++)m=p[M],Object.prototype.hasOwnProperty.call(w,m)&&(l[m]=w[m])}}function b(l){var h=1;l=l.split(":");const m=[];for(;0<h&&l.length;)m.push(l.shift()),h--;return l.length&&m.push(l.join(":")),m}function _(l){c.setTimeout(()=>{throw l},0)}function x(){var l=q;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class D{constructor(){this.h=this.g=null}add(h,m){const w=L.get();w.set(h,m),this.h?this.h.next=w:this.g=w,this.h=w}}var L=new T(()=>new B,l=>l.reset());class B{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let X,$=!1,q=new D,Q=()=>{const l=c.Promise.resolve(void 0);X=()=>{l.then(re)}};var re=()=>{for(var l;l=x();){try{l.h.call(l.g)}catch(m){_(m)}var h=L;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}$=!1};function de(){this.s=this.s,this.C=this.C}de.prototype.s=!1,de.prototype.ma=function(){this.s||(this.s=!0,this.N())},de.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var tn=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const m=()=>{};c.addEventListener("test",m,h),c.removeEventListener("test",m,h)}catch{}return l}();function zt(l,h){if(Ie.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,w=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(A){e:{try{R(h.nodeName);var P=!0;break e}catch{}P=!1}P||(h=null)}}else m=="mouseover"?h=l.fromElement:m=="mouseout"&&(h=l.toElement);this.relatedTarget=h,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:ke[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&zt.aa.h.call(this)}}k(zt,Ie);var ke={2:"touch",3:"pen",4:"mouse"};zt.prototype.h=function(){zt.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var gn="closure_listenable_"+(1e6*Math.random()|0),$w=0;function zw(l,h,m,w,P){this.listener=l,this.proxy=null,this.src=h,this.type=m,this.capture=!!w,this.ha=P,this.key=++$w,this.da=this.fa=!1}function ra(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function sa(l){this.src=l,this.g={},this.h=0}sa.prototype.add=function(l,h,m,w,P){var M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);var H=Gc(l,h,w,P);return-1<H?(h=l[H],m||(h.fa=!1)):(h=new zw(h,this.src,M,!!w,P),h.fa=m,l.push(h)),h};function Wc(l,h){var m=h.type;if(m in l.g){var w=l.g[m],P=Array.prototype.indexOf.call(w,h,void 0),M;(M=0<=P)&&Array.prototype.splice.call(w,P,1),M&&(ra(h),l.g[m].length==0&&(delete l.g[m],l.h--))}}function Gc(l,h,m,w){for(var P=0;P<l.length;++P){var M=l[P];if(!M.da&&M.listener==h&&M.capture==!!m&&M.ha==w)return P}return-1}var Kc="closure_lm_"+(1e6*Math.random()|0),Qc={};function lm(l,h,m,w,P){if(Array.isArray(h)){for(var M=0;M<h.length;M++)lm(l,h[M],m,w,P);return null}return m=dm(m),l&&l[gn]?l.K(h,m,d(w)?!!w.capture:!!w,P):Bw(l,h,m,!1,w,P)}function Bw(l,h,m,w,P,M){if(!h)throw Error("Invalid event type");var H=d(P)?!!P.capture:!!P,pe=Xc(l);if(pe||(l[Kc]=pe=new sa(l)),m=pe.add(h,m,w,H,M),m.proxy)return m;if(w=qw(),m.proxy=w,w.src=l,w.listener=m,l.addEventListener)tn||(P=H),P===void 0&&(P=!1),l.addEventListener(h.toString(),w,P);else if(l.attachEvent)l.attachEvent(um(h.toString()),w);else if(l.addListener&&l.removeListener)l.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return m}function qw(){function l(m){return h.call(l.src,l.listener,m)}const h=Hw;return l}function cm(l,h,m,w,P){if(Array.isArray(h))for(var M=0;M<h.length;M++)cm(l,h[M],m,w,P);else w=d(w)?!!w.capture:!!w,m=dm(m),l&&l[gn]?(l=l.i,h=String(h).toString(),h in l.g&&(M=l.g[h],m=Gc(M,m,w,P),-1<m&&(ra(M[m]),Array.prototype.splice.call(M,m,1),M.length==0&&(delete l.g[h],l.h--)))):l&&(l=Xc(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Gc(h,m,w,P)),(m=-1<l?h[l]:null)&&Yc(m))}function Yc(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[gn])Wc(h.i,l);else{var m=l.type,w=l.proxy;h.removeEventListener?h.removeEventListener(m,w,l.capture):h.detachEvent?h.detachEvent(um(m),w):h.addListener&&h.removeListener&&h.removeListener(w),(m=Xc(h))?(Wc(m,l),m.h==0&&(m.src=null,h[Kc]=null)):ra(l)}}}function um(l){return l in Qc?Qc[l]:Qc[l]="on"+l}function Hw(l,h){if(l.da)l=!0;else{h=new zt(h,this);var m=l.listener,w=l.ha||l.src;l.fa&&Yc(l),l=m.call(w,h)}return l}function Xc(l){return l=l[Kc],l instanceof sa?l:null}var Jc="__closure_events_fn_"+(1e9*Math.random()>>>0);function dm(l){return typeof l=="function"?l:(l[Jc]||(l[Jc]=function(h){return l.handleEvent(h)}),l[Jc])}function Ze(){de.call(this),this.i=new sa(this),this.M=this,this.F=null}k(Ze,de),Ze.prototype[gn]=!0,Ze.prototype.removeEventListener=function(l,h,m,w){cm(this,l,h,m,w)};function ut(l,h){var m,w=l.F;if(w)for(m=[];w;w=w.F)m.push(w);if(l=l.M,w=h.type||h,typeof h=="string")h=new Ie(h,l);else if(h instanceof Ie)h.target=h.target||l;else{var P=h;h=new Ie(w,l),I(h,P)}if(P=!0,m)for(var M=m.length-1;0<=M;M--){var H=h.g=m[M];P=ia(H,w,!0,h)&&P}if(H=h.g=l,P=ia(H,w,!0,h)&&P,P=ia(H,w,!1,h)&&P,m)for(M=0;M<m.length;M++)H=h.g=m[M],P=ia(H,w,!1,h)&&P}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var m=l.g[h],w=0;w<m.length;w++)ra(m[w]);delete l.g[h],l.h--}}this.F=null},Ze.prototype.K=function(l,h,m,w){return this.i.add(String(l),h,!1,m,w)},Ze.prototype.L=function(l,h,m,w){return this.i.add(String(l),h,!0,m,w)};function ia(l,h,m,w){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var P=!0,M=0;M<h.length;++M){var H=h[M];if(H&&!H.da&&H.capture==m){var pe=H.listener,We=H.ha||H.src;H.fa&&Wc(l.i,H),P=pe.call(We,w)!==!1&&P}}return P&&!w.defaultPrevented}function hm(l,h,m){if(typeof l=="function")m&&(l=y(l,m));else if(l&&typeof l.handleEvent=="function")l=y(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function fm(l){l.g=hm(()=>{l.g=null,l.i&&(l.i=!1,fm(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Ww extends de{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:fm(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _i(l){de.call(this),this.h=l,this.g={}}k(_i,de);var mm=[];function pm(l){O(l.g,function(h,m){this.g.hasOwnProperty(m)&&Yc(h)},l),l.g={}}_i.prototype.N=function(){_i.aa.N.call(this),pm(this)},_i.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zc=c.JSON.stringify,Gw=c.JSON.parse,Kw=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function eu(){}eu.prototype.h=null;function gm(l){return l.h||(l.h=l.i())}function ym(){}var wi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function tu(){Ie.call(this,"d")}k(tu,Ie);function nu(){Ie.call(this,"c")}k(nu,Ie);var Pr={},vm=null;function oa(){return vm=vm||new Ze}Pr.La="serverreachability";function xm(l){Ie.call(this,Pr.La,l)}k(xm,Ie);function Ei(l){const h=oa();ut(h,new xm(h))}Pr.STAT_EVENT="statevent";function _m(l,h){Ie.call(this,Pr.STAT_EVENT,l),this.stat=h}k(_m,Ie);function dt(l){const h=oa();ut(h,new _m(h,l))}Pr.Ma="timingevent";function wm(l,h){Ie.call(this,Pr.Ma,l),this.size=h}k(wm,Ie);function Ii(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function Ti(){this.g=!0}Ti.prototype.xa=function(){this.g=!1};function Qw(l,h,m,w,P,M){l.info(function(){if(l.g)if(M)for(var H="",pe=M.split("&"),We=0;We<pe.length;We++){var ue=pe[We].split("=");if(1<ue.length){var et=ue[0];ue=ue[1];var tt=et.split("_");H=2<=tt.length&&tt[1]=="type"?H+(et+"="+ue+"&"):H+(et+"=redacted&")}}else H=null;else H=M;return"XMLHTTP REQ ("+w+") [attempt "+P+"]: "+h+`
`+m+`
`+H})}function Yw(l,h,m,w,P,M,H){l.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+P+"]: "+h+`
`+m+`
`+M+" "+H})}function us(l,h,m,w){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+Jw(l,m)+(w?" "+w:"")})}function Xw(l,h){l.info(function(){return"TIMEOUT: "+h})}Ti.prototype.info=function(){};function Jw(l,h){if(!l.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var w=m[l];if(!(2>w.length)){var P=w[1];if(Array.isArray(P)&&!(1>P.length)){var M=P[0];if(M!="noop"&&M!="stop"&&M!="close")for(var H=1;H<P.length;H++)P[H]=""}}}}return Zc(m)}catch{return h}}var aa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Em={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ru;function la(){}k(la,eu),la.prototype.g=function(){return new XMLHttpRequest},la.prototype.i=function(){return{}},ru=new la;function Fn(l,h,m,w){this.j=l,this.i=h,this.l=m,this.R=w||1,this.U=new _i(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Im}function Im(){this.i=null,this.g="",this.h=!1}var Tm={},su={};function iu(l,h,m){l.L=1,l.v=ha(yn(h)),l.m=m,l.P=!0,Nm(l,null)}function Nm(l,h){l.F=Date.now(),ca(l),l.A=yn(l.v);var m=l.A,w=l.R;Array.isArray(w)||(w=[String(w)]),Fm(m.i,"t",w),l.C=0,m=l.j.J,l.h=new Im,l.g=rp(l.j,m?h:null,!l.m),0<l.O&&(l.M=new Ww(y(l.Y,l,l.g),l.O)),h=l.U,m=l.g,w=l.ca;var P="readystatechange";Array.isArray(P)||(P&&(mm[0]=P.toString()),P=mm);for(var M=0;M<P.length;M++){var H=lm(m,P[M],w||h.handleEvent,!1,h.h||h);if(!H)break;h.g[H.key]=H}h=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Ei(),Qw(l.i,l.u,l.A,l.l,l.R,l.m)}Fn.prototype.ca=function(l){l=l.target;const h=this.M;h&&vn(l)==3?h.j():this.Y(l)},Fn.prototype.Y=function(l){try{if(l==this.g)e:{const tt=vn(this.g);var h=this.g.Ba();const fs=this.g.Z();if(!(3>tt)&&(tt!=3||this.g&&(this.h.h||this.g.oa()||Wm(this.g)))){this.J||tt!=4||h==7||(h==8||0>=fs?Ei(3):Ei(2)),ou(this);var m=this.g.Z();this.X=m;t:if(bm(this)){var w=Wm(this.g);l="";var P=w.length,M=vn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Dr(this),Ni(this);var H="";break t}this.h.i=new c.TextDecoder}for(h=0;h<P;h++)this.h.h=!0,l+=this.h.i.decode(w[h],{stream:!(M&&h==P-1)});w.length=0,this.h.g+=l,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=m==200,Yw(this.i,this.u,this.A,this.l,this.R,tt,m),this.o){if(this.T&&!this.K){t:{if(this.g){var pe,We=this.g;if((pe=We.g?We.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(pe)){var ue=pe;break t}}ue=null}if(m=ue)us(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,au(this,m);else{this.o=!1,this.s=3,dt(12),Dr(this),Ni(this);break e}}if(this.P){m=!0;let Bt;for(;!this.J&&this.C<H.length;)if(Bt=Zw(this,H),Bt==su){tt==4&&(this.s=4,dt(14),m=!1),us(this.i,this.l,null,"[Incomplete Response]");break}else if(Bt==Tm){this.s=4,dt(15),us(this.i,this.l,H,"[Invalid Chunk]"),m=!1;break}else us(this.i,this.l,Bt,null),au(this,Bt);if(bm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tt!=4||H.length!=0||this.h.h||(this.s=1,dt(16),m=!1),this.o=this.o&&m,!m)us(this.i,this.l,H,"[Invalid Chunked Response]"),Dr(this),Ni(this);else if(0<H.length&&!this.W){this.W=!0;var et=this.j;et.g==this&&et.ba&&!et.M&&(et.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),fu(et),et.M=!0,dt(11))}}else us(this.i,this.l,H,null),au(this,H);tt==4&&Dr(this),this.o&&!this.J&&(tt==4?Zm(this.j,this):(this.o=!1,ca(this)))}else g1(this.g),m==400&&0<H.indexOf("Unknown SID")?(this.s=3,dt(12)):(this.s=0,dt(13)),Dr(this),Ni(this)}}}catch{}finally{}};function bm(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Zw(l,h){var m=l.C,w=h.indexOf(`
`,m);return w==-1?su:(m=Number(h.substring(m,w)),isNaN(m)?Tm:(w+=1,w+m>h.length?su:(h=h.slice(w,w+m),l.C=w+m,h)))}Fn.prototype.cancel=function(){this.J=!0,Dr(this)};function ca(l){l.S=Date.now()+l.I,Sm(l,l.I)}function Sm(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Ii(y(l.ba,l),h)}function ou(l){l.B&&(c.clearTimeout(l.B),l.B=null)}Fn.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(Xw(this.i,this.A),this.L!=2&&(Ei(),dt(17)),Dr(this),this.s=2,Ni(this)):Sm(this,this.S-l)};function Ni(l){l.j.G==0||l.J||Zm(l.j,l)}function Dr(l){ou(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,pm(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function au(l,h){try{var m=l.j;if(m.G!=0&&(m.g==l||lu(m.h,l))){if(!l.K&&lu(m.h,l)&&m.G==3){try{var w=m.Da.g.parse(h)}catch{w=null}if(Array.isArray(w)&&w.length==3){var P=w;if(P[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)va(m),ga(m);else break e;hu(m),dt(18)}}else m.za=P[1],0<m.za-m.T&&37500>P[2]&&m.F&&m.v==0&&!m.C&&(m.C=Ii(y(m.Za,m),6e3));if(1>=km(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else Vr(m,11)}else if((l.K||m.g==l)&&va(m),!S(h))for(P=m.Da.g.parse(h),h=0;h<P.length;h++){let ue=P[h];if(m.T=ue[0],ue=ue[1],m.G==2)if(ue[0]=="c"){m.K=ue[1],m.ia=ue[2];const et=ue[3];et!=null&&(m.la=et,m.j.info("VER="+m.la));const tt=ue[4];tt!=null&&(m.Aa=tt,m.j.info("SVER="+m.Aa));const fs=ue[5];fs!=null&&typeof fs=="number"&&0<fs&&(w=1.5*fs,m.L=w,m.j.info("backChannelRequestTimeoutMs_="+w)),w=m;const Bt=l.g;if(Bt){const _a=Bt.g?Bt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_a){var M=w.h;M.g||_a.indexOf("spdy")==-1&&_a.indexOf("quic")==-1&&_a.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(cu(M,M.h),M.h=null))}if(w.D){const mu=Bt.g?Bt.g.getResponseHeader("X-HTTP-Session-Id"):null;mu&&(w.ya=mu,ve(w.I,w.D,mu))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),w=m;var H=l;if(w.qa=np(w,w.J?w.ia:null,w.W),H.K){Cm(w.h,H);var pe=H,We=w.L;We&&(pe.I=We),pe.B&&(ou(pe),ca(pe)),w.g=H}else Xm(w);0<m.i.length&&ya(m)}else ue[0]!="stop"&&ue[0]!="close"||Vr(m,7);else m.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?Vr(m,7):du(m):ue[0]!="noop"&&m.l&&m.l.ta(ue),m.v=0)}}Ei(4)}catch{}}var e1=class{constructor(l,h){this.g=l,this.map=h}};function jm(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Am(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function km(l){return l.h?1:l.g?l.g.size:0}function lu(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function cu(l,h){l.g?l.g.add(h):l.h=h}function Cm(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}jm.prototype.cancel=function(){if(this.i=Rm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Rm(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const m of l.g.values())h=h.concat(m.D);return h}return C(l.i)}function t1(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],m=l.length,w=0;w<m;w++)h.push(l[w]);return h}h=[],m=0;for(w in l)h[m++]=l[w];return h}function n1(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var m=0;m<l;m++)h.push(m);return h}h=[],m=0;for(const w in l)h[m++]=w;return h}}}function Pm(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var m=n1(l),w=t1(l),P=w.length,M=0;M<P;M++)h.call(void 0,w[M],m&&m[M],l)}var Dm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function r1(l,h){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var w=l[m].indexOf("="),P=null;if(0<=w){var M=l[m].substring(0,w);P=l[m].substring(w+1)}else M=l[m];h(M,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function Or(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Or){this.h=l.h,ua(this,l.j),this.o=l.o,this.g=l.g,da(this,l.s),this.l=l.l;var h=l.i,m=new ji;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),Om(this,m),this.m=l.m}else l&&(h=String(l).match(Dm))?(this.h=!1,ua(this,h[1]||"",!0),this.o=bi(h[2]||""),this.g=bi(h[3]||"",!0),da(this,h[4]),this.l=bi(h[5]||"",!0),Om(this,h[6]||"",!0),this.m=bi(h[7]||"")):(this.h=!1,this.i=new ji(null,this.h))}Or.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Si(h,Vm,!0),":");var m=this.g;return(m||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Si(h,Vm,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(Si(m,m.charAt(0)=="/"?o1:i1,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",Si(m,l1)),l.join("")};function yn(l){return new Or(l)}function ua(l,h,m){l.j=m?bi(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function da(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Om(l,h,m){h instanceof ji?(l.i=h,c1(l.i,l.h)):(m||(h=Si(h,a1)),l.i=new ji(h,l.h))}function ve(l,h,m){l.i.set(h,m)}function ha(l){return ve(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function bi(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Si(l,h,m){return typeof l=="string"?(l=encodeURI(l).replace(h,s1),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function s1(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Vm=/[#\/\?@]/g,i1=/[#\?:]/g,o1=/[#\?]/g,a1=/[#\?@]/g,l1=/#/g;function ji(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Un(l){l.g||(l.g=new Map,l.h=0,l.i&&r1(l.i,function(h,m){l.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}t=ji.prototype,t.add=function(l,h){Un(this),this.i=null,l=ds(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(h),this.h+=1,this};function Mm(l,h){Un(l),h=ds(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Lm(l,h){return Un(l),h=ds(l,h),l.g.has(h)}t.forEach=function(l,h){Un(this),this.g.forEach(function(m,w){m.forEach(function(P){l.call(h,P,w,this)},this)},this)},t.na=function(){Un(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let w=0;w<h.length;w++){const P=l[w];for(let M=0;M<P.length;M++)m.push(h[w])}return m},t.V=function(l){Un(this);let h=[];if(typeof l=="string")Lm(this,l)&&(h=h.concat(this.g.get(ds(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)h=h.concat(l[m])}return h},t.set=function(l,h){return Un(this),this.i=null,l=ds(this,l),Lm(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Fm(l,h,m){Mm(l,h),0<m.length&&(l.i=null,l.g.set(ds(l,h),C(m)),l.h+=m.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var w=h[m];const M=encodeURIComponent(String(w)),H=this.V(w);for(w=0;w<H.length;w++){var P=M;H[w]!==""&&(P+="="+encodeURIComponent(String(H[w]))),l.push(P)}}return this.i=l.join("&")};function ds(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function c1(l,h){h&&!l.j&&(Un(l),l.i=null,l.g.forEach(function(m,w){var P=w.toLowerCase();w!=P&&(Mm(this,w),Fm(this,P,m))},l)),l.j=h}function u1(l,h){const m=new Ti;if(c.Image){const w=new Image;w.onload=j($n,m,"TestLoadImage: loaded",!0,h,w),w.onerror=j($n,m,"TestLoadImage: error",!1,h,w),w.onabort=j($n,m,"TestLoadImage: abort",!1,h,w),w.ontimeout=j($n,m,"TestLoadImage: timeout",!1,h,w),c.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=l}else h(!1)}function d1(l,h){const m=new Ti,w=new AbortController,P=setTimeout(()=>{w.abort(),$n(m,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:w.signal}).then(M=>{clearTimeout(P),M.ok?$n(m,"TestPingServer: ok",!0,h):$n(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(P),$n(m,"TestPingServer: error",!1,h)})}function $n(l,h,m,w,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),w(m)}catch{}}function h1(){this.g=new Kw}function f1(l,h,m){const w=m||"";try{Pm(l,function(P,M){let H=P;d(P)&&(H=Zc(P)),h.push(w+M+"="+encodeURIComponent(H))})}catch(P){throw h.push(w+"type="+encodeURIComponent("_badmap")),P}}function fa(l){this.l=l.Ub||null,this.j=l.eb||!1}k(fa,eu),fa.prototype.g=function(){return new ma(this.l,this.j)},fa.prototype.i=function(l){return function(){return l}}({});function ma(l,h){Ze.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(ma,Ze),t=ma.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,ki(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ai(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ki(this)),this.g&&(this.readyState=3,ki(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Um(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Um(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Ai(this):ki(this),this.readyState==3&&Um(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Ai(this))},t.Qa=function(l){this.g&&(this.response=l,Ai(this))},t.ga=function(){this.g&&Ai(this)};function Ai(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ki(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=h.next();return l.join(`\r
`)};function ki(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ma.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function $m(l){let h="";return O(l,function(m,w){h+=w,h+=":",h+=m,h+=`\r
`}),h}function uu(l,h,m){e:{for(w in m){var w=!1;break e}w=!0}w||(m=$m(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):ve(l,h,m))}function je(l){Ze.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(je,Ze);var m1=/^https?$/i,p1=["POST","PUT"];t=je.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,m,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ru.g(),this.v=this.o?gm(this.o):gm(ru),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(M){zm(this,M);return}if(l=m||"",m=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var P in w)m.set(P,w[P]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const M of w.keys())m.set(M,w.get(M));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(m.keys()).find(M=>M.toLowerCase()=="content-type"),P=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(p1,h,void 0))||w||P||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,H]of m)this.g.setRequestHeader(M,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Hm(this),this.u=!0,this.g.send(l),this.u=!1}catch(M){zm(this,M)}};function zm(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Bm(l),pa(l)}function Bm(l){l.A||(l.A=!0,ut(l,"complete"),ut(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,ut(this,"complete"),ut(this,"abort"),pa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pa(this,!0)),je.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?qm(this):this.bb())},t.bb=function(){qm(this)};function qm(l){if(l.h&&typeof o<"u"&&(!l.v[1]||vn(l)!=4||l.Z()!=2)){if(l.u&&vn(l)==4)hm(l.Ea,0,l);else if(ut(l,"readystatechange"),vn(l)==4){l.h=!1;try{const H=l.Z();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var w;if(w=H===0){var P=String(l.D).match(Dm)[1]||null;!P&&c.self&&c.self.location&&(P=c.self.location.protocol.slice(0,-1)),w=!m1.test(P?P.toLowerCase():"")}m=w}if(m)ut(l,"complete"),ut(l,"success");else{l.m=6;try{var M=2<vn(l)?l.g.statusText:""}catch{M=""}l.l=M+" ["+l.Z()+"]",Bm(l)}}finally{pa(l)}}}}function pa(l,h){if(l.g){Hm(l);const m=l.g,w=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||ut(l,"ready");try{m.onreadystatechange=w}catch{}}}function Hm(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function vn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<vn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),Gw(h)}};function Wm(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function g1(l){const h={};l=(l.g&&2<=vn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<l.length;w++){if(S(l[w]))continue;var m=b(l[w]);const P=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const M=h[P]||[];h[P]=M,M.push(m)}E(h,function(w){return w.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ci(l,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||h}function Gm(l){this.Aa=0,this.i=[],this.j=new Ti,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ci("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ci("baseRetryDelayMs",5e3,l),this.cb=Ci("retryDelaySeedMs",1e4,l),this.Wa=Ci("forwardChannelMaxRetries",2,l),this.wa=Ci("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new jm(l&&l.concurrentRequestLimit),this.Da=new h1,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Gm.prototype,t.la=8,t.G=1,t.connect=function(l,h,m,w){dt(0),this.W=l,this.H=h||{},m&&w!==void 0&&(this.H.OSID=m,this.H.OAID=w),this.F=this.X,this.I=np(this,null,this.W),ya(this)};function du(l){if(Km(l),l.G==3){var h=l.U++,m=yn(l.I);if(ve(m,"SID",l.K),ve(m,"RID",h),ve(m,"TYPE","terminate"),Ri(l,m),h=new Fn(l,l.j,h),h.L=2,h.v=ha(yn(m)),m=!1,c.navigator&&c.navigator.sendBeacon)try{m=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&c.Image&&(new Image().src=h.v,m=!0),m||(h.g=rp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ca(h)}tp(l)}function ga(l){l.g&&(fu(l),l.g.cancel(),l.g=null)}function Km(l){ga(l),l.u&&(c.clearTimeout(l.u),l.u=null),va(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function ya(l){if(!Am(l.h)&&!l.s){l.s=!0;var h=l.Ga;X||Q(),$||(X(),$=!0),q.add(h,l),l.B=0}}function y1(l,h){return km(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Ii(y(l.Ga,l,h),ep(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const P=new Fn(this,this.j,l);let M=this.o;if(this.S&&(M?(M=v(M),I(M,this.S)):M=this.S),this.m!==null||this.O||(P.H=M,M=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var w=this.i[m];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(h+=w,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=Ym(this,P,h),m=yn(this.I),ve(m,"RID",l),ve(m,"CVER",22),this.D&&ve(m,"X-HTTP-Session-Id",this.D),Ri(this,m),M&&(this.O?h="headers="+encodeURIComponent(String($m(M)))+"&"+h:this.m&&uu(m,this.m,M)),cu(this.h,P),this.Ua&&ve(m,"TYPE","init"),this.P?(ve(m,"$req",h),ve(m,"SID","null"),P.T=!0,iu(P,m,null)):iu(P,m,h),this.G=2}}else this.G==3&&(l?Qm(this,l):this.i.length==0||Am(this.h)||Qm(this))};function Qm(l,h){var m;h?m=h.l:m=l.U++;const w=yn(l.I);ve(w,"SID",l.K),ve(w,"RID",m),ve(w,"AID",l.T),Ri(l,w),l.m&&l.o&&uu(w,l.m,l.o),m=new Fn(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Ym(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),cu(l.h,m),iu(m,w,h)}function Ri(l,h){l.H&&O(l.H,function(m,w){ve(h,w,m)}),l.l&&Pm({},function(m,w){ve(h,w,m)})}function Ym(l,h,m){m=Math.min(l.i.length,m);var w=l.l?y(l.l.Na,l.l,l):null;e:{var P=l.i;let M=-1;for(;;){const H=["count="+m];M==-1?0<m?(M=P[0].g,H.push("ofs="+M)):M=0:H.push("ofs="+M);let pe=!0;for(let We=0;We<m;We++){let ue=P[We].g;const et=P[We].map;if(ue-=M,0>ue)M=Math.max(0,P[We].g-100),pe=!1;else try{f1(et,H,"req"+ue+"_")}catch{w&&w(et)}}if(pe){w=H.join("&");break e}}}return l=l.i.splice(0,m),h.D=l,w}function Xm(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;X||Q(),$||(X(),$=!0),q.add(h,l),l.v=0}}function hu(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Ii(y(l.Fa,l),ep(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Jm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Ii(y(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,dt(10),ga(this),Jm(this))};function fu(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Jm(l){l.g=new Fn(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=yn(l.qa);ve(h,"RID","rpc"),ve(h,"SID",l.K),ve(h,"AID",l.T),ve(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&ve(h,"TO",l.ja),ve(h,"TYPE","xmlhttp"),Ri(l,h),l.m&&l.o&&uu(h,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=ha(yn(h)),m.m=null,m.P=!0,Nm(m,l)}t.Za=function(){this.C!=null&&(this.C=null,ga(this),hu(this),dt(19))};function va(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function Zm(l,h){var m=null;if(l.g==h){va(l),fu(l),l.g=null;var w=2}else if(lu(l.h,h))m=h.D,Cm(l.h,h),w=1;else return;if(l.G!=0){if(h.o)if(w==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var P=l.B;w=oa(),ut(w,new wm(w,m)),ya(l)}else Xm(l);else if(P=h.s,P==3||P==0&&0<h.X||!(w==1&&y1(l,h)||w==2&&hu(l)))switch(m&&0<m.length&&(h=l.h,h.i=h.i.concat(m)),P){case 1:Vr(l,5);break;case 4:Vr(l,10);break;case 3:Vr(l,6);break;default:Vr(l,2)}}}function ep(l,h){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*h}function Vr(l,h){if(l.j.info("Error code "+h),h==2){var m=y(l.fb,l),w=l.Xa;const P=!w;w=new Or(w||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||ua(w,"https"),ha(w),P?u1(w.toString(),m):d1(w.toString(),m)}else dt(2);l.G=0,l.l&&l.l.sa(h),tp(l),Km(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),dt(2)):(this.j.info("Failed to ping google.com"),dt(1))};function tp(l){if(l.G=0,l.ka=[],l.l){const h=Rm(l.h);(h.length!=0||l.i.length!=0)&&(V(l.ka,h),V(l.ka,l.i),l.h.i.length=0,C(l.i),l.i.length=0),l.l.ra()}}function np(l,h,m){var w=m instanceof Or?yn(m):new Or(m);if(w.g!="")h&&(w.g=h+"."+w.g),da(w,w.s);else{var P=c.location;w=P.protocol,h=h?h+"."+P.hostname:P.hostname,P=+P.port;var M=new Or(null);w&&ua(M,w),h&&(M.g=h),P&&da(M,P),m&&(M.l=m),w=M}return m=l.D,h=l.ya,m&&h&&ve(w,m,h),ve(w,"VER",l.la),Ri(l,w),w}function rp(l,h,m){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new je(new fa({eb:m})):new je(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function sp(){}t=sp.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function xa(){}xa.prototype.g=function(l,h){return new Nt(l,h)};function Nt(l,h){Ze.call(this),this.g=new Gm(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!S(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!S(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new hs(this)}k(Nt,Ze),Nt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nt.prototype.close=function(){du(this.g)},Nt.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=Zc(l),l=m);h.i.push(new e1(h.Ya++,l)),h.G==3&&ya(h)},Nt.prototype.N=function(){this.g.l=null,delete this.j,du(this.g),delete this.g,Nt.aa.N.call(this)};function ip(l){tu.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const m in h){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}k(ip,tu);function op(){nu.call(this),this.status=1}k(op,nu);function hs(l){this.g=l}k(hs,sp),hs.prototype.ua=function(){ut(this.g,"a")},hs.prototype.ta=function(l){ut(this.g,new ip(l))},hs.prototype.sa=function(l){ut(this.g,new op)},hs.prototype.ra=function(){ut(this.g,"b")},xa.prototype.createWebChannel=xa.prototype.g,Nt.prototype.send=Nt.prototype.o,Nt.prototype.open=Nt.prototype.m,Nt.prototype.close=Nt.prototype.close,a_=function(){return new xa},o_=function(){return oa()},i_=Pr,th={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},aa.NO_ERROR=0,aa.TIMEOUT=8,aa.HTTP_ERROR=6,ul=aa,Em.COMPLETE="complete",s_=Em,ym.EventType=wi,wi.OPEN="a",wi.CLOSE="b",wi.ERROR="c",wi.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,Gi=ym,je.prototype.listenOnce=je.prototype.L,je.prototype.getLastError=je.prototype.Ka,je.prototype.getLastErrorCode=je.prototype.Ba,je.prototype.getStatus=je.prototype.Z,je.prototype.getResponseJson=je.prototype.Oa,je.prototype.getResponseText=je.prototype.oa,je.prototype.send=je.prototype.ea,je.prototype.setWithCredentials=je.prototype.Ha,r_=je}).apply(typeof Fa<"u"?Fa:typeof self<"u"?self:typeof window<"u"?window:{});const Gg="@firebase/firestore",Kg="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let it=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};it.UNAUTHENTICATED=new it(null),it.GOOGLE_CREDENTIALS=new it("google-credentials-uid"),it.FIRST_PARTY=new it("first-party-uid"),it.MOCK_USER=new it("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mi="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=new yf("@firebase/firestore");function xs(){return ts.logLevel}function W(t,...e){if(ts.logLevel<=oe.DEBUG){const n=e.map(Af);ts.debug(`Firestore (${mi}): ${t}`,...n)}}function Dn(t,...e){if(ts.logLevel<=oe.ERROR){const n=e.map(Af);ts.error(`Firestore (${mi}): ${t}`,...n)}}function xr(t,...e){if(ts.logLevel<=oe.WARN){const n=e.map(Af);ts.warn(`Firestore (${mi}): ${t}`,...n)}}function Af(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ee(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,l_(t,r,n)}function l_(t,e,n){let r=`FIRESTORE (${mi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Dn(r),new Error(r)}function he(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||l_(e,s,r)}function ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends Ln{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(it.UNAUTHENTICATED))}shutdown(){}}class BS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class qS{constructor(e){this.t=e,this.currentUser=it.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new mr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new mr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new mr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string",31837,{l:r}),new c_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string",2055,{h:e}),new it(e)}}class HS{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=it.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class WS{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new HS(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(it.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qg{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class GS{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ot(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){he(this.o===void 0,3512);const r=i=>{i.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,W("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Qg(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Qg(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=KS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function se(t,e){return t<e?-1:t>e?1:0}function nh(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return se(r,s);{const i=u_(),o=QS(i.encode(Yg(t,n)),i.encode(Yg(e,n)));return o!==0?o:se(r,s)}}n+=r>65535?2:1}return se(t.length,e.length)}function Yg(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function QS(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return se(t[n],e[n]);return se(t.length,e.length)}function ri(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="__name__";class sn{constructor(e,n,r){n===void 0?n=0:n>e.length&&ee(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ee(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return sn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof sn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=sn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return se(e.length,n.length)}static compareSegments(e,n){const r=sn.isNumericId(e),s=sn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?sn.extractNumericId(e).compare(sn.extractNumericId(n)):nh(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return fr.fromString(e.substring(4,e.length-2))}}class ge extends sn{construct(e,n,r){return new ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ge(n)}static emptyPath(){return new ge([])}}const YS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qe extends sn{construct(e,n,r){return new Qe(e,n,r)}static isValidIdentifier(e){return YS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Xg}static keyField(){return new Qe([Xg])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new G(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new G(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new G(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qe(n)}static emptyPath(){return new Qe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.path=e}static fromPath(e){return new J(ge.fromString(e))}static fromName(e){return new J(ge.fromString(e).popFirst(5))}static empty(){return new J(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new J(new ge(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(t,e,n){if(!n)throw new G(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function XS(t,e,n,r){if(e===!0&&r===!0)throw new G(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Jg(t){if(!J.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Zg(t){if(J.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function h_(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Sc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ee(12329,{type:typeof t})}function On(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sc(t);throw new G(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t,e){const n={typeString:t};return e&&(n.value=e),n}function Qo(t,e){if(!h_(t))throw new G(F.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new G(F.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey=-62135596800,ty=1e6;class _e{static now(){return _e.fromMillis(Date.now())}static fromDate(e){return _e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*ty);return new _e(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<ey)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ty}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Qo(e,_e._jsonSchema))return new _e(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ey;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_e._jsonSchemaVersion="firestore/timestamp/1.0",_e._jsonSchema={type:Me("string",_e._jsonSchemaVersion),seconds:Me("number"),nanoseconds:Me("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{static fromTimestamp(e){return new te(e)}static min(){return new te(new _e(0,0))}static max(){return new te(new _e(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=-1;function JS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=te.fromTimestamp(r===1e9?new _e(n+1,0):new _e(n,r));return new _r(s,J.empty(),e)}function ZS(t){return new _r(t.readTime,t.key,Ro)}class _r{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new _r(te.min(),J.empty(),Ro)}static max(){return new _r(te.max(),J.empty(),Ro)}}function ej(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=J.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pi(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==tj)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ee(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{o[d]=f,++c,c===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function rj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function gi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}jc.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf=-1;function Ac(t){return t==null}function Ql(t){return t===0&&1/t==-1/0}function sj(t){return typeof t=="number"&&Number.isInteger(t)&&!Ql(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_="";function ij(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ny(e)),e=oj(t.get(n),e);return ny(e)}function oj(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case f_:n+="";break;default:n+=i}}return n}function ny(t){return t+f_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Cr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function m_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e,n){this.comparator=e,this.root=n||Ke.EMPTY}insert(e,n){return new Se(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ke.BLACK,null,null))}remove(e){return new Se(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ke.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ua(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ua(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ua(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ua(this.root,e,this.comparator,!0)}}class Ua{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ke{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ke.RED,this.left=s??Ke.EMPTY,this.right=i??Ke.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ke(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ke.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ke.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ke.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ke.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ee(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ee(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ee(27949);return e+(this.isRed()?0:1)}}Ke.EMPTY=null,Ke.RED=!0,Ke.BLACK=!1;Ke.EMPTY=new class{constructor(){this.size=0}get key(){throw ee(57766)}get value(){throw ee(16141)}get color(){throw ee(16727)}get left(){throw ee(29726)}get right(){throw ee(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ke(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.comparator=e,this.data=new Se(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new sy(this.data.getIterator())}getIteratorFrom(e){return new sy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof $e)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new $e(this.comparator);return n.data=e,n}}class sy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.fields=e,e.sort(Qe.comparator)}static empty(){return new jt([])}unionWith(e){let n=new $e(Qe.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new jt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ri(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new p_("Invalid base64 string: "+i):i}}(e);return new Je(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Je(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Je.EMPTY_BYTE_STRING=new Je("");const aj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wr(t){if(he(!!t,39018),typeof t=="string"){let e=0;const n=aj.exec(t);if(he(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Re(t.seconds),nanos:Re(t.nanos)}}function Re(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Er(t){return typeof t=="string"?Je.fromBase64String(t):Je.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="server_timestamp",y_="__type__",v_="__previous_value__",x_="__local_write_time__";function Rf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[y_])===null||n===void 0?void 0:n.stringValue)===g_}function kc(t){const e=t.mapValue.fields[v_];return Rf(e)?kc(e):e}function Po(t){const e=wr(t.mapValue.fields[x_].timestampValue);return new _e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e,n,r,s,i,o,c,u,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const Yl="(default)";class Do{constructor(e,n){this.projectId=e,this.database=n||Yl}static empty(){return new Do("","")}get isDefaultDatabase(){return this.database===Yl}isEqual(e){return e instanceof Do&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __="__type__",w_="__max__",$a={mapValue:{fields:{__type__:{stringValue:w_}}}},E_="__vector__",Xl="value";function Ir(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rf(t)?4:uj(t)?9007199254740991:cj(t)?10:11:ee(28295,{value:t})}function pn(t,e){if(t===e)return!0;const n=Ir(t);if(n!==Ir(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Po(t).isEqual(Po(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=wr(s.timestampValue),c=wr(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Er(s.bytesValue).isEqual(Er(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Re(s.geoPointValue.latitude)===Re(i.geoPointValue.latitude)&&Re(s.geoPointValue.longitude)===Re(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Re(s.integerValue)===Re(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Re(s.doubleValue),c=Re(i.doubleValue);return o===c?Ql(o)===Ql(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return ri(t.arrayValue.values||[],e.arrayValue.values||[],pn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(ry(o)!==ry(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!pn(o[u],c[u])))return!1;return!0}(t,e);default:return ee(52216,{left:t})}}function Oo(t,e){return(t.values||[]).find(n=>pn(n,e))!==void 0}function si(t,e){if(t===e)return 0;const n=Ir(t),r=Ir(e);if(n!==r)return se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=Re(i.integerValue||i.doubleValue),u=Re(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return iy(t.timestampValue,e.timestampValue);case 4:return iy(Po(t),Po(e));case 5:return nh(t.stringValue,e.stringValue);case 6:return function(i,o){const c=Er(i),u=Er(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=se(c[d],u[d]);if(f!==0)return f}return se(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=se(Re(i.latitude),Re(o.latitude));return c!==0?c:se(Re(i.longitude),Re(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return oy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var c,u,d,f;const g=i.fields||{},y=o.fields||{},j=(c=g[Xl])===null||c===void 0?void 0:c.arrayValue,k=(u=y[Xl])===null||u===void 0?void 0:u.arrayValue,C=se(((d=j==null?void 0:j.values)===null||d===void 0?void 0:d.length)||0,((f=k==null?void 0:k.values)===null||f===void 0?void 0:f.length)||0);return C!==0?C:oy(j,k)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===$a.mapValue&&o===$a.mapValue)return 0;if(i===$a.mapValue)return 1;if(o===$a.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let g=0;g<u.length&&g<f.length;++g){const y=nh(u[g],f[g]);if(y!==0)return y;const j=si(c[u[g]],d[f[g]]);if(j!==0)return j}return se(u.length,f.length)}(t.mapValue,e.mapValue);default:throw ee(23264,{le:n})}}function iy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);const n=wr(t),r=wr(e),s=se(n.seconds,r.seconds);return s!==0?s:se(n.nanos,r.nanos)}function oy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=si(n[s],r[s]);if(i)return i}return se(n.length,r.length)}function ii(t){return rh(t)}function rh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=wr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Er(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return J.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=rh(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${rh(n.fields[o])}`;return s+"}"}(t.mapValue):ee(61005,{value:t})}function dl(t){switch(Ir(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=kc(t);return e?16+dl(e):16;case 5:return 2*t.stringValue.length;case 6:return Er(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+dl(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Cr(r.fields,(i,o)=>{s+=i.length+dl(o)}),s}(t.mapValue);default:throw ee(13486,{value:t})}}function ay(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function sh(t){return!!t&&"integerValue"in t}function Pf(t){return!!t&&"arrayValue"in t}function ly(t){return!!t&&"nullValue"in t}function cy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function hl(t){return!!t&&"mapValue"in t}function cj(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[__])===null||n===void 0?void 0:n.stringValue)===E_}function ao(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Cr(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ao(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ao(t.arrayValue.values[n]);return e}return Object.assign({},t)}function uj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===w_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.value=e}static empty(){return new _t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!hl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ao(n)}setAll(e){let n=Qe.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=ao(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());hl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return pn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];hl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Cr(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new _t(ao(this.value))}}function I_(t){const e=[];return Cr(t.fields,(n,r)=>{const s=new Qe([n]);if(hl(r)){const i=I_(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new jt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new at(e,0,te.min(),te.min(),te.min(),_t.empty(),0)}static newFoundDocument(e,n,r,s){return new at(e,1,n,te.min(),r,s,0)}static newNoDocument(e,n){return new at(e,2,n,te.min(),te.min(),_t.empty(),0)}static newUnknownDocument(e,n){return new at(e,3,n,te.min(),te.min(),_t.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_t.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_t.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof at&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new at(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,n){this.position=e,this.inclusive=n}}function uy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=J.comparator(J.fromName(o.referenceValue),n.key):r=si(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function dy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!pn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n="asc"){this.field=e,this.dir=n}}function dj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{}class Ve extends T_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new fj(e,n,r):n==="array-contains"?new gj(e,r):n==="in"?new yj(e,r):n==="not-in"?new vj(e,r):n==="array-contains-any"?new xj(e,r):new Ve(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new mj(e,r):new pj(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(si(n,this.value)):n!==null&&Ir(this.value)===Ir(n)&&this.matchesComparison(si(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class en extends T_{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new en(e,n)}matches(e){return N_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function N_(t){return t.op==="and"}function b_(t){return hj(t)&&N_(t)}function hj(t){for(const e of t.filters)if(e instanceof en)return!1;return!0}function ih(t){if(t instanceof Ve)return t.field.canonicalString()+t.op.toString()+ii(t.value);if(b_(t))return t.filters.map(e=>ih(e)).join(",");{const e=t.filters.map(n=>ih(n)).join(",");return`${t.op}(${e})`}}function S_(t,e){return t instanceof Ve?function(r,s){return s instanceof Ve&&r.op===s.op&&r.field.isEqual(s.field)&&pn(r.value,s.value)}(t,e):t instanceof en?function(r,s){return s instanceof en&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&S_(o,s.filters[c]),!0):!1}(t,e):void ee(19439)}function j_(t){return t instanceof Ve?function(n){return`${n.field.canonicalString()} ${n.op} ${ii(n.value)}`}(t):t instanceof en?function(n){return n.op.toString()+" {"+n.getFilters().map(j_).join(" ,")+"}"}(t):"Filter"}class fj extends Ve{constructor(e,n,r){super(e,n,r),this.key=J.fromName(r.referenceValue)}matches(e){const n=J.comparator(e.key,this.key);return this.matchesComparison(n)}}class mj extends Ve{constructor(e,n){super(e,"in",n),this.keys=A_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class pj extends Ve{constructor(e,n){super(e,"not-in",n),this.keys=A_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function A_(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>J.fromName(r.referenceValue))}class gj extends Ve{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Pf(n)&&Oo(n.arrayValue,this.value)}}class yj extends Ve{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Oo(this.value.arrayValue,n)}}class vj extends Ve{constructor(e,n){super(e,"not-in",n)}matches(e){if(Oo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Oo(this.value.arrayValue,n)}}class xj extends Ve{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Pf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Oo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Pe=null}}function hy(t,e=null,n=[],r=[],s=null,i=null,o=null){return new _j(t,e,n,r,s,i,o)}function Df(t){const e=ne(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ih(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ac(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ii(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ii(r)).join(",")),e.Pe=n}return e.Pe}function Of(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!dj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!S_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dy(t.startAt,e.startAt)&&dy(t.endAt,e.endAt)}function oh(t){return J.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function wj(t,e,n,r,s,i,o,c){return new Yo(t,e,n,r,s,i,o,c)}function k_(t){return new Yo(t)}function fy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function C_(t){return t.collectionGroup!==null}function lo(t){const e=ne(t);if(e.Te===null){e.Te=[];const n=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new $e(Qe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Te.push(new Zl(i,r))}),n.has(Qe.keyField().canonicalString())||e.Te.push(new Zl(Qe.keyField(),r))}return e.Te}function dn(t){const e=ne(t);return e.Ie||(e.Ie=Ej(e,lo(t))),e.Ie}function Ej(t,e){if(t.limitType==="F")return hy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Zl(s.field,i)});const n=t.endAt?new Jl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Jl(t.startAt.position,t.startAt.inclusive):null;return hy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ah(t,e){const n=t.filters.concat([e]);return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function lh(t,e,n){return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Cc(t,e){return Of(dn(t),dn(e))&&t.limitType===e.limitType}function R_(t){return`${Df(dn(t))}|lt:${t.limitType}`}function _s(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>j_(s)).join(", ")}]`),Ac(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ii(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ii(s)).join(",")),`Target(${r})`}(dn(t))}; limitType=${t.limitType})`}function Rc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):J.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of lo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const d=uy(o,c,u);return o.inclusive?d<=0:d<0}(r.startAt,lo(r),s)||r.endAt&&!function(o,c,u){const d=uy(o,c,u);return o.inclusive?d>=0:d>0}(r.endAt,lo(r),s))}(t,e)}function Ij(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function P_(t){return(e,n)=>{let r=!1;for(const s of lo(t)){const i=Tj(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Tj(t,e,n){const r=t.field.isKeyField()?J.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),d=c.data.field(i);return u!==null&&d!==null?si(u,d):ee(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ee(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Cr(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return m_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=new Se(J.comparator);function Vn(){return Nj}const D_=new Se(J.comparator);function Ki(...t){let e=D_;for(const n of t)e=e.insert(n.key,n);return e}function O_(t){let e=D_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Br(){return co()}function V_(){return co()}function co(){return new ls(t=>t.toString(),(t,e)=>t.isEqual(e))}const bj=new Se(J.comparator),Sj=new $e(J.comparator);function ae(...t){let e=Sj;for(const n of t)e=e.add(n);return e}const jj=new $e(se);function Aj(){return jj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ql(e)?"-0":e}}function M_(t){return{integerValue:""+t}}function kj(t,e){return sj(e)?M_(e):Vf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(){this._=void 0}}function Cj(t,e,n){return t instanceof ec?function(s,i){const o={fields:{[y_]:{stringValue:g_},[x_]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Rf(i)&&(i=kc(i)),i&&(o.fields[v_]=i),{mapValue:o}}(n,e):t instanceof Vo?F_(t,e):t instanceof Mo?U_(t,e):function(s,i){const o=L_(s,i),c=my(o)+my(s.Ee);return sh(o)&&sh(s.Ee)?M_(c):Vf(s.serializer,c)}(t,e)}function Rj(t,e,n){return t instanceof Vo?F_(t,e):t instanceof Mo?U_(t,e):n}function L_(t,e){return t instanceof tc?function(r){return sh(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ec extends Pc{}class Vo extends Pc{constructor(e){super(),this.elements=e}}function F_(t,e){const n=$_(e);for(const r of t.elements)n.some(s=>pn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Mo extends Pc{constructor(e){super(),this.elements=e}}function U_(t,e){let n=$_(e);for(const r of t.elements)n=n.filter(s=>!pn(s,r));return{arrayValue:{values:n}}}class tc extends Pc{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function my(t){return Re(t.integerValue||t.doubleValue)}function $_(t){return Pf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Pj(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Vo&&s instanceof Vo||r instanceof Mo&&s instanceof Mo?ri(r.elements,s.elements,pn):r instanceof tc&&s instanceof tc?pn(r.Ee,s.Ee):r instanceof ec&&s instanceof ec}(t.transform,e.transform)}class Dj{constructor(e,n){this.version=e,this.transformResults=n}}class Ft{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ft}static exists(e){return new Ft(void 0,e)}static updateTime(e){return new Ft(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Dc{}function z_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Mf(t.key,Ft.none()):new Xo(t.key,t.data,Ft.none());{const n=t.data,r=_t.empty();let s=new $e(Qe.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Rr(t.key,r,new jt(s.toArray()),Ft.none())}}function Oj(t,e,n){t instanceof Xo?function(s,i,o){const c=s.value.clone(),u=gy(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Rr?function(s,i,o){if(!fl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=gy(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(B_(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function uo(t,e,n,r){return t instanceof Xo?function(i,o,c,u){if(!fl(i.precondition,o))return c;const d=i.value.clone(),f=yy(i.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Rr?function(i,o,c,u){if(!fl(i.precondition,o))return c;const d=yy(i.fieldTransforms,u,o),f=o.data;return f.setAll(B_(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,o,c){return fl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function Vj(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=L_(r.transform,s||null);i!=null&&(n===null&&(n=_t.empty()),n.set(r.field,i))}return n||null}function py(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ri(r,s,(i,o)=>Pj(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xo extends Dc{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Rr extends Dc{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function B_(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function gy(t,e,n){const r=new Map;he(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,Rj(o,c,n[s]))}return r}function yy(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Cj(i,o,e))}return r}class Mf extends Dc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Mj extends Dc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Oj(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=uo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=uo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=V_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=z_(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ae())}isEqual(e){return this.batchId===e.batchId&&ri(this.mutations,e.mutations,(n,r)=>py(n,r))&&ri(this.baseMutations,e.baseMutations,(n,r)=>py(n,r))}}class Lf{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){he(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=function(){return bj}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Lf(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De,le;function $j(t){switch(t){case F.OK:return ee(64938);case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return ee(15467,{code:t})}}function q_(t){if(t===void 0)return Dn("GRPC error has no .code"),F.UNKNOWN;switch(t){case De.OK:return F.OK;case De.CANCELLED:return F.CANCELLED;case De.UNKNOWN:return F.UNKNOWN;case De.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case De.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case De.INTERNAL:return F.INTERNAL;case De.UNAVAILABLE:return F.UNAVAILABLE;case De.UNAUTHENTICATED:return F.UNAUTHENTICATED;case De.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case De.NOT_FOUND:return F.NOT_FOUND;case De.ALREADY_EXISTS:return F.ALREADY_EXISTS;case De.PERMISSION_DENIED:return F.PERMISSION_DENIED;case De.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case De.ABORTED:return F.ABORTED;case De.OUT_OF_RANGE:return F.OUT_OF_RANGE;case De.UNIMPLEMENTED:return F.UNIMPLEMENTED;case De.DATA_LOSS:return F.DATA_LOSS;default:return ee(39323,{code:t})}}(le=De||(De={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=new fr([4294967295,4294967295],0);function vy(t){const e=u_().encode(t),n=new n_;return n.update(e),new Uint8Array(n.digest())}function xy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new fr([n,r],0),new fr([s,i],0)]}class Ff{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Qi(`Invalid padding: ${n}`);if(r<0)throw new Qi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Qi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Qi(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=fr.fromNumber(this.fe)}pe(e,n,r){let s=e.add(n.multiply(fr.fromNumber(r)));return s.compare(zj)===1&&(s=new fr([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=vy(e),[r,s]=xy(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);if(!this.ye(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Ff(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.fe===0)return;const n=vy(e),[r,s]=xy(n);for(let i=0;i<this.hashCount;i++){const o=this.pe(r,s,i);this.we(o)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Qi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Jo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Oc(te.min(),s,new Se(se),Vn(),ae())}}class Jo{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Jo(r,n,ae(),ae(),ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=s}}class H_{constructor(e,n){this.targetId=e,this.De=n}}class W_{constructor(e,n,r=Je.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class _y{constructor(){this.ve=0,this.Ce=wy(),this.Fe=Je.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ae(),n=ae(),r=ae();return this.Ce.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ee(38017,{changeType:i})}}),new Jo(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=wy()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,he(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class Bj{constructor(e){this.We=e,this.Ge=new Map,this.ze=Vn(),this.je=za(),this.Je=za(),this.He=new Se(se)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:ee(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,s)=>{this.nt(s)&&n(s)})}it(e){const n=e.targetId,r=e.De.count,s=this.st(n);if(s){const i=s.target;if(oh(i))if(r===0){const o=new J(i.path);this.Xe(n,o,at.newNoDocument(o,te.min()))}else he(r===1,20013,{expectedCount:r});else{const o=this.ot(n);if(o!==r){const c=this._t(e),u=c?this.ut(c,e,o):1;if(u!==0){this.rt(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,d)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=Er(r).toUint8Array()}catch(u){if(u instanceof p_)return xr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Ff(o,s,i)}catch(u){return xr(u instanceof Qi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.fe===0?null:c}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.We.lt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Xe(n,i,null),s++)}),s}Pt(e){const n=new Map;this.Ge.forEach((i,o)=>{const c=this.st(o);if(c){if(i.current&&oh(c.target)){const u=new J(c.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,at.newNoDocument(u,e))}i.Ne&&(n.set(o,i.Le()),i.ke())}});let r=ae();this.Je.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.st(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.ze.forEach((i,o)=>o.setReadTime(e));const s=new Oc(e,n,this.He,this.ze,r);return this.ze=Vn(),this.je=za(),this.Je=za(),this.He=new Se(se),s}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,n)?s.qe(n,1):s.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new _y,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new $e(se),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new $e(se),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new _y),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function za(){return new Se(J.comparator)}function wy(){return new Se(J.comparator)}const qj={asc:"ASCENDING",desc:"DESCENDING"},Hj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Wj={and:"AND",or:"OR"};class Gj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ch(t,e){return t.useProto3Json||Ac(e)?e:{value:e}}function nc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function G_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Kj(t,e){return nc(t,e.toTimestamp())}function hn(t){return he(!!t,49232),te.fromTimestamp(function(n){const r=wr(n);return new _e(r.seconds,r.nanos)}(t))}function Uf(t,e){return uh(t,e).canonicalString()}function uh(t,e){const n=function(s){return new ge(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function K_(t){const e=ge.fromString(t);return he(Z_(e),10190,{key:e.toString()}),e}function dh(t,e){return Uf(t.databaseId,e.path)}function Ku(t,e){const n=K_(e);if(n.get(1)!==t.databaseId.projectId)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new J(Y_(n))}function Q_(t,e){return Uf(t.databaseId,e)}function Qj(t){const e=K_(t);return e.length===4?ge.emptyPath():Y_(e)}function hh(t){return new ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Y_(t){return he(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Ey(t,e,n){return{name:dh(t,e),fields:n.value.mapValue.fields}}function Yj(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ee(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(he(f===void 0||typeof f=="string",58123),Je.fromBase64String(f||"")):(he(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Je.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const f=d.code===void 0?F.UNKNOWN:q_(d.code);return new G(f,d.message||"")}(o);n=new W_(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ku(t,r.document.name),i=hn(r.document.updateTime),o=r.document.createTime?hn(r.document.createTime):te.min(),c=new _t({mapValue:{fields:r.document.fields}}),u=at.newFoundDocument(s,i,o,c),d=r.targetIds||[],f=r.removedTargetIds||[];n=new ml(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ku(t,r.document),i=r.readTime?hn(r.readTime):te.min(),o=at.newNoDocument(s,i),c=r.removedTargetIds||[];n=new ml([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ku(t,r.document),i=r.removedTargetIds||[];n=new ml([],i,s,null)}else{if(!("filter"in e))return ee(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new Uj(s,i),c=r.targetId;n=new H_(c,o)}}return n}function Xj(t,e){let n;if(e instanceof Xo)n={update:Ey(t,e.key,e.value)};else if(e instanceof Mf)n={delete:dh(t,e.key)};else if(e instanceof Rr)n={update:Ey(t,e.key,e.data),updateMask:o2(e.fieldMask)};else{if(!(e instanceof Mj))return ee(16599,{Rt:e.type});n={verify:dh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof ec)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Vo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Mo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof tc)return{fieldPath:o.field.canonicalString(),increment:c.Ee};throw ee(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Kj(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ee(27497)}(t,e.precondition)),n}function Jj(t,e){return t&&t.length>0?(he(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?hn(s.updateTime):hn(i);return o.isEqual(te.min())&&(o=hn(i)),new Dj(o,s.transformResults||[])}(n,e))):[]}function Zj(t,e){return{documents:[Q_(t,e.path)]}}function e2(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Q_(t,s);const i=function(d){if(d.length!==0)return J_(en.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(y){return{field:ws(y.field),direction:r2(y.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=ch(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:n,parent:s}}function t2(t){let e=Qj(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){he(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(g){const y=X_(g);return y instanceof en&&b_(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(g){return g.map(y=>function(k){return new Zl(Es(k.field),function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(y))}(n.orderBy));let c=null;n.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,Ac(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,j=g.values||[];return new Jl(j,y)}(n.startAt));let d=null;return n.endAt&&(d=function(g){const y=!g.before,j=g.values||[];return new Jl(j,y)}(n.endAt)),wj(e,s,o,i,c,"F",u,d)}function n2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ee(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function X_(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Es(n.unaryFilter.field);return Ve.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Es(n.unaryFilter.field);return Ve.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Es(n.unaryFilter.field);return Ve.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Es(n.unaryFilter.field);return Ve.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ee(61313);default:return ee(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ve.create(Es(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ee(58110);default:return ee(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return en.create(n.compositeFilter.filters.map(r=>X_(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ee(1026)}}(n.compositeFilter.op))}(t):ee(30097,{filter:t})}function r2(t){return qj[t]}function s2(t){return Hj[t]}function i2(t){return Wj[t]}function ws(t){return{fieldPath:t.canonicalString()}}function Es(t){return Qe.fromServerFormat(t.fieldPath)}function J_(t){return t instanceof Ve?function(n){if(n.op==="=="){if(cy(n.value))return{unaryFilter:{field:ws(n.field),op:"IS_NAN"}};if(ly(n.value))return{unaryFilter:{field:ws(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(cy(n.value))return{unaryFilter:{field:ws(n.field),op:"IS_NOT_NAN"}};if(ly(n.value))return{unaryFilter:{field:ws(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ws(n.field),op:s2(n.op),value:n.value}}}(t):t instanceof en?function(n){const r=n.getFilters().map(s=>J_(s));return r.length===1?r[0]:{compositeFilter:{op:i2(n.op),filters:r}}}(t):ee(54877,{filter:t})}function o2(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Z_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n,r,s,i=te.min(),o=te.min(),c=Je.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new tr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new tr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e){this.gt=e}}function l2(t){const e=t2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?lh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(){this.Dn=new u2}addToCollectionParentIndex(e,n){return this.Dn.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(_r.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(_r.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class u2{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new $e(ge.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new $e(ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ew=41943040;class vt{static withCacheSize(e){return new vt(e,vt.DEFAULT_COLLECTION_PERCENTILE,vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vt.DEFAULT_COLLECTION_PERCENTILE=10,vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vt.DEFAULT=new vt(ew,vt.DEFAULT_COLLECTION_PERCENTILE,vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vt.DISABLED=new vt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new oi(0)}static ur(){return new oi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ty="LruGarbageCollector",d2=1048576;function Ny([t,e],[n,r]){const s=se(t,n);return s===0?se(e,r):s}class h2{constructor(e){this.Tr=e,this.buffer=new $e(Ny),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ny(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class f2{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){W(Ty,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){gi(n)?W(Ty,"Ignoring IndexedDB error during garbage collection: ",n):await pi(n)}await this.Rr(3e5)})}}class m2{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return U.resolve(jc.ue);const r=new h2(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.gr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(Iy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Iy):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,s,i,o,c,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),s=this.params.maximumSequenceNumbersToCollect):s=g,o=Date.now(),this.nthSequenceNumber(e,s))).next(g=>(r=g,c=Date.now(),this.removeTargets(e,r,n))).next(g=>(i=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(d=Date.now(),xs()<=oe.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:g})))}}function p2(t,e){return new m2(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(){this.changes=new ls(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,at.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&uo(r.mutation,s,jt.empty(),_e.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ae()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ae()){const s=Br();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Ki();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Br();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ae()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=Vn();const o=co(),c=function(){return co()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Rr)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),uo(f.mutation,d,f.mutation.getFieldMask(),_e.now())):o.set(d.key,jt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>{var g;return c.set(d,new y2(f,(g=o.get(d))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,n){const r=co();let s=new Se((o,c)=>o-c),i=ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||jt.empty();f=c.applyToLocalView(d,f),r.set(u,f);const g=(s.get(c.batchId)||ae()).add(u);s=s.insert(c.batchId,g)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,g=V_();f.forEach(y=>{if(!i.has(y)){const j=z_(n.get(y),r.get(y));j!==null&&g.set(y,j),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return J.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):C_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(Br());let c=Ro,u=i;return o.next(d=>U.forEach(d,(f,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),i.get(f)?U.resolve():this.remoteDocumentCache.getEntry(e,f).next(y=>{u=u.insert(f,y)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,ae())).next(f=>({batchId:c,changes:O_(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new J(n)).next(r=>{let s=Ki();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Ki();return this.indexManager.getCollectionParents(e,i).next(c=>U.forEach(c,u=>{const d=function(g,y){return new Yo(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((g,y)=>{o=o.insert(g,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,at.newInvalidDocument(f)))});let c=Ki();return o.forEach((u,d)=>{const f=i.get(u);f!==void 0&&uo(f.mutation,d,jt.empty(),_e.now()),Rc(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return U.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(s){return{id:s.id,version:s.version,createTime:hn(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(s){return{name:s.name,query:l2(s.bundledQuery),readTime:hn(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(){this.overlays=new Se(J.comparator),this.kr=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Br();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.wt(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.kr.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=Br(),i=n.length+1,o=new J(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Se((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=Br(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=Br(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return U.resolve(c)}wt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fj(n,r));let i=this.kr.get(n);i===void 0&&(i=ae(),this.kr.set(n,i)),this.kr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(){this.sessionToken=Je.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(){this.qr=new $e(ze.Qr),this.$r=new $e(ze.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new ze(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new ze(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new J(new ge([])),r=new ze(n,e),s=new ze(n,e+1),i=[];return this.$r.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new J(new ge([])),r=new ze(n,e),s=new ze(n,e+1);let i=ae();return this.$r.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new ze(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ze{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return J.comparator(e.key,n.key)||se(e.Hr,n.Hr)}static Ur(e,n){return se(e.Hr,n.Hr)||J.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new $e(ze.Qr)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Lj(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.Yr=this.Yr.add(new ze(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Cf:this.er-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ze(n,0),s=new ze(n,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([r,s],o=>{const c=this.Zr(o.Hr);i.push(c)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $e(se);return n.forEach(s=>{const i=new ze(s,0),o=new ze(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([i,o],c=>{r=r.add(c.Hr)})}),U.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;J.isDocumentKey(i)||(i=i.child(""));const o=new ze(new J(i),0);let c=new $e(se);return this.Yr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Hr)),!0)},o),U.resolve(this.ei(c))}ei(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){he(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return U.forEach(n.mutations,s=>{const i=new ze(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new ze(n,0),s=this.Yr.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e){this.ni=e,this.docs=function(){return new Se(J.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():at.newInvalidDocument(n))}getEntries(e,n){let r=Vn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():at.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Vn();const o=n.path,c=new J(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||ej(ZS(f),r)<=0||(s.has(f.key)||Rc(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ee(9500)}ri(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new T2(this)}getSize(e){return U.resolve(this.size)}}class T2 extends g2{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e){this.persistence=e,this.ii=new ls(n=>Df(n),Of),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.si=0,this.oi=new $f,this.targetCount=0,this._i=oi.ar()}forEachTarget(e,n){return this.ii.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),U.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new oi(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.hr(n),U.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ii.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.ii.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,n){this.ai={},this.overlays={},this.ui=new jc(0),this.ci=!1,this.ci=!0,this.li=new w2,this.referenceDelegate=e(this),this.hi=new N2(this),this.indexManager=new c2,this.remoteDocumentCache=function(s){return new I2(s)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new a2(n),this.Ti=new x2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new _2,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new E2(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){W("MemoryPersistence","Starting transaction:",e);const s=new b2(this.ui.next());return this.referenceDelegate.Ii(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return U.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class b2 extends nj{constructor(e){super(),this.currentSequenceNumber=e}}class zf{constructor(e){this.persistence=e,this.Ai=new $f,this.Ri=null}static Vi(e){return new zf(e)}get mi(){if(this.Ri)return this.Ri;throw ee(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),U.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(s=>this.mi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.mi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.mi,r=>{const s=J.fromPath(r);return this.fi(e,s).next(i=>{i||n.removeEntry(s,te.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return U.or([()=>U.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class rc{constructor(e,n){this.persistence=e,this.gi=new ls(r=>ij(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=p2(this,n)}static Vi(e,n){return new rc(e,n)}Ii(){}di(e){return U.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return U.forEach(this.gi,(r,s)=>this.Sr(e,r,s).next(i=>i?U.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ri(e,o=>this.Sr(e,o,n).next(c=>{c||(r++,i.removeEntry(o,te.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),U.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),U.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=dl(e.data.value)),n}Sr(e,n,r){return U.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.gi.get(n);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=s}static Es(e,n){let r=ae(),s=ae();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Bf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return cT()?8:rj(ct())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ps(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ys(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new S2;return this.ws(e,n,o).next(c=>{if(i.result=c,this.Rs)return this.Ss(e,n,o,c.size)})}).next(()=>i.result)}Ss(e,n,r,s){return r.documentReadCount<this.Vs?(xs()<=oe.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",_s(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),U.resolve()):(xs()<=oe.DEBUG&&W("QueryEngine","Query:",_s(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(xs()<=oe.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",_s(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dn(n))):U.resolve())}ps(e,n){if(fy(n))return U.resolve(null);let r=dn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=lh(n,null,"F"),r=dn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ae(...i);return this.gs.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.bs(n,c);return this.Ds(n,d,o,u.readTime)?this.ps(e,lh(n,null,"F")):this.vs(e,d,n,u)}))})))}ys(e,n,r,s){return fy(n)||s.isEqual(te.min())?U.resolve(null):this.gs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ds(n,o,r,s)?U.resolve(null):(xs()<=oe.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),_s(n)),this.vs(e,o,n,JS(s,Ro)).next(c=>c))})}bs(e,n){let r=new $e(P_(e));return n.forEach((s,i)=>{Rc(e,i)&&(r=r.add(i))}),r}Ds(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ws(e,n,r){return xs()<=oe.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",_s(n)),this.gs.getDocumentsMatchingQuery(e,n,_r.min(),r)}vs(e,n,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf="LocalStore",A2=3e8;class k2{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.Fs=new Se(se),this.Ms=new ls(i=>Df(i),Of),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new v2(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function C2(t,e,n,r){return new k2(t,e,n,r)}async function nw(t,e){const n=ne(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=ae();for(const d of s){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Bs:d,removedBatchIds:o,addedBatchIds:c}))})})}function R2(t,e){const n=ne(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const g=d.batch,y=g.keys();let j=U.resolve();return y.forEach(k=>{j=j.next(()=>f.getEntry(u,k)).next(C=>{const V=d.docVersions.get(k);he(V!==null,48541),C.version.compareTo(V)<0&&(g.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),f.addEntry(C)))})}),j.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=ae();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function rw(t){const e=ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function P2(t,e){const n=ne(t),r=e.snapshotVersion;let s=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});s=n.Fs;const c=[];e.targetChanges.forEach((f,g)=>{const y=s.get(g);if(!y)return;c.push(n.hi.removeMatchingKeys(i,f.removedDocuments,g).next(()=>n.hi.addMatchingKeys(i,f.addedDocuments,g)));let j=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?j=j.withResumeToken(Je.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):f.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(f.resumeToken,r)),s=s.insert(g,j),function(C,V,T){return C.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=A2?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(y,j,f)&&c.push(n.hi.updateTargetData(i,j))});let u=Vn(),d=ae();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(D2(i,o,e.documentUpdates).next(f=>{u=f.Ls,d=f.ks})),!r.isEqual(te.min())){const f=n.hi.getLastRemoteSnapshotVersion(i).next(g=>n.hi.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(f)}return U.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Fs=s,i))}function D2(t,e,n){let r=ae(),s=ae();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Vn();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(te.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):W(qf,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ls:o,ks:s}})}function O2(t,e){const n=ne(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Cf),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function V2(t,e){const n=ne(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.hi.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.hi.allocateTargetId(r).next(o=>(s=new tr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function fh(t,e,n){const r=ne(t),s=r.Fs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!gi(o))throw o;W(qf,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function by(t,e,n){const r=ne(t);let s=te.min(),i=ae();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const g=ne(u),y=g.Ms.get(f);return y!==void 0?U.resolve(g.Fs.get(y)):g.hi.getTargetData(d,f)}(r,o,dn(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:te.min(),n?i:ae())).next(c=>(M2(r,Ij(e),c),{documents:c,qs:i})))}function M2(t,e,n){let r=t.xs.get(e)||te.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.xs.set(e,r)}class Sy{constructor(){this.activeTargetIds=Aj()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class L2{constructor(){this.Fo=new Sy,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Sy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy="ConnectivityMonitor";class Ay{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){W(jy,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){W(jy,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ba=null;function mh(){return Ba===null?Ba=function(){return 268435456+Math.round(2147483648*Math.random())}():Ba++,"0x"+Ba.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu="RestConnection",U2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $2{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===Yl?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=mh(),c=this.Go(e,n.toUriEncodedString());W(Qu,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,s,i);const{host:d}=new URL(c),f=di(d);return this.jo(e,c,u,r,f).then(g=>(W(Qu,`Received RPC '${e}' ${o}: `,g),g),g=>{throw xr(Qu,`RPC '${e}' ${o} failed with error: `,g,"url: ",c,"request:",r),g})}Jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Go(e,n){const r=U2[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const st="WebChannelConnection";class B2 extends $2{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,s,i){const o=mh();return new Promise((c,u)=>{const d=new r_;d.setWithCredentials(!0),d.listenOnce(s_.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case ul.NO_ERROR:const g=d.getResponseJson();W(st,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),c(g);break;case ul.TIMEOUT:W(st,`RPC '${e}' ${o} timed out`),u(new G(F.DEADLINE_EXCEEDED,"Request time out"));break;case ul.HTTP_ERROR:const y=d.getStatus();if(W(st,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let j=d.getResponseJson();Array.isArray(j)&&(j=j[0]);const k=j==null?void 0:j.error;if(k&&k.status&&k.message){const C=function(T){const S=T.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(S)>=0?S:F.UNKNOWN}(k.status);u(new G(C,k.message))}else u(new G(F.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new G(F.UNAVAILABLE,"Connection failed."));break;default:ee(9055,{c_:e,streamId:o,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{W(st,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);W(st,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",f,r,15)})}P_(e,n,r){const s=mh(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=a_(),c=o_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");W(st,`Creating RPC '${e}' stream ${s}: ${f}`,u);const g=o.createWebChannel(f,u);this.T_(g);let y=!1,j=!1;const k=new z2({Ho:V=>{j?W(st,`Not sending because RPC '${e}' stream ${s} is closed:`,V):(y||(W(st,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),W(st,`RPC '${e}' stream ${s} sending:`,V),g.send(V))},Yo:()=>g.close()}),C=(V,T,S)=>{V.listen(T,N=>{try{S(N)}catch(R){setTimeout(()=>{throw R},0)}})};return C(g,Gi.EventType.OPEN,()=>{j||(W(st,`RPC '${e}' stream ${s} transport opened.`),k.s_())}),C(g,Gi.EventType.CLOSE,()=>{j||(j=!0,W(st,`RPC '${e}' stream ${s} transport closed`),k.__(),this.I_(g))}),C(g,Gi.EventType.ERROR,V=>{j||(j=!0,xr(st,`RPC '${e}' stream ${s} transport errored. Name:`,V.name,"Message:",V.message),k.__(new G(F.UNAVAILABLE,"The operation could not be completed")))}),C(g,Gi.EventType.MESSAGE,V=>{var T;if(!j){const S=V.data[0];he(!!S,16349);const N=S,R=(N==null?void 0:N.error)||((T=N[0])===null||T===void 0?void 0:T.error);if(R){W(st,`RPC '${e}' stream ${s} received error:`,R);const A=R.status;let O=function(p){const I=De[p];if(I!==void 0)return q_(I)}(A),E=R.message;O===void 0&&(O=F.INTERNAL,E="Unknown error status: "+A+" with message "+R.message),j=!0,k.__(new G(O,E)),g.close()}else W(st,`RPC '${e}' stream ${s} received:`,S),k.a_(S)}}),C(c,i_.STAT_EVENT,V=>{V.stat===th.PROXY?W(st,`RPC '${e}' stream ${s} detected buffering proxy`):V.stat===th.NOPROXY&&W(st,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.o_()},0),k}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function Yu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t){return new Gj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=s,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,n-r);s>0&&W("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky="PersistentStream";class iw{constructor(e,n,r,s,i,o,c,u){this.Fi=e,this.w_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new sw(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Dn(n.toString()),Dn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.b_===n&&this.W_(r,s)},r=>{e(()=>{const s=new G(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(s=>{r(()=>this.G_(s))}),this.stream.onMessage(s=>{r(()=>++this.C_==1?this.j_(s):this.onNext(s))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return W(ky,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(W(ky,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class q2 extends iw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=Yj(this.serializer,e),r=function(i){if(!("targetChange"in i))return te.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?hn(o.readTime):te.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=hh(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=oh(u)?{documents:Zj(i,u)}:{query:e2(i,u).Vt},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=G_(i,o.resumeToken);const d=ch(i,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(te.min())>0){c.readTime=nc(i,o.snapshotVersion.toTimestamp());const d=ch(i,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=n2(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=hh(this.serializer),n.removeTarget=e,this.k_(n)}}class H2 extends iw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return he(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){he(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=Jj(e.writeResults,e.commitTime),r=hn(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=hh(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Xj(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{}class G2 extends W2{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,uh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(F.UNKNOWN,i.toString())})}Jo(e,n,r,s,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Jo(e,uh(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(F.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class K2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Dn(n),this._a=!1):W("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="RemoteStore";class Q2{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{cs(this)&&(W(ns,"Restarting streams for network reachability change."),await async function(u){const d=ne(u);d.Ia.add(4),await Zo(d),d.Aa.set("Unknown"),d.Ia.delete(4),await Mc(d)}(this))})}),this.Aa=new K2(r,s)}}async function Mc(t){if(cs(t))for(const e of t.da)await e(!0)}async function Zo(t){for(const e of t.da)await e(!1)}function ow(t,e){const n=ne(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Kf(n)?Gf(n):yi(n).x_()&&Wf(n,e))}function Hf(t,e){const n=ne(t),r=yi(n);n.Ta.delete(e),r.x_()&&aw(n,e),n.Ta.size===0&&(r.x_()?r.B_():cs(n)&&n.Aa.set("Unknown"))}function Wf(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}yi(t).H_(e)}function aw(t,e){t.Ra.$e(e),yi(t).Y_(e)}function Gf(t){t.Ra=new Bj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),yi(t).start(),t.Aa.aa()}function Kf(t){return cs(t)&&!yi(t).M_()&&t.Ta.size>0}function cs(t){return ne(t).Ia.size===0}function lw(t){t.Ra=void 0}async function Y2(t){t.Aa.set("Online")}async function X2(t){t.Ta.forEach((e,n)=>{Wf(t,e)})}async function J2(t,e){lw(t),Kf(t)?(t.Aa.la(e),Gf(t)):t.Aa.set("Unknown")}async function Z2(t,e,n){if(t.Aa.set("Online"),e instanceof W_&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ta.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ta.delete(c),s.Ra.removeTarget(c))}(t,e)}catch(r){W(ns,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await sc(t,r)}else if(e instanceof ml?t.Ra.Ye(e):e instanceof H_?t.Ra.it(e):t.Ra.et(e),!n.isEqual(te.min()))try{const r=await rw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Ra.Pt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ta.get(d);f&&i.Ta.set(d,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const f=i.Ta.get(u);if(!f)return;i.Ta.set(u,f.withResumeToken(Je.EMPTY_BYTE_STRING,f.snapshotVersion)),aw(i,u);const g=new tr(f.target,u,d,f.sequenceNumber);Wf(i,g)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){W(ns,"Failed to raise snapshot:",r),await sc(t,r)}}async function sc(t,e,n){if(!gi(e))throw e;t.Ia.add(1),await Zo(t),t.Aa.set("Offline"),n||(n=()=>rw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(ns,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await Mc(t)})}function cw(t,e){return e().catch(n=>sc(t,n,e))}async function Lc(t){const e=ne(t),n=Tr(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Cf;for(;eA(e);)try{const s=await O2(e.localStore,r);if(s===null){e.Pa.length===0&&n.B_();break}r=s.batchId,tA(e,s)}catch(s){await sc(e,s)}uw(e)&&dw(e)}function eA(t){return cs(t)&&t.Pa.length<10}function tA(t,e){t.Pa.push(e);const n=Tr(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function uw(t){return cs(t)&&!Tr(t).M_()&&t.Pa.length>0}function dw(t){Tr(t).start()}async function nA(t){Tr(t).na()}async function rA(t){const e=Tr(t);for(const n of t.Pa)e.X_(n.mutations)}async function sA(t,e,n){const r=t.Pa.shift(),s=Lf.from(r,e,n);await cw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Lc(t)}async function iA(t,e){e&&Tr(t).Z_&&await async function(r,s){if(function(o){return $j(o)&&o!==F.ABORTED}(s.code)){const i=r.Pa.shift();Tr(r).N_(),await cw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Lc(r)}}(t,e),uw(t)&&dw(t)}async function Cy(t,e){const n=ne(t);n.asyncQueue.verifyOperationInProgress(),W(ns,"RemoteStore received new credentials");const r=cs(n);n.Ia.add(3),await Zo(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await Mc(n)}async function oA(t,e){const n=ne(t);e?(n.Ia.delete(2),await Mc(n)):e||(n.Ia.add(2),await Zo(n),n.Aa.set("Unknown"))}function yi(t){return t.Va||(t.Va=function(n,r,s){const i=ne(n);return i.ia(),new q2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:Y2.bind(null,t),e_:X2.bind(null,t),n_:J2.bind(null,t),J_:Z2.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Kf(t)?Gf(t):t.Aa.set("Unknown")):(await t.Va.stop(),lw(t))})),t.Va}function Tr(t){return t.ma||(t.ma=function(n,r,s){const i=ne(n);return i.ia(),new H2(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:nA.bind(null,t),n_:iA.bind(null,t),ea:rA.bind(null,t),ta:sA.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Lc(t)):(await t.ma.stop(),t.Pa.length>0&&(W(ns,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new Qf(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Yf(t,e){if(Dn("AsyncQueue",`${e}: ${t}`),gi(t))return new G(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{static emptySet(e){return new Ws(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||J.comparator(n.key,r.key):(n,r)=>J.comparator(n.key,r.key),this.keyedMap=Ki(),this.sortedSet=new Se(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ws)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ws;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(){this.fa=new Se(J.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):ee(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class ai{constructor(e,n,r,s,i,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new ai(e,n,Ws.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class lA{constructor(){this.queries=Py(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const s=ne(n),i=s.queries;s.queries=Py(),i.forEach((o,c)=>{for(const u of c.wa)u.onError(r)})})(this,new G(F.ABORTED,"Firestore shutting down"))}}function Py(){return new ls(t=>R_(t),Cc)}async function cA(t,e){const n=ne(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.ba()&&(r=2):(i=new aA,r=e.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(s,!0);break;case 1:i.ya=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=Yf(o,`Initialization of query '${_s(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.wa.push(e),e.va(n.onlineState),i.ya&&e.Ca(i.ya)&&Xf(n)}async function uA(t,e){const n=ne(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.wa.indexOf(e);o>=0&&(i.wa.splice(o,1),i.wa.length===0?s=e.ba()?0:1:!i.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function dA(t,e){const n=ne(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.wa)c.Ca(s)&&(r=!0);o.ya=s}}r&&Xf(n)}function hA(t,e,n){const r=ne(t),s=r.queries.get(e);if(s)for(const i of s.wa)i.onError(n);r.queries.delete(e)}function Xf(t){t.Da.forEach(e=>{e.next()})}var ph,Dy;(Dy=ph||(ph={})).Fa="default",Dy.Cache="cache";class fA{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ai(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=ai.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==ph.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e){this.key=e}}class fw{constructor(e){this.key=e}}class mA{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ae(),this.mutatedKeys=ae(),this.Xa=P_(e),this.eu=new Ws(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new Ry,s=n?n.eu:this.eu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,g)=>{const y=s.get(f),j=Rc(this.query,g)?g:null,k=!!y&&this.mutatedKeys.has(y.key),C=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let V=!1;y&&j?y.data.isEqual(j.data)?k!==C&&(r.track({type:3,doc:j}),V=!0):this.iu(y,j)||(r.track({type:2,doc:j}),V=!0,(u&&this.Xa(j,u)>0||d&&this.Xa(j,d)<0)&&(c=!0)):!y&&j?(r.track({type:0,doc:j}),V=!0):y&&!j&&(r.track({type:1,doc:y}),V=!0,(u||d)&&(c=!0)),V&&(j?(o=o.add(j),i=C?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{eu:o,ru:r,Ds:c,mutatedKeys:i}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((f,g)=>function(j,k){const C=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ee(20277,{At:V})}};return C(j)-C(k)}(f.type,g.type)||this.Xa(f.doc,g.doc)),this.su(r),s=s!=null&&s;const c=n&&!s?this.ou():[],u=this.Za.size===0&&this.current&&!s?1:0,d=u!==this.Ya;return this.Ya=u,o.length!==0||d?{snapshot:new ai(this.query,e.eu,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:c}:{_u:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Ry,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ae(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new fw(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new hw(r))}),n}uu(e){this.Ha=e.qs,this.Za=ae();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return ai.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Jf="SyncEngine";class pA{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class gA{constructor(e){this.key=e,this.lu=!1}}class yA{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new ls(c=>R_(c),Cc),this.Tu=new Map,this.Iu=new Set,this.du=new Se(J.comparator),this.Eu=new Map,this.Au=new $f,this.Ru={},this.Vu=new Map,this.mu=oi.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function vA(t,e,n=!0){const r=xw(t);let s;const i=r.Pu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.cu()):s=await mw(r,e,n,!0),s}async function xA(t,e){const n=xw(t);await mw(n,e,!0,!1)}async function mw(t,e,n,r){const s=await V2(t.localStore,dn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await _A(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&ow(t.remoteStore,s),c}async function _A(t,e,n,r,s){t.gu=(g,y,j)=>async function(C,V,T,S){let N=V.view.nu(T);N.Ds&&(N=await by(C.localStore,V.query,!1).then(({documents:E})=>V.view.nu(E,N)));const R=S&&S.targetChanges.get(V.targetId),A=S&&S.targetMismatches.get(V.targetId)!=null,O=V.view.applyChanges(N,C.isPrimaryClient,R,A);return Vy(C,V.targetId,O._u),O.snapshot}(t,g,y,j);const i=await by(t.localStore,e,!0),o=new mA(e,i.qs),c=o.nu(i.documents),u=Jo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(c,t.isPrimaryClient,u);Vy(t,n,d._u);const f=new pA(e,n,o);return t.Pu.set(e,f),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),d.snapshot}async function wA(t,e,n){const r=ne(t),s=r.Pu.get(e),i=r.Tu.get(s.targetId);if(i.length>1)return r.Tu.set(s.targetId,i.filter(o=>!Cc(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await fh(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Hf(r.remoteStore,s.targetId),gh(r,s.targetId)}).catch(pi)):(gh(r,s.targetId),await fh(r.localStore,s.targetId,!0))}async function EA(t,e){const n=ne(t),r=n.Pu.get(e),s=n.Tu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Hf(n.remoteStore,r.targetId))}async function IA(t,e,n){const r=kA(t);try{const s=await function(o,c){const u=ne(o),d=_e.now(),f=c.reduce((j,k)=>j.add(k.key),ae());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",j=>{let k=Vn(),C=ae();return u.Os.getEntries(j,f).next(V=>{k=V,k.forEach((T,S)=>{S.isValidDocument()||(C=C.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(j,k)).next(V=>{g=V;const T=[];for(const S of c){const N=Vj(S,g.get(S.key).overlayedDocument);N!=null&&T.push(new Rr(S.key,N,I_(N.value.mapValue),Ft.exists(!0)))}return u.mutationQueue.addMutationBatch(j,d,T,c)}).next(V=>{y=V;const T=V.applyToLocalDocumentSet(g,C);return u.documentOverlayCache.saveOverlays(j,V.batchId,T)})}).then(()=>({batchId:y.batchId,changes:O_(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let d=o.Ru[o.currentUser.toKey()];d||(d=new Se(se)),d=d.insert(c,u),o.Ru[o.currentUser.toKey()]=d}(r,s.batchId,n),await ea(r,s.changes),await Lc(r.remoteStore)}catch(s){const i=Yf(s,"Failed to persist write");n.reject(i)}}async function pw(t,e){const n=ne(t);try{const r=await P2(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Eu.get(i);o&&(he(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.lu=!0:s.modifiedDocuments.size>0?he(o.lu,14607):s.removedDocuments.size>0&&(he(o.lu,42227),o.lu=!1))}),await ea(n,r,e)}catch(r){await pi(r)}}function Oy(t,e,n){const r=ne(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Pu.forEach((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=ne(o);u.onlineState=c;let d=!1;u.queries.forEach((f,g)=>{for(const y of g.wa)y.va(c)&&(d=!0)}),d&&Xf(u)}(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function TA(t,e,n){const r=ne(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Eu.get(e),i=s&&s.key;if(i){let o=new Se(J.comparator);o=o.insert(i,at.newNoDocument(i,te.min()));const c=ae().add(i),u=new Oc(te.min(),new Map,new Se(se),o,c);await pw(r,u),r.du=r.du.remove(i),r.Eu.delete(e),Zf(r)}else await fh(r.localStore,e,!1).then(()=>gh(r,e,n)).catch(pi)}async function NA(t,e){const n=ne(t),r=e.batch.batchId;try{const s=await R2(n.localStore,e);yw(n,r,null),gw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ea(n,s)}catch(s){await pi(s)}}async function bA(t,e,n){const r=ne(t);try{const s=await function(o,c){const u=ne(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(g=>(he(g!==null,37113),f=g.keys(),u.mutationQueue.removeMutationBatch(d,g))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);yw(r,e,n),gw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ea(r,s)}catch(s){await pi(s)}}function gw(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function yw(t,e,n){const r=ne(t);let s=r.Ru[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function gh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||vw(t,r)})}function vw(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Hf(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),Zf(t))}function Vy(t,e,n){for(const r of n)r instanceof hw?(t.Au.addReference(r.key,e),SA(t,r)):r instanceof fw?(W(Jf,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||vw(t,r.key)):ee(19791,{yu:r})}function SA(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(W(Jf,"New document in limbo: "+n),t.Iu.add(r),Zf(t))}function Zf(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new J(ge.fromString(e)),r=t.mu.next();t.Eu.set(r,new gA(n)),t.du=t.du.insert(n,r),ow(t.remoteStore,new tr(dn(k_(n.path)),r,"TargetPurposeLimboResolution",jc.ue))}}async function ea(t,e,n){const r=ne(t),s=[],i=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((c,u)=>{o.push(r.gu(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const g=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(d){s.push(d);const g=Bf.Es(u.targetId,d);i.push(g)}}))}),await Promise.all(o),r.hu.J_(s),await async function(u,d){const f=ne(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>U.forEach(d,y=>U.forEach(y.Is,j=>f.persistence.referenceDelegate.addReference(g,y.targetId,j)).next(()=>U.forEach(y.ds,j=>f.persistence.referenceDelegate.removeReference(g,y.targetId,j)))))}catch(g){if(!gi(g))throw g;W(qf,"Failed to update sequence numbers: "+g)}for(const g of d){const y=g.targetId;if(!g.fromCache){const j=f.Fs.get(y),k=j.snapshotVersion,C=j.withLastLimboFreeSnapshotVersion(k);f.Fs=f.Fs.insert(y,C)}}}(r.localStore,i))}async function jA(t,e){const n=ne(t);if(!n.currentUser.isEqual(e)){W(Jf,"User change. New user:",e.toKey());const r=await nw(n.localStore,e);n.currentUser=e,function(i,o){i.Vu.forEach(c=>{c.forEach(u=>{u.reject(new G(F.CANCELLED,o))})}),i.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ea(n,r.Bs)}}function AA(t,e){const n=ne(t),r=n.Eu.get(e);if(r&&r.lu)return ae().add(r.key);{let s=ae();const i=n.Tu.get(e);if(!i)return s;for(const o of i){const c=n.Pu.get(o);s=s.unionWith(c.view.tu)}return s}}function xw(t){const e=ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=pw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TA.bind(null,e),e.hu.J_=dA.bind(null,e.eventManager),e.hu.pu=hA.bind(null,e.eventManager),e}function kA(t){const e=ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=NA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bA.bind(null,e),e}class ic{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vc(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return C2(this.persistence,new j2,e.initialUser,this.serializer)}Du(e){return new tw(zf.Vi,this.serializer)}bu(e){return new L2}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ic.provider={build:()=>new ic};class CA extends ic{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){he(this.persistence.referenceDelegate instanceof rc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new f2(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?vt.withCacheSize(this.cacheSizeBytes):vt.DEFAULT;return new tw(r=>rc.Vi(r,n),this.serializer)}}class yh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Oy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=jA.bind(null,this.syncEngine),await oA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new lA}()}createDatastore(e){const n=Vc(e.databaseInfo.databaseId),r=function(i){return new B2(i)}(e.databaseInfo);return function(i,o,c,u){return new G2(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new Q2(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Oy(this.syncEngine,n,0),function(){return Ay.C()?new Ay:new F2}())}createSyncEngine(e,n){return function(s,i,o,c,u,d,f){const g=new yA(s,i,o,c,u,d);return f&&(g.fu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ne(s);W(ns,"RemoteStore shutting down."),i.Ia.add(5),await Zo(i),i.Ea.shutdown(),i.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}yh.provider={build:()=>new yh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Dn("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="FirestoreClient";class PA{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=it.UNAUTHENTICATED,this.clientId=kf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{W(Nr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(W(Nr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Yf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Xu(t,e){t.asyncQueue.verifyOperationInProgress(),W(Nr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await nw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>{xr("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{W("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(s=>{xr("Terminating Firestore due to IndexedDb database deletion failed",s)})}),t._offlineComponents=e}async function My(t,e){t.asyncQueue.verifyOperationInProgress();const n=await DA(t);W(Nr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Cy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Cy(e.remoteStore,s)),t._onlineComponents=e}async function DA(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(Nr,"Using user provided OfflineComponentProvider");try{await Xu(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;xr("Error using user provided cache. Falling back to memory cache: "+n),await Xu(t,new ic)}}else W(Nr,"Using default OfflineComponentProvider"),await Xu(t,new CA(void 0));return t._offlineComponents}async function _w(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(Nr,"Using user provided OnlineComponentProvider"),await My(t,t._uninitializedComponentsProvider._online)):(W(Nr,"Using default OnlineComponentProvider"),await My(t,new yh))),t._onlineComponents}function OA(t){return _w(t).then(e=>e.syncEngine)}async function VA(t){const e=await _w(t),n=e.eventManager;return n.onListen=vA.bind(null,e.syncEngine),n.onUnlisten=wA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=xA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=EA.bind(null,e.syncEngine),n}function MA(t,e,n={}){const r=new mr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const f=new RA({next:y=>{f.Ou(),o.enqueueAndForget(()=>uA(i,g)),y.fromCache&&u.source==="server"?d.reject(new G(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),g=new fA(c,f,{includeMetadataChanges:!0,ka:!0});return cA(i,g)}(await VA(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew="firestore.googleapis.com",Fy=!0;class Uy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ew,this.ssl=Fy}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:Fy;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ew;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<d2)throw new G(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}XS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ww((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uy({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uy(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new zS;switch(r.type){case"firstParty":return new WS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Ly.get(n);r&&(W("ComponentProvider","Removing Datastore"),Ly.delete(n),r.terminate())}(this),Promise.resolve()}}function LA(t,e,n,r={}){var s;t=On(t,Fc);const i=di(e),o=t._getSettings(),c=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${n}`;i&&(mx(`https://${u}`),px("Firestore",!0)),o.host!==Ew&&o.host!==u&&xr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:u,ssl:i,emulatorOptions:r});if(!Xr(d,c)&&(t._setSettings(d),r.mockUserToken)){let f,g;if(typeof r.mockUserToken=="string")f=r.mockUserToken,g=it.MOCK_USER;else{f=eT(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new G(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new it(y)}t._authCredentials=new BS(new c_(f,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new vi(this.firestore,e,this._query)}}class Le{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Le(this.firestore,e,this._key)}toJSON(){return{type:Le._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Qo(n,Le._jsonSchema))return new Le(e,r||null,new J(ge.fromString(n.referencePath)))}}Le._jsonSchemaVersion="firestore/documentReference/1.0",Le._jsonSchema={type:Me("string",Le._jsonSchemaVersion),referencePath:Me("string")};class pr extends vi{constructor(e,n,r){super(e,n,k_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Le(this.firestore,null,new J(e))}withConverter(e){return new pr(this.firestore,e,this._path)}}function yt(t,e,...n){if(t=He(t),d_("collection","path",e),t instanceof Fc){const r=ge.fromString(e,...n);return Zg(r),new pr(t,null,r)}{if(!(t instanceof Le||t instanceof pr))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return Zg(r),new pr(t.firestore,null,r)}}function qn(t,e,...n){if(t=He(t),arguments.length===1&&(e=kf.newId()),d_("doc","path",e),t instanceof Fc){const r=ge.fromString(e,...n);return Jg(r),new Le(t,null,new J(r))}{if(!(t instanceof Le||t instanceof pr))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return Jg(r),new Le(t.firestore,t instanceof pr?t.converter:null,new J(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="AsyncQueue";class zy{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new sw(this,"async_queue_retry"),this.oc=()=>{const r=Yu();r&&W($y,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=Yu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=Yu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new mr;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!gi(e))throw e;W($y,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Dn("INTERNAL UNHANDLED ERROR: ",By(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const s=Qf.createAndSchedule(this,e,n,r,i=>this.lc(i));return this.ec.push(s),s}ac(){this.tc&&ee(47125,{hc:By(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function By(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class xi extends Fc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new zy,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zy(e),this._firestoreClient=void 0,await e}}}function FA(t,e){const n=typeof t=="object"?t:xx(),r=typeof t=="string"?t:Yl,s=xf(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=JI("firestore");i&&LA(s,...i)}return s}function Iw(t){if(t._terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||UA(t),t._firestoreClient}function UA(t){var e,n,r;const s=t._freezeSettings(),i=function(c,u,d,f){return new lj(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,ww(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new PA(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vt(Je.fromBase64String(e))}catch(n){throw new G(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Vt(Je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Qo(e,Vt._jsonSchema))return Vt.fromBase64String(e.bytes)}}Vt._jsonSchemaVersion="firestore/bytes/1.0",Vt._jsonSchema={type:Me("string",Vt._jsonSchemaVersion),bytes:Me("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:fn._jsonSchemaVersion}}static fromJSON(e){if(Qo(e,fn._jsonSchema))return new fn(e.latitude,e.longitude)}}fn._jsonSchemaVersion="firestore/geoPoint/1.0",fn._jsonSchema={type:Me("string",fn._jsonSchemaVersion),latitude:Me("number"),longitude:Me("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:mn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Qo(e,mn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new mn(e.vectorValues);throw new G(F.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}mn._jsonSchemaVersion="firestore/vectorValue/1.0",mn._jsonSchema={type:Me("string",mn._jsonSchemaVersion),vectorValues:Me("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A=/^__.*__$/;class zA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Rr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xo(e,this.data,n,this.fieldTransforms)}}class Tw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Rr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Nw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee(40011,{Ec:t})}}class tm{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new tm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return oc(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Nw(this.Ec)&&$A.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class BA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Vc(e)}Dc(e,n,r,s=!1){return new tm({Ec:e,methodName:n,bc:r,path:Qe.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $c(t){const e=t._freezeSettings(),n=Vc(t._databaseId);return new BA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bw(t,e,n,r,s,i={}){const o=t.Dc(i.merge||i.mergeFields?2:0,e,n,s);nm("Data must be an object, but it was:",o,r);const c=Sw(r,o);let u,d;if(i.merge)u=new jt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const g of i.mergeFields){const y=vh(e,g,n);if(!o.contains(y))throw new G(F.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Aw(f,y)||f.push(y)}u=new jt(f),d=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,d=o.fieldTransforms;return new zA(new _t(c),u,d)}class zc extends em{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zc}}function qA(t,e,n,r){const s=t.Dc(1,e,n);nm("Data must be an object, but it was:",s,r);const i=[],o=_t.empty();Cr(r,(u,d)=>{const f=rm(e,u,n);d=He(d);const g=s.gc(f);if(d instanceof zc)i.push(f);else{const y=ta(d,g);y!=null&&(i.push(f),o.set(f,y))}});const c=new jt(i);return new Tw(o,c,s.fieldTransforms)}function HA(t,e,n,r,s,i){const o=t.Dc(1,e,n),c=[vh(e,r,n)],u=[s];if(i.length%2!=0)throw new G(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)c.push(vh(e,i[y])),u.push(i[y+1]);const d=[],f=_t.empty();for(let y=c.length-1;y>=0;--y)if(!Aw(d,c[y])){const j=c[y];let k=u[y];k=He(k);const C=o.gc(j);if(k instanceof zc)d.push(j);else{const V=ta(k,C);V!=null&&(d.push(j),f.set(j,V))}}const g=new jt(d);return new Tw(f,g,o.fieldTransforms)}function WA(t,e,n,r=!1){return ta(n,t.Dc(r?4:3,e))}function ta(t,e){if(jw(t=He(t)))return nm("Unsupported field value:",e,t),Sw(t,e);if(t instanceof em)return function(r,s){if(!Nw(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=ta(c,s.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=He(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kj(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=_e.fromDate(r);return{timestampValue:nc(s.serializer,i)}}if(r instanceof _e){const i=new _e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:nc(s.serializer,i)}}if(r instanceof fn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Vt)return{bytesValue:G_(s.serializer,r._byteString)};if(r instanceof Le){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Uf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof mn)return function(o,c){return{mapValue:{fields:{[__]:{stringValue:E_},[Xl]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw c.wc("VectorValues must only contain numeric values.");return Vf(c.serializer,d)})}}}}}}(r,s);throw s.wc(`Unsupported field value: ${Sc(r)}`)}(t,e)}function Sw(t,e){const n={};return m_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Cr(t,(r,s)=>{const i=ta(s,e.Vc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function jw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof _e||t instanceof fn||t instanceof Vt||t instanceof Le||t instanceof em||t instanceof mn)}function nm(t,e,n){if(!jw(n)||!h_(n)){const r=Sc(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function vh(t,e,n){if((e=He(e))instanceof Uc)return e._internalPath;if(typeof e=="string")return rm(t,e);throw oc("Field path arguments must be of type string or ",t,!1,void 0,n)}const GA=new RegExp("[~\\*/\\[\\]]");function rm(t,e,n){if(e.search(GA)>=0)throw oc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Uc(...e.split("."))._internalPath}catch{throw oc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function oc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new G(F.INVALID_ARGUMENT,c+t+u)}function Aw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Le(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(sm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class KA extends kw{data(){return super.data()}}function sm(t,e){return typeof e=="string"?rm(t,e):e instanceof Uc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class im{}class YA extends im{}function ps(t,e,...n){let r=[];e instanceof im&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof om).length,c=i.filter(u=>u instanceof Bc).length;if(o>1||o>0&&c>0)throw new G(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Bc extends YA{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Bc(e,n,r)}_apply(e){const n=this._parse(e);return Cw(e._query,n),new vi(e.firestore,e.converter,ah(e._query,n))}_parse(e){const n=$c(e.firestore);return function(i,o,c,u,d,f,g){let y;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new G(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Hy(g,f);const k=[];for(const C of g)k.push(qy(u,i,C));y={arrayValue:{values:k}}}else y=qy(u,i,g)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Hy(g,f),y=WA(c,o,g,f==="in"||f==="not-in");return Ve.create(d,f,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function gs(t,e,n){const r=e,s=sm("where",t);return Bc._create(s,r,n)}class om extends im{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new om(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:en.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)Cw(o,u),o=ah(o,u)}(e._query,n),new vi(e.firestore,e.converter,ah(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function qy(t,e,n){if(typeof(n=He(n))=="string"){if(n==="")throw new G(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!C_(e)&&n.indexOf("/")!==-1)throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ge.fromString(n));if(!J.isDocumentKey(r))throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ay(t,new J(r))}if(n instanceof Le)return ay(t,n._key);throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sc(n)}.`)}function Hy(t,e){if(!Array.isArray(t)||t.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cw(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class XA{convertValue(e,n="none"){switch(Ir(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Re(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Er(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ee(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Cr(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[Xl].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Re(o.doubleValue));return new mn(i)}convertGeoPoint(e){return new fn(Re(e.latitude),Re(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=kc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Po(e));default:return null}}convertTimestamp(e){const n=wr(e);return new _e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ge.fromString(e);he(Z_(r),9688,{name:e});const s=new Do(r.get(1),r.get(3)),i=new J(r.popFirst(5));return s.isEqual(n)||Dn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class qa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gs extends kw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new pl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(sm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new G(F.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Gs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Gs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Gs._jsonSchema={type:Me("string",Gs._jsonSchemaVersion),bundleSource:Me("string","DocumentSnapshot"),bundleName:Me("string"),bundle:Me("string")};class pl extends Gs{data(e={}){return super.data(e)}}class Ks{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new qa(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new pl(this._firestore,this._userDataWriter,r.key,r,new qa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new pl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new qa(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new pl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new qa(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:JA(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new G(F.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ks._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=kf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function JA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ee(61501,{type:t})}}Ks._jsonSchemaVersion="firestore/querySnapshot/1.0",Ks._jsonSchema={type:Me("string",Ks._jsonSchemaVersion),bundleSource:Me("string","QuerySnapshot"),bundleName:Me("string"),bundle:Me("string")};class ZA extends XA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Le(this.firestore,null,n)}}function ys(t){t=On(t,vi);const e=On(t.firestore,xi),n=Iw(e),r=new ZA(e);return QA(t._query),MA(n,t._query).then(s=>new Ks(e,r,t,s))}function Ju(t,e,n){t=On(t,Le);const r=On(t.firestore,xi),s=Rw(t.converter,e);return qc(r,[bw($c(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ft.none())])}function Zu(t,e,n,...r){t=On(t,Le);const s=On(t.firestore,xi),i=$c(s);let o;return o=typeof(e=He(e))=="string"||e instanceof Uc?HA(i,"updateDoc",t._key,e,n,r):qA(i,"updateDoc",t._key,e),qc(s,[o.toMutation(t._key,Ft.exists(!0))])}function ek(t){return qc(On(t.firestore,xi),[new Mf(t._key,Ft.none())])}function Ha(t,e){const n=On(t.firestore,xi),r=qn(t),s=Rw(t.converter,e);return qc(n,[bw($c(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Ft.exists(!1))]).then(()=>r)}function qc(t,e){return function(r,s){const i=new mr;return r.asyncQueue.enqueueAndForget(async()=>IA(await OA(r),s,i)),i.promise}(Iw(t),e)}(function(e,n=!0){(function(s){mi=s})(hi),ni(new Jr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new xi(new qS(r.getProvider("auth-internal")),new GS(o,r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new G(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Do(d.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),hr(Gg,Kg,e),hr(Gg,Kg,"esm2017")})();var tk="firebase",nk="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hr(tk,nk,"app");const rk={apiKey:"AIzaSyC6hTMg0ZqvnulzNaVwfNP-9jJH82mn4Co",authDomain:"toxine-v3.firebaseapp.com",projectId:"toxine-v3",storageBucket:"toxine-v3.firebasestorage.app",messagingSenderId:"888629978192",appId:"1:888629978192:web:01d716f1e4988483a11d55",measurementId:"G-QFJJQHKT3D"},Pw=vx(rk),Ce=FA(Pw),Wa=US(Pw),Dw=Y.createContext(void 0),gt=()=>{const t=Y.useContext(Dw);if(!t)throw new Error("useApp must be used within an AppProvider");return t},sk=({children:t})=>{const[e,n]=Y.useState(null),[r,s]=Y.useState([]),[i,o]=Y.useState([]),[c,u]=Y.useState([]),[d,f]=Y.useState([]),[g,y]=Y.useState(!0),[j,k]=Y.useState({diagnoses:["Dystonie cervicale","Spasticité post-AVC","Spasticité cérébrale","Migraine chronique","Hypersialorrhée","Vessie hyperactive","Autre"],muscles:[{id:"1",name:"Sterno-cléido-mastoïdien",region:"Cou",side:"both"},{id:"2",name:"Splénius",region:"Cou",side:"both"},{id:"3",name:"Trapèze",region:"Cou",side:"both"},{id:"4",name:"Biceps brachial",region:"Membre supérieur",side:"both"},{id:"5",name:"Fléchisseurs des doigts",region:"Membre supérieur",side:"both"},{id:"6",name:"Gastrocnémiens",region:"Membre inférieur",side:"both"},{id:"7",name:"Ischio-jambiers",region:"Membre inférieur",side:"both"},{id:"8",name:"Temporal",region:"Visage",side:"both"},{id:"9",name:"Masséter",region:"Visage",side:"both"}],regions:["Cou","Membre supérieur","Membre inférieur","Visage"],products:["Botox","Dysport"],guidanceTypes:["Échographique","Neurostimulation","Anatomique"],postInjectionEvents:["Douleur au site d'injection","Hématome","Faiblesse musculaire","Troubles de la déglutition","Sécheresse buccale","Aucun événement"]}),C=async(x,D)=>{try{const B=(await Nb(Wa,x,D)).user,X=await ys(ps(yt(Ce,"users"),gs("email","==",x)));if(X.empty){const $={id:B.uid,email:x,name:x==="admin@medical.com"?"Dr. Admin":"Dr. Martin",role:x==="admin@medical.com"?"admin":"doctor"};return await Ju(qn(Ce,"users",B.uid),$),n($),!0}else{const $=X.docs[0].data();return n({...$,id:B.uid}),!0}}catch(L){return console.error("Login error:",L),!1}},V=async()=>{try{await Ab(Wa),n(null),s([]),o([]),u([]),f([])}catch(x){console.error("Logout error:",x)}},T=async x=>{try{const D={...x,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),cpaManaged:x.cpaManaged||!1},L=await Ha(yt(Ce,"patients"),D),B={...D,id:L.id};s(X=>[...X,B])}catch(D){throw console.error("Error adding patient:",D),D}},S=async(x,D)=>{try{const L=qn(Ce,"patients",x),B={...D,updatedAt:new Date().toISOString()};await Zu(L,B),s(X=>X.map($=>$.id===x?{...$,...B}:$))}catch(L){throw console.error("Error updating patient:",L),L}},N=async x=>{try{await ek(qn(Ce,"patients",x)),s(D=>D.filter(L=>L.id!==x))}catch(D){throw console.error("Error deleting patient:",D),D}},R=async x=>{try{const D=await Ha(yt(Ce,"injections"),x),L={...x,id:D.id};o(B=>[...B,L])}catch(D){throw console.error("Error adding injection:",D),D}},A=async(x,D)=>{try{const L=qn(Ce,"injections",x);await Zu(L,D),o(B=>B.map(X=>X.id===x?{...X,...D}:X))}catch(L){throw console.error("Error updating injection:",L),L}},O=async x=>{try{const D=await Ha(yt(Ce,"followUps"),x),L={...x,id:D.id};u(B=>[...B,L])}catch(D){throw console.error("Error adding follow-up:",D),D}},E=async x=>{try{const D=await Ha(yt(Ce,"appointments"),x),L={...x,id:D.id};f(B=>[...B,L])}catch(D){throw console.error("Error adding appointment:",D),D}},v=async(x,D)=>{try{const L=qn(Ce,"appointments",x);await Zu(L,D),f(B=>B.map(X=>X.id===x?{...X,...D}:X))}catch(L){throw console.error("Error updating appointment:",L),L}},p=async x=>{try{const L=(await Tb(Wa,x.email,"defaultPassword123")).user,B={...x,id:L.uid};await Ju(qn(Ce,"users",L.uid),B),alert("Compte médecin créé avec succès ! Mot de passe par défaut: defaultPassword123")}catch(D){throw console.error("Error creating user:",D),alert("Erreur lors de la création du compte"),D}},I=x=>{k(D=>({...D,...x}))},b=x=>r.filter(D=>D.doctorId===x),_=()=>{const x=(e==null?void 0:e.role)==="admin"?r:r.filter(re=>re.doctorId===(e==null?void 0:e.id)),D=(e==null?void 0:e.role)==="admin"?i:i.filter(re=>re.doctorId===(e==null?void 0:e.id)),L=(e==null?void 0:e.role)==="admin"?d:d.filter(re=>re.doctorId===(e==null?void 0:e.id)),B=x.length,X=new Set(D.map(re=>re.patientId)).size,$=x.filter(re=>!D.some(de=>de.patientId===re.id)).length,q=new Date,Q=L.filter(re=>re.status==="scheduled"&&new Date(re.date)<q).length;return{totalPatients:B,injectedPatients:X,waitingPatients:$,overdueAppointments:Q}};return Y.useEffect(()=>{e&&(async()=>{try{const D=e.role==="admin"?yt(Ce,"patients"):ps(yt(Ce,"patients"),gs("doctorId","==",e.id)),B=(await ys(D)).docs.map(ke=>({id:ke.id,...ke.data()}));s(B);const X=e.role==="admin"?yt(Ce,"injections"):ps(yt(Ce,"injections"),gs("doctorId","==",e.id)),q=(await ys(X)).docs.map(ke=>({id:ke.id,...ke.data()}));o(q);const Q=e.role==="admin"?yt(Ce,"followUps"):ps(yt(Ce,"followUps"),gs("doctorId","==",e.id)),de=(await ys(Q)).docs.map(ke=>({id:ke.id,...ke.data()}));u(de);const Ie=e.role==="admin"?yt(Ce,"appointments"):ps(yt(Ce,"appointments"),gs("doctorId","==",e.id)),zt=(await ys(Ie)).docs.map(ke=>({id:ke.id,...ke.data()}));f(zt)}catch(D){console.error("Error loading data:",D)}})()},[e]),Y.useEffect(()=>{const x=jb(Wa,async D=>{if(y(!0),D)try{const L=await ys(ps(yt(Ce,"users"),gs("email","==",D.email)));if(L.empty){const B={id:D.uid,email:D.email||"",name:D.email==="admin@medical.com"?"Dr. Admin":"Dr. Martin",role:D.email==="admin@medical.com"?"admin":"doctor"};await Ju(qn(Ce,"users",D.uid),B),n(B)}else{const B=L.docs[0].data();n({...B,id:D.uid})}}catch(L){console.error("Error getting user data:",L),n(null)}else n(null),s([]),o([]),u([]),f([]);y(!1)});return()=>x()},[]),g?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):a.jsx(Dw.Provider,{value:{user:e,patients:r,injections:i,followUps:c,appointments:d,configuration:j,login:C,logout:V,addPatient:T,updatePatient:S,deletePatient:N,addInjection:R,updateInjection:A,addFollowUp:O,addAppointment:E,updateAppointment:v,updateConfiguration:I,getPatientsByDoctor:b,addUser:p,getStats:_,loading:g},children:t})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ik={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),me=(t,e)=>{const n=Y.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:u,...d},f)=>Y.createElement("svg",{ref:f,...ik,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${ok(t)}`,c].join(" "),...d},[...e.map(([g,y])=>Y.createElement(g,y)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=me("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=me("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=me("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=me("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=me("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lk=me("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=me("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=me("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=me("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=me("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=me("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=me("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=me("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=me("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=me("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=me("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=me("Syringe",[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=me("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=me("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=me("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),gk=()=>{const[t,e]=Y.useState(""),[n,r]=Y.useState(""),[s,i]=Y.useState(!1),[o,c]=Y.useState(""),{login:u}=gt(),d=async f=>{f.preventDefault(),i(!0),c("");try{await u(t,n)||c("Email ou mot de passe incorrect")}catch{c("Erreur de connexion")}finally{i(!1)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:a.jsx(ss,{className:"h-8 w-8 text-blue-600"})})}),a.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"MedInject Pro"}),a.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Gestion des injections de toxine botulique"})]}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx(Mw,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full px-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Votre email",value:t,onChange:f=>e(f.target.value)})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Mot de passe"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx(wh,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none relative block w-full px-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Votre mot de passe",value:n,onChange:f=>r(f.target.value)})]})]})]}),o&&a.jsxs("div",{className:"flex items-center space-x-2 text-red-600 bg-red-50 p-3 rounded-md",children:[a.jsx(ak,{className:"h-5 w-5"}),a.jsx("span",{className:"text-sm",children:o})]}),a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:s,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s?"Connexion...":"Se connecter"})}),a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("p",{children:"Comptes de démonstration :"}),a.jsxs("p",{className:"mt-2",children:[a.jsx("strong",{children:"Admin:"})," admin@medical.com / defaultPassword123"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Médecin:"})," doctor@medical.com / defaultPassword123"]})]})})]})]})})},yk=()=>{const{user:t,logout:e}=gt();return a.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-16",children:[a.jsx("div",{className:"flex items-center",children:a.jsxs("div",{className:"flex-shrink-0",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"MedInject Pro"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Gestion des injections de toxine botulique"})]})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(gl,{className:"h-5 w-5 text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:t==null?void 0:t.name}),a.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:(t==null?void 0:t.role)==="admin"?"Admin":"Médecin"})]}),a.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-sm text-gray-700 hover:text-red-600 transition-colors",children:[a.jsx(uk,{className:"h-4 w-4"}),a.jsx("span",{children:"Déconnexion"})]})]})]})})})},vk=({activeTab:t,onTabChange:e})=>{const{user:n}=gt(),s=[{id:"dashboard",label:"Tableau de bord",icon:_h,roles:["admin","doctor"]},{id:"patients",label:"Patients",icon:Vs,roles:["admin","doctor"]},{id:"appointments",label:"Agenda",icon:rs,roles:["admin","doctor"]},{id:"injections",label:"Injections",icon:ss,roles:["admin","doctor"]},{id:"follow-ups",label:"Contrôles",icon:ck,roles:["admin","doctor"]},{id:"reports",label:"Rapports",icon:gr,roles:["admin","doctor"]},{id:"settings",label:"Paramètres",icon:Lw,roles:["admin"]},{id:"user-management",label:"Gestion utilisateurs",icon:pk,roles:["admin"]}].filter(i=>i.roles.includes((n==null?void 0:n.role)||"doctor"));return a.jsx("div",{className:"bg-gray-50 border-r border-gray-200 w-64 flex-shrink-0",children:a.jsxs("nav",{className:"mt-8",children:[a.jsx("div",{className:"px-4",children:a.jsx("h2",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Navigation"})}),a.jsx("div",{className:"mt-4 space-y-1",children:s.map(i=>{const o=i.icon;return a.jsxs("button",{onClick:()=>e(i.id),className:`w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg mx-2 transition-colors ${t===i.id?"bg-blue-50 text-blue-700 border-r-2 border-blue-500":"text-gray-700 hover:bg-gray-100"}`,children:[a.jsx(o,{className:"mr-3 h-5 w-5"}),i.label]},i.id)})})]})})},Ga=({title:t,value:e,icon:n,color:r,subtitle:s})=>a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:t}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e}),s&&a.jsx("p",{className:"text-sm text-gray-500",children:s})]}),a.jsx("div",{className:`p-3 rounded-full ${r}`,children:a.jsx(n,{className:"h-6 w-6 text-white"})})]})}),Wy=()=>{const{getStats:t,user:e,patients:n,injections:r,appointments:s}=gt(),i=t(),o=n.filter(d=>(e==null?void 0:e.role)==="admin"||d.doctorId===(e==null?void 0:e.id)).slice(-5).reverse(),c=s.filter(d=>d.status==="scheduled"&&new Date(d.date)>=new Date&&((e==null?void 0:e.role)==="admin"||d.doctorId===(e==null?void 0:e.id))).sort((d,f)=>new Date(d.date).getTime()-new Date(f.date).getTime()).slice(0,5),u=r.filter(d=>(e==null?void 0:e.role)==="admin"||d.doctorId===(e==null?void 0:e.id)).slice(-5).reverse();return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tableau de bord"}),a.jsx("p",{className:"text-gray-600",children:"Vue d'ensemble de l'activité"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(Ga,{title:"Patients totaux",value:i.totalPatients,icon:Vs,color:"bg-blue-500"}),a.jsx(Ga,{title:"Patients injectés",value:i.injectedPatients,icon:ss,color:"bg-green-500"}),a.jsx(Ga,{title:"En attente",value:i.waitingPatients,icon:Vw,color:"bg-yellow-500"}),a.jsx(Ga,{title:"RDV en retard",value:i.overdueAppointments,icon:xh,color:"bg-red-500"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Patients récents"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:o.length>0?o.map(d=>a.jsx("div",{className:"p-4 hover:bg-gray-50",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[d.firstName," ",d.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:d.diagnosis})]}),a.jsx("span",{className:"text-xs text-gray-400",children:new Date(d.createdAt).toLocaleDateString()})]})},d.id)):a.jsx("div",{className:"p-6 text-center text-gray-500",children:"Aucun patient enregistré"})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Prochains RDV"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:c.length>0?c.map(d=>{const f=n.find(g=>g.id===d.patientId);return a.jsx("div",{className:"p-4 hover:bg-gray-50",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[f==null?void 0:f.firstName," ",f==null?void 0:f.lastName]}),a.jsx("p",{className:"text-sm text-gray-500",children:d.type==="injection"?"Injection":"Contrôle"})]}),a.jsx("span",{className:"text-xs text-gray-400",children:new Date(d.date).toLocaleDateString()})]})},d.id)}):a.jsx("div",{className:"p-6 text-center text-gray-500",children:"Aucun RDV programmé"})})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Injections récentes"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:u.length>0?u.map(d=>{const f=n.find(g=>g.id===d.patientId);return a.jsx("div",{className:"p-4 hover:bg-gray-50",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[f==null?void 0:f.firstName," ",f==null?void 0:f.lastName]}),a.jsxs("p",{className:"text-sm text-gray-500",children:[d.product," - ",d.muscles.length," muscle(s)"]})]}),a.jsx("span",{className:"text-xs text-gray-400",children:new Date(d.date).toLocaleDateString()})]})},d.id)}):a.jsx("div",{className:"p-6 text-center text-gray-500",children:"Aucune injection enregistrée"})})]})]})},xk=(t,e,n)=>{const r=`
RAPPORT D'INJECTION DE TOXINE BOTULIQUE

===========================================

INFORMATIONS PATIENT
===========================================
Nom: ${e.lastName}
Prénom: ${e.firstName}
Date de naissance: ${new Date(e.dateOfBirth).toLocaleDateString("fr-FR")}
Diagnostic: ${e.diagnosis}
Médecin référent: ${e.referringDoctor}

DÉTAILS DE L'INJECTION
===========================================
Date d'injection: ${new Date(t.date).toLocaleDateString("fr-FR")}
Heure: ${new Date(t.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}
Produit utilisé: ${t.product}
Type de guidage: ${t.guidanceType.join(", ")}

MUSCLES INJECTÉS
===========================================
${t.muscles.map(c=>{const u=n.find(d=>d.id===c.muscleId);return`• ${(u==null?void 0:u.name)||"Muscle inconnu"} (${c.side==="left"?"Gauche":"Droit"}): ${c.dosage} UI`}).join(`
`)}

Dosage total: ${t.muscles.reduce((c,u)=>c+u.dosage,0)} UI

ÉVÉNEMENTS POST-INJECTION
===========================================
${t.postInjectionEvents.length>0?t.postInjectionEvents.join(`
• `):"Aucun événement signalé"}

NOTES MÉDICALES
===========================================
${t.notes||"Aucune note particulière"}

SUIVI PRÉVU
===========================================
Date de contrôle prévue: ${t.followUpDate?new Date(t.followUpDate).toLocaleDateString("fr-FR"):"Non définie"}

===========================================
Rapport généré le ${new Date().toLocaleDateString("fr-FR")} à ${new Date().toLocaleTimeString("fr-FR")}
  `,s=new Blob([r],{type:"text/plain;charset=utf-8"}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download=`injection_${e.lastName}_${e.firstName}_${new Date(t.date).toISOString().split("T")[0]}.txt`,o.click(),URL.revokeObjectURL(i)},_k=(t,e,n,r)=>{const s=e.sort((f,g)=>new Date(f.date).getTime()-new Date(g.date).getTime()),i=n.sort((f,g)=>new Date(f.date).getTime()-new Date(g.date).getTime()),o=`
DOSSIER MÉDICAL COMPLET - TOXINE BOTULIQUE

===========================================

INFORMATIONS PATIENT
===========================================
Nom: ${t.lastName}
Prénom: ${t.firstName}
Date de naissance: ${new Date(t.dateOfBirth).toLocaleDateString("fr-FR")}
Diagnostic: ${t.diagnosis}
Médecin référent: ${t.referringDoctor}
Problématique: ${t.problem}
Objectif thérapeutique: ${t.injectionObjective}
Sédation requise: ${t.sedationRequired?"Oui":"Non"}

HISTORIQUE DES INJECTIONS
===========================================
${s.length>0?s.map((f,g)=>`
INJECTION #${g+1}
Date: ${new Date(f.date).toLocaleDateString("fr-FR")}
Produit: ${f.product}
Guidage: ${f.guidanceType.join(", ")}
Muscles injectés:
${f.muscles.map(y=>{const j=r.find(k=>k.id===y.muscleId);return`  • ${(j==null?void 0:j.name)||"Muscle inconnu"} (${y.side==="left"?"Gauche":"Droit"}): ${y.dosage} UI`}).join(`
`)}
Dosage total: ${f.muscles.reduce((y,j)=>y+j.dosage,0)} UI
Événements: ${f.postInjectionEvents.join(", ")}
Notes: ${f.notes||"Aucune"}
`).join(`
`):"Aucune injection enregistrée"}

HISTORIQUE DES CONTRÔLES
===========================================
${i.length>0?i.map((f,g)=>{const y=s.find(j=>j.id===f.injectionId);return`
CONTRÔLE #${g+1}
Date: ${new Date(f.date).toLocaleDateString("fr-FR")}
Injection de référence: ${y?new Date(y.date).toLocaleDateString("fr-FR"):"Non trouvée"}
Objectif atteint: ${f.objectiveAchieved==="achieved"?"Oui":f.objectiveAchieved==="partial"?"Partiellement":"Non"}
Commentaires: ${f.comments}
Prochain RDV: ${f.nextAppointment?new Date(f.nextAppointment).toLocaleDateString("fr-FR"):"Non programmé"}
`}).join(`
`):"Aucun contrôle enregistré"}

RÉSUMÉ STATISTIQUE
===========================================
Nombre total d'injections: ${s.length}
Nombre total de contrôles: ${i.length}
Contrôles avec objectif atteint: ${i.filter(f=>f.objectiveAchieved==="achieved").length}
Taux de succès: ${i.length>0?Math.round(i.filter(f=>f.objectiveAchieved==="achieved").length/i.length*100):0}%

===========================================
Dossier généré le ${new Date().toLocaleDateString("fr-FR")} à ${new Date().toLocaleTimeString("fr-FR")}
  `,c=new Blob([o],{type:"text/plain;charset=utf-8"}),u=URL.createObjectURL(c),d=document.createElement("a");d.href=u,d.download=`dossier_complet_${t.lastName}_${t.firstName}_${new Date().toISOString().split("T")[0]}.txt`,d.click(),URL.revokeObjectURL(u)},wk=({onSuccess:t})=>{const{addPatient:e,configuration:n,user:r}=gt(),[s,i]=Y.useState({firstName:"",lastName:"",dateOfBirth:"",gender:"female",diagnosis:"",problem:"",referringDoctor:"",sedationRequired:!1,cpaManaged:!1,injectionObjective:""}),[o,c]=Y.useState(!1),[u,d]=Y.useState(!1),f=async y=>{y.preventDefault(),c(!0);try{e({...s,doctorId:(r==null?void 0:r.id)||""}),d(!0),setTimeout(()=>d(!1),3e3),t&&t(),i({firstName:"",lastName:"",dateOfBirth:"",gender:"female",diagnosis:"",problem:"",referringDoctor:"",sedationRequired:!1,cpaManaged:!1,injectionObjective:""})}catch(j){console.error("Error adding patient:",j)}finally{c(!1)}},g=y=>{const{name:j,value:k,type:C}=y.target;i(V=>({...V,[j]:C==="checkbox"?y.target.checked:k}))};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Nouveau patient"}),a.jsx("p",{className:"text-gray-600",children:"Créer un nouveau dossier patient"})]}),u&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm font-medium text-green-800",children:"Patient créé avec succès !"})})]})}),a.jsxs("form",{onSubmit:f,className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"Prénom *"}),a.jsx("input",{type:"text",id:"firstName",name:"firstName",required:!0,value:s.firstName,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Nom *"}),a.jsx("input",{type:"text",id:"lastName",name:"lastName",required:!0,value:s.lastName,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-gray-700",children:"Date de naissance *"}),a.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",required:!0,value:s.dateOfBirth,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-gray-700",children:"Sexe *"}),a.jsxs("select",{id:"gender",name:"gender",required:!0,value:s.gender,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"female",children:"Féminin"}),a.jsx("option",{value:"male",children:"Masculin"}),a.jsx("option",{value:"other",children:"Autre"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"diagnosis",className:"block text-sm font-medium text-gray-700",children:"Diagnostic *"}),a.jsxs("select",{id:"diagnosis",name:"diagnosis",required:!0,value:s.diagnosis,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"Sélectionner un diagnostic"}),n.diagnoses.map(y=>a.jsx("option",{value:y,children:y},y))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"referringDoctor",className:"block text-sm font-medium text-gray-700",children:"Médecin référent *"}),a.jsx("input",{type:"text",id:"referringDoctor",name:"referringDoctor",required:!0,value:s.referringDoctor,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"sedationRequired",name:"sedationRequired",checked:s.sedationRequired,onChange:g,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"sedationRequired",className:"ml-2 block text-sm text-gray-700",children:"Injection avec sédation (anesthésie)"})]}),s.sedationRequired&&a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"cpaManaged",name:"cpaManaged",checked:s.cpaManaged,onChange:g,className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),a.jsx("label",{htmlFor:"cpaManaged",className:"ml-2 block text-sm text-gray-700",children:"CPA géré (anesthésie organisée)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"problem",className:"block text-sm font-medium text-gray-700",children:"Problématique *"}),a.jsx("textarea",{id:"problem",name:"problem",required:!0,rows:3,value:s.problem,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Décrivez la problématique du patient..."})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"injectionObjective",className:"block text-sm font-medium text-gray-700",children:"Objectif de l'injection *"}),a.jsx("textarea",{id:"injectionObjective",name:"injectionObjective",required:!0,rows:3,value:s.injectionObjective,onChange:g,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Décrivez l'objectif thérapeutique..."})]})]}),a.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsxs("button",{type:"button",onClick:()=>{i({firstName:"",lastName:"",dateOfBirth:"",diagnosis:"",problem:"",referringDoctor:"",sedationRequired:!1,injectionObjective:""})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[a.jsx(Uw,{className:"h-4 w-4 mr-2 inline"}),"Annuler"]}),a.jsxs("button",{type:"submit",disabled:o,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[a.jsx(Hc,{className:"h-4 w-4 mr-2 inline"}),o?"Enregistrement...":"Créer le patient"]})]})]})]})},Ek=()=>{const{patients:t,injections:e,followUps:n,appointments:r,user:s,configuration:i,updatePatient:o,deletePatient:c}=gt(),[u,d]=Y.useState(""),[f,g]=Y.useState(null),[y,j]=Y.useState(null),[k,C]=Y.useState(!1),V=t.filter(p=>(s==null?void 0:s.role)==="admin"||p.doctorId===(s==null?void 0:s.id)).filter(p=>p.firstName.toLowerCase().includes(u.toLowerCase())||p.lastName.toLowerCase().includes(u.toLowerCase())||p.diagnosis.toLowerCase().includes(u.toLowerCase())),T=p=>{const I=e.filter(D=>D.patientId===p),b=n.filter(D=>D.patientId===p),_=r.filter(D=>D.patientId===p);return[...I.map(D=>({...D,type:"injection"})),...b.map(D=>({...D,type:"followup"})),..._.map(D=>({...D,type:"appointment"}))].sort((D,L)=>new Date(L.date).getTime()-new Date(D.date).getTime())},S=p=>{alert(`Redirection vers l'agenda pour ${p.firstName} ${p.lastName}`)},N=p=>{j(p)},R=p=>{confirm(`Êtes-vous sûr de vouloir supprimer le patient ${p.firstName} ${p.lastName} ?`)&&c(p.id)},A=p=>{const I=e.filter(_=>_.patientId===p.id),b=n.filter(_=>_.patientId===p.id);_k(p,I,b,i.muscles)},O=p=>{const I=new Date,b=new Date(p);let _=I.getFullYear()-b.getFullYear();const x=I.getMonth()-b.getMonth();return(x<0||x===0&&I.getDate()<b.getDate())&&_--,_},E=({patient:p,onClose:I})=>{const b=T(p.id),_=e.filter(D=>D.patientId===p.id),x=n.filter(D=>D.patientId===p.id);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("h3",{className:"text-xl font-medium text-gray-900",children:["Dossier médical - ",p.firstName," ",p.lastName]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:()=>A(p),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(gr,{className:"h-4 w-4"}),a.jsx("span",{children:"Rapport complet"})]}),a.jsx("button",{onClick:I,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Fermer"})]})]})}),a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Informations patient"}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Nom:"}),a.jsx("div",{className:"font-medium",children:p.lastName})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Prénom:"}),a.jsx("div",{className:"font-medium",children:p.firstName})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Date de naissance:"}),a.jsx("div",{className:"font-medium",children:new Date(p.dateOfBirth).toLocaleDateString("fr-FR")})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Âge:"}),a.jsxs("div",{className:"font-medium",children:[O(p.dateOfBirth)," ans"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Sexe:"}),a.jsx("div",{className:"font-medium",children:p.gender==="male"?"Masculin":p.gender==="female"?"Féminin":"Autre"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Diagnostic:"}),a.jsx("div",{className:"font-medium",children:p.diagnosis})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Médecin référent:"}),a.jsx("div",{className:"font-medium",children:p.referringDoctor})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Sédation:"}),a.jsx("div",{className:"font-medium",children:p.sedationRequired?"Oui":"Non"})]}),p.sedationRequired&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"CPA géré:"}),a.jsx("div",{className:`font-medium ${p.cpaManaged?"text-green-600":"text-red-600"}`,children:p.cpaManaged?"Oui":"Non"})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("span",{className:"text-gray-600",children:"Problématique:"}),a.jsx("div",{className:"mt-2 p-3 bg-white rounded border text-sm",children:p.problem})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("span",{className:"text-gray-600",children:"Objectif thérapeutique:"}),a.jsx("div",{className:"mt-2 p-3 bg-white rounded border text-sm",children:p.injectionObjective})]}),a.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:_.length}),a.jsx("div",{className:"text-xs text-blue-600",children:"Injections"})]}),a.jsxs("div",{className:"text-center p-3 bg-green-50 rounded",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.length}),a.jsx("div",{className:"text-xs text-green-600",children:"Contrôles"})]})]})]})}),a.jsxs("div",{className:"lg:col-span-2",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Timeline chronologique"}),a.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:b.length>0?b.map((D,L)=>a.jsxs("div",{className:"flex items-start space-x-4",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${D.type==="injection"?"bg-blue-100":D.type==="followup"?"bg-green-100":"bg-yellow-100"}`,children:D.type==="injection"?a.jsx(ss,{className:"h-4 w-4 text-blue-600"}):D.type==="followup"?a.jsx(Ow,{className:"h-4 w-4 text-green-600"}):a.jsx(Vw,{className:"h-4 w-4 text-yellow-600"})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex justify-between items-start",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:D.type==="injection"?"Injection":D.type==="followup"?"Contrôle":"Rendez-vous"}),a.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(D.date).toLocaleDateString("fr-FR")," à ",new Date(D.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]}),D.type==="injection"&&a.jsxs("div",{className:"mt-1",children:[a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:D.product}),a.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:[D.muscles.reduce((B,X)=>B+X.dosage,0)," UI"]})]}),D.type==="followup"&&a.jsx("div",{className:"mt-1",children:a.jsx("span",{className:`text-xs px-2 py-1 rounded ${D.objectiveAchieved==="achieved"?"bg-green-100 text-green-800":D.objectiveAchieved==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:D.objectiveAchieved==="achieved"?"Objectif atteint":D.objectiveAchieved==="partial"?"Partiellement atteint":"Non atteint"})})]})}),L<b.length-1&&a.jsx("div",{className:"mt-4 border-l-2 border-gray-200 ml-4 h-4"})]})]},`${D.type}-${D.id}`)):a.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucun événement médical enregistré"})})]})]})})]})})},v=({patient:p,onClose:I,onSave:b})=>{const[_,x]=Y.useState({firstName:p.firstName,lastName:p.lastName,dateOfBirth:p.dateOfBirth,gender:p.gender,diagnosis:p.diagnosis,problem:p.problem,referringDoctor:p.referringDoctor,sedationRequired:p.sedationRequired,cpaManaged:p.cpaManaged||!1,injectionObjective:p.injectionObjective}),D=L=>{L.preventDefault(),b(_),I()};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Modifier le dossier - ",p.firstName," ",p.lastName]})}),a.jsxs("form",{onSubmit:D,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prénom"}),a.jsx("input",{type:"text",required:!0,value:_.firstName,onChange:L=>x(B=>({...B,firstName:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom"}),a.jsx("input",{type:"text",required:!0,value:_.lastName,onChange:L=>x(B=>({...B,lastName:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de naissance"}),a.jsx("input",{type:"date",required:!0,value:_.dateOfBirth,onChange:L=>x(B=>({...B,dateOfBirth:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Sexe"}),a.jsxs("select",{required:!0,value:_.gender,onChange:L=>x(B=>({...B,gender:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"male",children:"Masculin"}),a.jsx("option",{value:"female",children:"Féminin"}),a.jsx("option",{value:"other",children:"Autre"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Diagnostic"}),a.jsx("select",{required:!0,value:_.diagnosis,onChange:L=>x(B=>({...B,diagnosis:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:i.diagnoses.map(L=>a.jsx("option",{value:L,children:L},L))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Médecin référent"}),a.jsx("input",{type:"text",required:!0,value:_.referringDoctor,onChange:L=>x(B=>({...B,referringDoctor:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:_.sedationRequired,onChange:L=>x(B=>({...B,sedationRequired:L.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Sédation requise"})]})}),_.sedationRequired&&a.jsx("div",{className:"flex items-center",children:a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:_.cpaManaged,onChange:L=>x(B=>({...B,cpaManaged:L.target.checked})),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"CPA géré"})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Problématique"}),a.jsx("textarea",{required:!0,rows:3,value:_.problem,onChange:L=>x(B=>({...B,problem:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Objectif thérapeutique"}),a.jsx("textarea",{required:!0,rows:3,value:_.injectionObjective,onChange:L=>x(B=>({...B,injectionObjective:L.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Annuler"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"Enregistrer"})]})]})]})})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Patients"}),a.jsxs("p",{className:"text-gray-600",children:[V.length," patient(s) trouvé(s)"]})]}),a.jsxs("button",{onClick:()=>C(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Nouveau patient"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(na,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher un patient...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u,onChange:p=>d(p.target.value)})]}),k&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Nouveau patient"}),a.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Uw,{className:"h-5 w-5"})})]})}),a.jsx("div",{className:"p-6",children:a.jsx(wk,{onSuccess:()=>C(!1)})})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diagnostic"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Médecin référent"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sédation/CPA"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Créé le"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(p=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[p.firstName," ",p.lastName]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[O(p.dateOfBirth)," ans - ",p.gender==="male"?"H":"F"]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:p.diagnosis})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.referringDoctor}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${p.sedationRequired?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:p.sedationRequired?"Sédation":"Sans sédation"}),p.sedationRequired&&a.jsx("div",{children:a.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${p.cpaManaged?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:["CPA ",p.cpaManaged?"géré":"à gérer"]})})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(p.createdAt).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>g(p),className:"text-blue-600 hover:text-blue-900",title:"Voir le dossier complet",children:a.jsx(am,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>N(p),className:"text-green-600 hover:text-green-900",title:"Modifier le dossier",children:a.jsx(Fw,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>S(p),className:"text-purple-600 hover:text-purple-900",title:"Voir RDV dans agenda",children:a.jsx(rs,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>A(p),className:"text-orange-600 hover:text-orange-900",title:"Rapport dossier complet",children:a.jsx(gr,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>R(p),className:"text-red-600 hover:text-red-900",title:"Supprimer le patient",children:a.jsx(wn,{className:"h-4 w-4"})})]})})]},p.id))})]})})}),f&&a.jsx(E,{patient:f,onClose:()=>g(null)}),y&&a.jsx(v,{patient:y,onClose:()=>j(null),onSave:p=>{o(y.id,p),j(null)}})]})},Ik=()=>{const{appointments:t,patients:e,user:n,addAppointment:r,updateAppointment:s}=gt(),[i,o]=Y.useState(new Date().toISOString().split("T")[0]),[c,u]=Y.useState(!1),[d,f]=Y.useState(null),[g,y]=Y.useState(null),[j,k]=Y.useState("week"),C=t.filter(_=>(n==null?void 0:n.role)==="admin"||_.doctorId===(n==null?void 0:n.id)),V=_=>C.filter(x=>x.date.split("T")[0]===_),N=j==="day"?[i]:j==="week"?(_=>{const x=[],D=new Date(_),L=new Date(D.setDate(D.getDate()-D.getDay()+1));for(let B=0;B<7;B++){const X=new Date(L);X.setDate(L.getDate()+B),x.push(X.toISOString().split("T")[0])}return x})(i):(_=>{const x=new Date(_).getFullYear(),D=new Date(_).getMonth(),L=new Date(x,D,1),B=new Date(L);B.setDate(B.getDate()-B.getDay()+1);const X=[];for(let $=0;$<42;$++){const q=new Date(B);q.setDate(B.getDate()+$),X.push(q.toISOString().split("T")[0])}return X})(i),R=V(new Date().toISOString().split("T")[0]),A=C.filter(_=>_.status==="scheduled"&&new Date(_.date)<new Date),O=_=>{s(_,{status:"completed"})},E=_=>{confirm("Êtes-vous sûr de vouloir annuler ce rendez-vous ?")&&s(_,{status:"cancelled"})},v=(_,x)=>{const D=e.find(L=>L.id===_.patientId);D&&(alert(x==="injection"?`Redirection vers le formulaire d'injection pour ${D.firstName} ${D.lastName}`:`Redirection vers le formulaire de contrôle pour ${D.firstName} ${D.lastName}`),O(_.id),y(null))},p=({appointment:_,onClose:x})=>{const D=e.find(L=>L.id===_.patientId);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Rendez-vous en retard"}),a.jsxs("p",{className:"text-sm text-gray-500",children:[D==null?void 0:D.firstName," ",D==null?void 0:D.lastName," - ",new Date(_.date).toLocaleDateString("fr-FR")]})]}),a.jsxs("div",{className:"p-6 space-y-3",children:[_.type==="injection"&&a.jsxs("button",{onClick:()=>v(_,"injection"),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(ss,{className:"h-4 w-4"}),a.jsx("span",{children:"Remplir l'injection"})]}),_.type==="followup"&&a.jsxs("button",{onClick:()=>v(_,"followup"),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-green-600 text-white rounded-md hover:bg-green-700",children:[a.jsx(Ow,{className:"h-4 w-4"}),a.jsx("span",{children:"Remplir le contrôle"})]}),a.jsx("button",{onClick:()=>O(_.id),className:"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Marquer comme terminé"}),a.jsx("button",{onClick:x,className:"w-full px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Annuler"})]})]})})},I=({appointment:_,onClose:x,onSave:D})=>{const[L,B]=Y.useState({patientId:(_==null?void 0:_.patientId)||"",date:(_==null?void 0:_.date.split("T")[0])||i,time:_!=null&&_.date?new Date(_.date).toTimeString().slice(0,5):"10:00",type:(_==null?void 0:_.type)||"injection",location:(_==null?void 0:_.location)||"service",notes:(_==null?void 0:_.notes)||"",status:(_==null?void 0:_.status)||"scheduled"}),X=q=>{q.preventDefault();const Q=new Date(`${L.date}T${L.time}`);D({...L,date:Q.toISOString(),doctorId:(n==null?void 0:n.id)||""}),x()},$=e.filter(q=>(n==null?void 0:n.role)==="admin"||q.doctorId===(n==null?void 0:n.id));return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:_?"Modifier le rendez-vous":"Nouveau rendez-vous"})}),a.jsxs("form",{onSubmit:X,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Patient"}),a.jsxs("select",{required:!0,value:L.patientId,onChange:q=>{const Q=q.target.value;B(re=>({...re,patientId:Q}))},className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Sélectionner un patient"}),$.map(q=>a.jsxs("option",{value:q.id,children:[q.firstName," ",q.lastName]},q.id))]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),a.jsx("input",{type:"date",required:!0,value:L.date,onChange:q=>B(Q=>({...Q,date:q.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Heure"}),a.jsx("input",{type:"time",required:!0,value:L.time,onChange:q=>B(Q=>({...Q,time:q.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),a.jsxs("select",{value:L.type,onChange:q=>B(Q=>({...Q,type:q.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"injection",children:"Injection"}),a.jsx("option",{value:"followup",children:"Contrôle"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Lieu"}),a.jsxs("select",{value:L.location,onChange:q=>B(Q=>({...Q,location:q.target.value})),disabled:L.type==="followup",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"service",children:"Service"}),L.type==="injection"&&a.jsx("option",{value:"operating_room",children:"Bloc opératoire (avec anesthésie)"})]})]}),_&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Statut"}),a.jsxs("select",{value:L.status,onChange:q=>B(Q=>({...Q,status:q.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"scheduled",children:"Programmé"}),a.jsx("option",{value:"completed",children:"Terminé"}),a.jsx("option",{value:"cancelled",children:"Annulé"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),a.jsx("textarea",{value:L.notes,onChange:q=>B(Q=>({...Q,notes:q.target.value})),rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),L.patientId&&a.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white",children:$.filter(q=>`${q.firstName} ${q.lastName}`.toLowerCase().includes(L.patientId.toLowerCase())).map(q=>a.jsxs("button",{type:"button",onClick:()=>B(Q=>({...Q,patientId:q.id})),className:"w-full text-left p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[a.jsxs("div",{className:"font-medium",children:[q.firstName," ",q.lastName]}),a.jsx("div",{className:"text-sm text-gray-500",children:q.diagnosis})]},q.id))}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Annuler"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:_?"Modifier":"Créer"})]})]})]})})},b=({appointment:_})=>{const x=e.find(L=>L.id===_.patientId),D=_.status==="scheduled"&&new Date(_.date)<new Date;return a.jsx("div",{className:`p-3 rounded-lg border-l-4 ${_.status==="cancelled"?"border-red-500 bg-red-50 opacity-60":_.status==="completed"?"border-green-500 bg-green-50":D?"border-red-500 bg-red-50":_.type==="injection"?"border-blue-500 bg-blue-50":"border-green-500 bg-green-50"}`,children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium text-gray-900",children:[x==null?void 0:x.firstName," ",x==null?void 0:x.lastName]}),a.jsx("p",{className:"text-sm text-gray-600",children:new Date(_.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${_.type==="injection"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:_.type==="injection"?"Injection":"Contrôle"}),a.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[a.jsx(dk,{className:"h-3 w-3 mr-1"}),_.location==="service"?"Service":"Bloc/CPA"]}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${_.status==="completed"?"bg-green-100 text-green-800":_.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:_.status==="completed"?"Terminé":_.status==="cancelled"?"Annulé":"Programmé"})]})]}),a.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[_.status==="scheduled"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>O(_.id),className:"text-green-600 hover:text-green-800",title:"Marquer comme terminé",children:a.jsx(lk,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>f(_),className:"text-blue-600 hover:text-blue-800",title:"Modifier",children:a.jsx(Fw,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>E(_.id),className:"text-red-600 hover:text-red-800",title:"Annuler",children:a.jsx(wn,{className:"h-4 w-4"})})]}),D&&_.status==="scheduled"&&a.jsx(xh,{className:"h-4 w-4 text-red-500"})]})]})})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Agenda"}),a.jsx("p",{className:"text-gray-600",children:"Gestion des rendez-vous"})]}),a.jsxs("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Nouveau RDV"})]})]}),A.length>0&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(xh,{className:"h-5 w-5 text-red-500 mr-2"}),a.jsxs("h3",{className:"text-sm font-medium text-red-800",children:[A.length," rendez-vous en retard"]})]})}),a.jsx("div",{className:"flex space-x-2",children:["day","week","month"].map(_=>a.jsx("button",{onClick:()=>k(_),className:`px-3 py-2 text-sm font-medium rounded-md ${j===_?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,children:_==="day"?"Jour":_==="week"?"Semaine":"Mois"},_))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"lg:col-span-3",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:j==="day"?`Jour du ${new Date(i).toLocaleDateString("fr-FR")}`:j==="week"?`Semaine du ${new Date(N[0]).toLocaleDateString("fr-FR")}`:`Mois de ${new Date(i).toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}`}),a.jsx("input",{type:"date",value:i,onChange:_=>o(_.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm"})]})}),a.jsxs("div",{className:`grid gap-px bg-gray-200 ${j==="day"?"grid-cols-1":"grid-cols-7"}`,children:[["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map(_=>a.jsx("div",{className:"bg-gray-50 p-2 text-center text-sm font-medium text-gray-700",children:_},_)),N.map(_=>{const x=V(_),D=_===new Date().toISOString().split("T")[0],L=j!=="month"||new Date(_).getMonth()===new Date(i).getMonth();return a.jsxs("div",{className:`bg-white p-2 min-h-[120px] ${D?"bg-blue-50":""} ${L?"":"opacity-50"}`,children:[a.jsx("div",{className:`text-sm font-medium mb-2 ${D?"text-blue-700":"text-gray-900"}`,children:new Date(_).getDate()}),a.jsx("div",{className:"space-y-1",children:x.map(B=>{const X=e.find($=>$.id===B.patientId);return a.jsxs("div",{className:`text-xs p-1 rounded cursor-pointer ${B.status==="cancelled"?"bg-red-100 text-red-800 opacity-60":B.status==="completed"?"bg-green-100 text-green-800":B.type==="injection"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,onClick:()=>f(B),children:[a.jsx("div",{className:"font-medium",children:new Date(B.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}),a.jsxs("div",{className:"truncate",children:[X==null?void 0:X.firstName," ",X==null?void 0:X.lastName]})]},B.id)})})]},_)})]})]})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Aujourd'hui"})}),a.jsx("div",{className:"p-4 space-y-3",children:R.length>0?R.map(_=>a.jsx(b,{appointment:_},_.id)):a.jsx("p",{className:"text-gray-500 text-sm",children:"Aucun rendez-vous aujourd'hui"})})]}),A.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-4 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-red-700",children:"En retard"})}),a.jsx("div",{className:"p-4 space-y-3",children:A.slice(0,5).map(_=>a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{appointment:_}),a.jsx("div",{className:"flex justify-center",children:a.jsx("button",{onClick:()=>y(_),className:"px-3 py-1 bg-red-100 text-red-600 rounded-md hover:bg-red-200 text-xs",children:"Actions"})})]},_.id))})]})]})]}),c&&a.jsx(I,{onClose:()=>u(!1),onSave:_=>{r(_),u(!1)}}),d&&a.jsx(I,{appointment:d,onClose:()=>f(null),onSave:_=>{s(d.id,_),f(null)}}),g&&a.jsx(p,{appointment:g,onClose:()=>y(null)})]})},Tk=()=>{const{patients:t,configuration:e,addInjection:n,addAppointment:r,user:s}=gt(),[i,o]=Y.useState(""),[c,u]=Y.useState(""),[d,f]=Y.useState({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),product:"",guidanceType:[],postInjectionEvents:[],notes:"",followUpDate:""}),[g,y]=Y.useState([]),[j,k]=Y.useState(""),V=t.filter(p=>(s==null?void 0:s.role)==="admin"||p.doctorId===(s==null?void 0:s.id)).filter(p=>`${p.firstName} ${p.lastName}`.toLowerCase().includes(c.toLowerCase())),T=j?e.muscles.filter(p=>p.region===j):e.muscles,S=()=>{y(p=>[...p,{muscleId:"",dosage:0,side:"left"}])},N=(p,I,b)=>{y(_=>_.map((x,D)=>D===p?{...x,[I]:b}:x))},R=p=>{y(I=>I.filter((b,_)=>_!==p))},A=(p,I)=>{f(b=>({...b,postInjectionEvents:I?[...b.postInjectionEvents,p]:b.postInjectionEvents.filter(_=>_!==p)}))},O=(p,I)=>{f(b=>({...b,guidanceType:I?[...b.guidanceType,p]:b.guidanceType.filter(_=>_!==p)}))},E=p=>{if(p.preventDefault(),!i||g.length===0){alert("Veuillez sélectionner un patient et au moins un muscle");return}if(d.guidanceType.length===0){alert("Veuillez sélectionner au moins un type de guidage");return}const I=new Date(`${d.date}T${d.time}`);n({patientId:i,date:I.toISOString(),product:d.product,muscles:g.filter(b=>b.muscleId&&b.dosage>0),guidanceType:d.guidanceType,postInjectionEvents:d.postInjectionEvents,notes:d.notes,doctorId:(s==null?void 0:s.id)||"",followUpDate:d.followUpDate||void 0}),d.followUpDate&&r({patientId:i,date:new Date(`${d.followUpDate}T10:00:00`).toISOString(),type:"followup",location:"service",status:"scheduled",notes:"Contrôle post-injection programmé automatiquement",doctorId:(s==null?void 0:s.id)||""}),o(""),f({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),product:"",guidanceType:[],postInjectionEvents:[],notes:"",followUpDate:""}),y([]),u(""),alert("Injection enregistrée avec succès !")},v=()=>g.reduce((p,I)=>p+(I.dosage||0),0);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Nouvelle injection"}),a.jsx("p",{className:"text-gray-600",children:"Enregistrer une séance d'injection"})]}),a.jsxs("form",{onSubmit:E,className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Sélection du patient"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(na,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher un patient...",value:c,onChange:p=>u(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c&&a.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded-md",children:V.map(p=>a.jsxs("button",{type:"button",onClick:()=>{o(p.id),u(`${p.firstName} ${p.lastName}`)},className:`w-full text-left p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 ${i===p.id?"bg-blue-50":""}`,children:[a.jsxs("div",{className:"font-medium",children:[p.firstName," ",p.lastName]}),a.jsx("div",{className:"text-sm text-gray-500",children:p.diagnosis})]},p.id))})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Détails de l'injection"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),a.jsx("input",{type:"date",required:!0,value:d.date,onChange:p=>f(I=>({...I,date:p.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Heure"}),a.jsx("input",{type:"time",required:!0,value:d.time,onChange:p=>f(I=>({...I,time:p.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Produit"}),a.jsxs("select",{required:!0,value:d.product,onChange:p=>f(I=>({...I,product:p.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Sélectionner un produit"}),e.products.map(p=>a.jsx("option",{value:p,children:p},p))]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de contrôle prévue (optionnel)"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx(rs,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"date",value:d.followUpDate,onChange:p=>f(I=>({...I,followUpDate:p.target.value})),className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),d.followUpDate&&a.jsxs("p",{className:"mt-2 text-sm text-blue-600",children:["Un rendez-vous de contrôle sera automatiquement créé pour le ",new Date(d.followUpDate).toLocaleDateString("fr-FR")]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de guidage (sélection multiple possible)"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:e.guidanceTypes.map(p=>a.jsxs("label",{className:"flex items-center space-x-2 p-3 border border-gray-200 rounded-md hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:d.guidanceType.includes(p),onChange:I=>O(p,I.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:p})]},p))})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Muscles injectés"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("span",{className:"text-sm text-gray-600",children:["Total: ",a.jsxs("span",{className:"font-medium",children:[v()," UI"]})]}),a.jsxs("button",{type:"button",onClick:S,className:"flex items-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Ajouter"})]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Filtrer par région"}),a.jsxs("select",{value:j,onChange:p=>k(p.target.value),className:"mt-1 block w-full md:w-64 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Toutes les régions"}),e.regions.map(p=>a.jsx("option",{value:p,children:p},p))]})]}),a.jsxs("div",{className:"space-y-3",children:[g.map((p,I)=>a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 border border-gray-200 rounded-md",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Muscle"}),a.jsxs("select",{value:p.muscleId,onChange:b=>N(I,"muscleId",b.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Sélectionner"}),T.map(b=>a.jsxs("option",{value:b.id,children:[b.name," (",b.region,")"]},b.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Côté"}),a.jsxs("select",{value:p.side,onChange:b=>N(I,"side",b.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"left",children:"Gauche"}),a.jsx("option",{value:"right",children:"Droit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dosage (UI)"}),a.jsx("input",{type:"number",min:"0",step:"0.5",value:p.dosage,onChange:b=>N(I,"dosage",parseFloat(b.target.value)||0),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsx("div",{className:"flex items-end",children:a.jsx("button",{type:"button",onClick:()=>R(I),className:"p-2 text-red-600 hover:text-red-800",children:a.jsx(wn,{className:"h-4 w-4"})})})]},I)),g.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:'Aucun muscle sélectionné. Cliquez sur "Ajouter" pour commencer.'})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Événements post-injection"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:e.postInjectionEvents.map(p=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:d.postInjectionEvents.includes(p),onChange:I=>A(p,I.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:p})]},p))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Notes"}),a.jsx("textarea",{value:d.notes,onChange:p=>f(I=>({...I,notes:p.target.value})),rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Notes additionnelles sur l'injection..."})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:!i||g.length===0||d.guidanceType.length===0,className:"flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(Hc,{className:"h-4 w-4"}),a.jsx("span",{children:"Enregistrer l'injection"})]})})]})]})},Gy=()=>{const{injections:t,patients:e,configuration:n,user:r,updateInjection:s,addAppointment:i}=gt(),[o,c]=Y.useState(""),[u,d]=Y.useState(null),[f,g]=Y.useState(null),y=t.filter(N=>(r==null?void 0:r.role)==="admin"||N.doctorId===(r==null?void 0:r.id)).filter(N=>{const R=e.find(A=>A.id===N.patientId);return R&&`${R.firstName} ${R.lastName}`.toLowerCase().includes(o.toLowerCase())}).sort((N,R)=>new Date(R.date).getTime()-new Date(N.date).getTime()),j=N=>{const R=e.find(O=>O.id===N.patientId);if(!R)return;const A=new Date;A.setMonth(A.getMonth()+3),i({patientId:N.patientId,date:A.toISOString(),type:"followup",location:"service",status:"scheduled",notes:`Contrôle post-injection pour ${R.firstName} ${R.lastName}`,doctorId:(r==null?void 0:r.id)||""}),alert(`Rendez-vous de contrôle programmé pour ${R.firstName} ${R.lastName} le ${A.toLocaleDateString("fr-FR")}`)},k=(N,R)=>{s(N.id,{followUpDate:R}),g(null),alert("Date de contrôle mise à jour avec succès !")},C=N=>{const R=e.find(A=>A.id===N.patientId);R&&xk(N,R,n.muscles)},V=({injection:N,onClose:R})=>{const[A,O]=Y.useState({product:N.product,guidanceType:N.guidanceType,postInjectionEvents:N.postInjectionEvents,notes:N.notes,muscles:N.muscles}),E=b=>{b.preventDefault(),s(N.id,A),R(),alert("Injection modifiée avec succès !")},v=(b,_)=>{O(x=>({...x,guidanceType:_?[...x.guidanceType,b]:x.guidanceType.filter(D=>D!==b)}))},p=(b,_)=>{O(x=>({...x,postInjectionEvents:_?[...x.postInjectionEvents,b]:x.postInjectionEvents.filter(D=>D!==b)}))},I=(b,_,x)=>{O(D=>({...D,muscles:D.muscles.map((L,B)=>B===b?{...L,[_]:x}:L)}))};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Modifier l'injection"}),a.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(N.date).toLocaleDateString("fr-FR")," - Note: La date de contrôle ne peut pas être modifiée ici"]})]}),a.jsxs("form",{onSubmit:E,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Produit"}),a.jsx("select",{required:!0,value:A.product,onChange:b=>O(_=>({..._,product:b.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:n.products.map(b=>a.jsx("option",{value:b,children:b},b))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de guidage"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:n.guidanceTypes.map(b=>a.jsxs("label",{className:"flex items-center space-x-2 p-3 border border-gray-200 rounded-md hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:A.guidanceType.includes(b),onChange:_=>v(b,_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:b})]},b))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Muscles injectés"}),a.jsx("div",{className:"space-y-3",children:A.muscles.map((b,_)=>{const x=n.muscles.find(D=>D.id===b.muscleId);return a.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 border border-gray-200 rounded-md",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium",children:x==null?void 0:x.name}),a.jsx("div",{className:"text-xs text-gray-500",children:x==null?void 0:x.region})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Côté"}),a.jsxs("select",{value:b.side,onChange:D=>I(_,"side",D.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-2 py-1 text-sm",children:[a.jsx("option",{value:"left",children:"Gauche"}),a.jsx("option",{value:"right",children:"Droit"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-600",children:"Dosage (UI)"}),a.jsx("input",{type:"number",min:"0",step:"0.5",value:b.dosage,onChange:D=>I(_,"dosage",parseFloat(D.target.value)||0),className:"mt-1 block w-full border border-gray-300 rounded-md px-2 py-1 text-sm"})]})]},_)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Événements post-injection"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:n.postInjectionEvents.map(b=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",checked:A.postInjectionEvents.includes(b),onChange:_=>p(b,_.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:b})]},b))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),a.jsx("textarea",{value:A.notes,onChange:b=>O(_=>({..._,notes:b.target.value})),rows:4,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:R,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Annuler"}),a.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"Enregistrer"})]})]})]})})},T=({injection:N,onClose:R})=>{const A=e.find(O=>O.id===N.patientId);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Détails de l'injection - ",A==null?void 0:A.firstName," ",A==null?void 0:A.lastName]}),a.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(N.date).toLocaleDateString("fr-FR")," à ",new Date(N.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Informations patient"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Nom:"})," ",A==null?void 0:A.lastName]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Prénom:"})," ",A==null?void 0:A.firstName]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Diagnostic:"})," ",A==null?void 0:A.diagnosis]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Date de naissance:"})," ",A&&new Date(A.dateOfBirth).toLocaleDateString("fr-FR")]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Détails de l'injection"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Produit:"}),a.jsx("div",{className:"font-medium",children:N.product})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Type de guidage:"}),a.jsx("div",{className:"font-medium",children:N.guidanceType.join(", ")})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Dosage total:"}),a.jsxs("div",{className:"font-medium",children:[N.muscles.reduce((O,E)=>O+E.dosage,0)," UI"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Date de contrôle:"}),a.jsx("div",{className:"font-medium",children:N.followUpDate?new Date(N.followUpDate).toLocaleDateString("fr-FR"):"Non définie"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Muscles injectés"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Muscle"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Région"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Côté"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Dosage (UI)"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.muscles.map((O,E)=>{const v=n.muscles.find(p=>p.id===O.muscleId);return a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:v==null?void 0:v.name}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:v==null?void 0:v.region}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:O.side==="left"?"Gauche":"Droit"}),a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:O.dosage})]},E)})})]})})]}),N.postInjectionEvents.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Événements post-injection"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:N.postInjectionEvents.map(O=>a.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-full",children:O},O))})]}),N.notes&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Notes"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 text-sm text-gray-700",children:N.notes})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsx("button",{onClick:R,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Fermer"}),a.jsxs("button",{onClick:()=>C(N),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:[a.jsx(gr,{className:"h-4 w-4 mr-2 inline"}),"Rapport PDF"]})]})]})})},S=({injection:N,onClose:R})=>{const[A,O]=Y.useState(N.followUpDate||"");return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Modifier la date de contrôle"})}),a.jsxs("div",{className:"p-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nouvelle date de contrôle"}),a.jsx("input",{type:"date",value:A,onChange:E=>O(E.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[a.jsx("button",{onClick:R,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Annuler"}),a.jsx("button",{onClick:()=>k(N,A),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:"Enregistrer"})]})]})})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Historique des injections"}),a.jsxs("p",{className:"text-gray-600",children:[y.length," injection(s) trouvée(s)"]})]})}),a.jsxs("div",{className:"relative",children:[a.jsx(na,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher par nom de patient...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:o,onChange:N=>c(N.target.value)})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date injection"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produit"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Muscles"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dosage total"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date contrôle"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Guidage"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(N=>{const R=e.find(O=>O.id===N.patientId),A=N.muscles.reduce((O,E)=>O+E.dosage,0);return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[R==null?void 0:R.firstName," ",R==null?void 0:R.lastName]}),a.jsx("div",{className:"text-sm text-gray-500",children:R==null?void 0:R.diagnosis})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-900",children:new Date(N.date).toLocaleDateString("fr-FR")}),a.jsx("div",{className:"text-sm text-gray-500",children:new Date(N.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:N.product})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[N.muscles.length," muscle(s)"]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[A," UI"]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N.followUpDate?a.jsx("div",{className:"text-sm text-green-600",children:new Date(N.followUpDate).toLocaleDateString("fr-FR")}):a.jsx("span",{className:"text-sm text-gray-400",children:"Non définie"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"flex flex-wrap gap-1",children:N.guidanceType.map(O=>a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${O==="Échographique"?"bg-green-100 text-green-800":O==="Neurostimulation"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:O},O))})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>d(N),className:"text-blue-600 hover:text-blue-900",title:"Voir les détails",children:a.jsx(am,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>C(N),className:"text-green-600 hover:text-green-900",title:"Rapport PDF",children:a.jsx(gr,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>d(N),className:"text-orange-600 hover:text-orange-900",title:"Modifier injection",children:a.jsx(Lw,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>g(N),className:"text-purple-600 hover:text-purple-900",title:"Modifier date de contrôle uniquement",children:a.jsx(rs,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>j(N),className:"text-blue-600 hover:text-blue-900",title:"Programmer contrôle",children:a.jsx(Kt,{className:"h-4 w-4"})})]})})]},N.id)})})]})})}),u&&(u&&typeof u=="object"&&"product"in u?a.jsx(V,{injection:u,onClose:()=>d(null)}):a.jsx(T,{injection:u,onClose:()=>d(null)})),f&&a.jsx(S,{injection:f,onClose:()=>g(null)})]})},Nk=()=>{const{patients:t,injections:e,addFollowUp:n,addAppointment:r,user:s}=gt(),[i,o]=Y.useState(""),[c,u]=Y.useState(""),[d,f]=Y.useState(""),[g,y]=Y.useState({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),objectiveAchieved:"achieved",comments:"",nextAppointment:"",nextAppointmentTime:""}),k=t.filter(T=>(s==null?void 0:s.role)==="admin"||T.doctorId===(s==null?void 0:s.id)).filter(T=>`${T.firstName} ${T.lastName}`.toLowerCase().includes(d.toLowerCase())),C=i?e.filter(T=>T.patientId===i).sort((T,S)=>new Date(S.date).getTime()-new Date(T.date).getTime()):[],V=T=>{if(T.preventDefault(),!i||!c){alert("Veuillez sélectionner un patient et une injection");return}const S=new Date(`${g.date}T${g.time}`);if(n({patientId:i,injectionId:c,date:S.toISOString(),objectiveAchieved:g.objectiveAchieved,comments:g.comments,nextAppointment:g.nextAppointment||void 0,doctorId:(s==null?void 0:s.id)||""}),g.nextAppointment&&g.nextAppointmentTime){const N=new Date(`${g.nextAppointment}T${g.nextAppointmentTime}`);r({patientId:i,date:N.toISOString(),type:"injection",location:"service",status:"scheduled",notes:"RDV programmé suite au contrôle",doctorId:(s==null?void 0:s.id)||""})}o(""),u(""),f(""),y({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),objectiveAchieved:"achieved",comments:"",nextAppointment:"",nextAppointmentTime:""}),alert("Contrôle enregistré avec succès !")};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Nouveau contrôle"}),a.jsx("p",{className:"text-gray-600",children:"Enregistrer un contrôle post-injection"})]}),a.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Sélection du patient"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(na,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher un patient...",value:d,onChange:T=>f(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),d&&a.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded-md",children:k.map(T=>a.jsxs("button",{type:"button",onClick:()=>{o(T.id),f(`${T.firstName} ${T.lastName}`),u("")},className:`w-full text-left p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 ${i===T.id?"bg-blue-50":""}`,children:[a.jsxs("div",{className:"font-medium",children:[T.firstName," ",T.lastName]}),a.jsx("div",{className:"text-sm text-gray-500",children:T.diagnosis})]},T.id))})]})]}),i&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Sélection de l'injection"}),C.length>0?a.jsx("div",{className:"space-y-2",children:C.map(T=>a.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-md hover:bg-gray-50",children:[a.jsx("input",{type:"radio",name:"injection",value:T.id,checked:c===T.id,onChange:S=>u(S.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium text-gray-900",children:[new Date(T.date).toLocaleDateString("fr-FR")," - ",T.product]}),a.jsxs("div",{className:"text-sm text-gray-500",children:[T.muscles.length," muscle(s) - ",T.muscles.reduce((S,N)=>S+N.dosage,0)," UI"]})]}),a.jsx("span",{className:"text-xs text-gray-400",children:new Date(T.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})})]},T.id))}):a.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucune injection trouvée pour ce patient"})]}),c&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Détails du contrôle"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date du contrôle"}),a.jsx("input",{type:"date",required:!0,value:g.date,onChange:T=>y(S=>({...S,date:T.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Heure"}),a.jsx("input",{type:"time",required:!0,value:g.time,onChange:T=>y(S=>({...S,time:T.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Objectif atteint"}),a.jsx("div",{className:"space-y-2",children:[{value:"achieved",label:"Objectif atteint",color:"text-green-600"},{value:"partial",label:"Partiellement atteint",color:"text-yellow-600"},{value:"not_achieved",label:"Non atteint",color:"text-red-600"}].map(T=>a.jsxs("label",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"radio",name:"objective",value:T.value,checked:g.objectiveAchieved===T.value,onChange:S=>y(N=>({...N,objectiveAchieved:S.target.value})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:`text-sm font-medium ${T.color}`,children:T.label})]},T.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Commentaires"}),a.jsx("textarea",{required:!0,value:g.comments,onChange:T=>y(S=>({...S,comments:T.target.value})),rows:4,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Décrivez l'évolution du patient, l'efficacité du traitement, les effets secondaires observés..."})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Prochain rendez-vous (optionnel)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),a.jsx("input",{type:"date",value:g.nextAppointment,onChange:T=>y(S=>({...S,nextAppointment:T.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Heure"}),a.jsx("input",{type:"time",value:g.nextAppointmentTime,onChange:T=>y(S=>({...S,nextAppointmentTime:T.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),g.nextAppointment&&a.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(rs,{className:"h-5 w-5 text-blue-500 mr-2"}),a.jsxs("span",{className:"text-sm text-blue-700",children:["Un rendez-vous sera automatiquement créé pour le ",new Date(g.nextAppointment).toLocaleDateString("fr-FR"),g.nextAppointmentTime&&` à ${g.nextAppointmentTime}`]})]})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",className:"flex items-center space-x-2 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Hc,{className:"h-4 w-4"}),a.jsx("span",{children:"Enregistrer le contrôle"})]})})]})]})]})},Ky=()=>{const{followUps:t,patients:e,injections:n,user:r}=gt(),[s,i]=Y.useState(""),[o,c]=Y.useState(null),u=t.filter(j=>(r==null?void 0:r.role)==="admin"||j.doctorId===(r==null?void 0:r.id)).filter(j=>{const k=e.find(C=>C.id===j.patientId);return k&&`${k.firstName} ${k.lastName}`.toLowerCase().includes(s.toLowerCase())}).sort((j,k)=>new Date(k.date).getTime()-new Date(j.date).getTime()),d=j=>{switch(j){case"achieved":return a.jsx(mk,{className:"h-4 w-4 text-green-600"});case"partial":return a.jsx(hk,{className:"h-4 w-4 text-yellow-600"});case"not_achieved":return a.jsx(fk,{className:"h-4 w-4 text-red-600"});default:return null}},f=j=>{switch(j){case"achieved":return"Atteint";case"partial":return"Partiel";case"not_achieved":return"Non atteint";default:return j}},g=j=>{switch(j){case"achieved":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"not_achieved":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},y=({followUp:j,onClose:k})=>{const C=e.find(T=>T.id===j.patientId),V=n.find(T=>T.id===j.injectionId);return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Détails du contrôle - ",C==null?void 0:C.firstName," ",C==null?void 0:C.lastName]}),a.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(j.date).toLocaleDateString("fr-FR")," à ",new Date(j.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Informations patient"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Nom:"})," ",C==null?void 0:C.lastName]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Prénom:"})," ",C==null?void 0:C.firstName]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Diagnostic:"})," ",C==null?void 0:C.diagnosis]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Date de naissance:"})," ",C&&new Date(C.dateOfBirth).toLocaleDateString("fr-FR")]})]})]}),V&&a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Injection de référence"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Date:"}),a.jsx("div",{className:"font-medium",children:new Date(V.date).toLocaleDateString("fr-FR")})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Produit:"}),a.jsx("div",{className:"font-medium",children:V.product})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Dosage total:"}),a.jsxs("div",{className:"font-medium",children:[V.muscles.reduce((T,S)=>T+S.dosage,0)," UI"]})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Résultats du contrôle"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Objectif thérapeutique:"}),a.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[d(j.objectiveAchieved),a.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${g(j.objectiveAchieved)}`,children:f(j.objectiveAchieved)})]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Commentaires:"}),a.jsx("div",{className:"mt-2 p-4 bg-gray-50 rounded-lg text-sm text-gray-700",children:j.comments})]})]})]}),j.nextAppointment&&a.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Prochain rendez-vous"}),a.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[a.jsx(rs,{className:"h-4 w-4 text-green-600"}),a.jsxs("span",{className:"text-green-700",children:["Programmé pour le ",new Date(j.nextAppointment).toLocaleDateString("fr-FR")]})]})]})]}),a.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:a.jsx("button",{onClick:k,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Fermer"})})]})})};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contrôles post-injection"}),a.jsxs("p",{className:"text-gray-600",children:[u.length," contrôle(s) trouvé(s)"]})]})}),a.jsxs("div",{className:"relative",children:[a.jsx(na,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Rechercher par nom de patient...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:s,onChange:j=>i(j.target.value)})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date contrôle"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Injection référence"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Objectif"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prochain RDV"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map(j=>{const k=e.find(V=>V.id===j.patientId),C=n.find(V=>V.id===j.injectionId);return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[k==null?void 0:k.firstName," ",k==null?void 0:k.lastName]}),a.jsx("div",{className:"text-sm text-gray-500",children:k==null?void 0:k.diagnosis})]})}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-900",children:new Date(j.date).toLocaleDateString("fr-FR")}),a.jsx("div",{className:"text-sm text-gray-500",children:new Date(j.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C?a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-gray-900",children:new Date(C.date).toLocaleDateString("fr-FR")}),a.jsx("div",{className:"text-sm text-gray-500",children:C.product})]}):a.jsx("span",{className:"text-sm text-gray-400",children:"Non trouvée"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[d(j.objectiveAchieved),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${g(j.objectiveAchieved)}`,children:f(j.objectiveAchieved)})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j.nextAppointment?a.jsxs("div",{className:"flex items-center space-x-1 text-sm text-green-600",children:[a.jsx(rs,{className:"h-4 w-4"}),a.jsx("span",{children:new Date(j.nextAppointment).toLocaleDateString("fr-FR")})]}):a.jsx("span",{className:"text-sm text-gray-400",children:"Aucun"})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsx("button",{onClick:()=>c(j),className:"text-blue-600 hover:text-blue-900",children:a.jsx(am,{className:"h-4 w-4"})})})]},j.id)})})]})})}),o&&a.jsx(y,{followUp:o,onClose:()=>c(null)})]})},bk=()=>{const{patients:t,injections:e,followUps:n,appointments:r,user:s,configuration:i}=gt(),[o,c]=Y.useState({start:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[u,d]=Y.useState("overview"),f={patients:t.filter(E=>(s==null?void 0:s.role)==="admin"||E.doctorId===(s==null?void 0:s.id)),injections:e.filter(E=>{const v=new Date(E.date)>=new Date(o.start)&&new Date(E.date)<=new Date(o.end),p=(s==null?void 0:s.role)==="admin"||E.doctorId===(s==null?void 0:s.id);return v&&p}),followUps:n.filter(E=>{const v=new Date(E.date)>=new Date(o.start)&&new Date(E.date)<=new Date(o.end),p=(s==null?void 0:s.role)==="admin"||E.doctorId===(s==null?void 0:s.id);return v&&p}),appointments:r.filter(E=>{const v=new Date(E.date)>=new Date(o.start)&&new Date(E.date)<=new Date(o.end),p=(s==null?void 0:s.role)==="admin"||E.doctorId===(s==null?void 0:s.id);return v&&p})},g=()=>{const E=f.patients.length,v=f.injections.length,p=f.followUps.length,I=f.appointments.length,b=new Set(f.injections.map(X=>X.patientId)).size,_=v>1?Math.round((new Date(o.end).getTime()-new Date(o.start).getTime())/(1e3*60*60*24)/v):0,x=f.followUps.filter(X=>X.objectiveAchieved==="achieved").length,D=p>0?Math.round(x/p*100):0,L={male:f.patients.filter(X=>X.gender==="male").length,female:f.patients.filter(X=>X.gender==="female").length,other:f.patients.filter(X=>X.gender==="other").length},B=f.patients.length>0?Math.round(f.patients.reduce((X,$)=>{const q=new Date().getFullYear()-new Date($.dateOfBirth).getFullYear();return X+q},0)/f.patients.length):0;return{totalPatients:E,totalInjections:v,totalFollowUps:p,totalAppointments:I,injectedPatients:b,averageInjectionInterval:_,successRate:D,genderStats:L,averageAge:B}},y=()=>i.products.map(v=>{const p=f.injections.filter(b=>b.product===v),I=p.reduce((b,_)=>b+_.muscles.reduce((x,D)=>x+D.dosage,0),0);return{product:v,injections:p.length,totalDosage:I,averageDosage:p.length>0?Math.round(I/p.length):0}}).filter(v=>v.injections>0),j=()=>i.diagnoses.map(v=>{const p=f.patients.filter(b=>b.diagnosis===v),I=f.injections.filter(b=>{const _=f.patients.find(x=>x.id===b.patientId);return(_==null?void 0:_.diagnosis)===v});return{diagnosis:v,patients:p.length,injections:I.length,averageInjectionsPerPatient:p.length>0?Math.round(I.length/p.length*10)/10:0}}).filter(v=>v.patients>0),k=()=>i.muscles.map(v=>{const p=f.injections.filter(b=>b.muscles.some(_=>_.muscleId===v.id)),I=f.injections.reduce((b,_)=>{const x=_.muscles.filter(D=>D.muscleId===v.id);return b+x.reduce((D,L)=>D+L.dosage,0)},0);return{muscle:v.name,region:v.region,injections:p.length,totalDosage:I,averageDosage:p.length>0?Math.round(I/p.length):0}}).filter(v=>v.injections>0).sort((v,p)=>p.injections-v.injections),C=()=>i.postInjectionEvents.map(v=>{const p=f.injections.filter(I=>I.postInjectionEvents.includes(v)).length;return{event:v,occurrences:p,percentage:f.injections.length>0?Math.round(p/f.injections.length*100):0}}).filter(v=>v.occurrences>0).sort((v,p)=>p.occurrences-v.occurrences),V=(E,v)=>{if(E.length===0)return;const p=Object.keys(E[0]),I=[p.join(","),...E.map(D=>p.map(L=>`"${D[L]}"`).join(","))].join(`
`),b=new Blob([I],{type:"text/csv;charset=utf-8;"}),_=document.createElement("a"),x=URL.createObjectURL(b);_.setAttribute("href",x),_.setAttribute("download",`${v}_${new Date().toISOString().split("T")[0]}.csv`),_.style.visibility="hidden",document.body.appendChild(_),_.click(),document.body.removeChild(_)},T=g(),S=y(),N=j(),R=k(),A=C(),O=({title:E,value:v,subtitle:p,icon:I})=>a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:E}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v}),p&&a.jsx("p",{className:"text-sm text-gray-500",children:p})]}),a.jsx("div",{className:"p-3 rounded-full bg-blue-100",children:I})]})});return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Rapports et statistiques"}),a.jsx("p",{className:"text-gray-600",children:"Analyse de l'activité et export des données"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Période d'analyse"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de début"}),a.jsx("input",{type:"date",value:o.start,onChange:E=>c(v=>({...v,start:E.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date de fin"}),a.jsx("input",{type:"date",value:o.end,onChange:E=>c(v=>({...v,end:E.target.value})),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Type de rapport"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{id:"overview",label:"Vue d'ensemble",icon:a.jsx(_h,{className:"h-5 w-5"})},{id:"products",label:"Produits",icon:a.jsx(ss,{className:"h-5 w-5"})},{id:"diagnosis",label:"Diagnostics",icon:a.jsx(gr,{className:"h-5 w-5"})},{id:"muscles",label:"Muscles",icon:a.jsx(Vs,{className:"h-5 w-5"})},{id:"events",label:"Événements",icon:a.jsx(gr,{className:"h-5 w-5"})},{id:"demographics",label:"Démographie",icon:a.jsx(Vs,{className:"h-5 w-5"})}].map(E=>a.jsxs("button",{onClick:()=>d(E.id),className:`flex items-center space-x-2 p-3 rounded-md border ${u===E.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:bg-gray-50"}`,children:[E.icon,a.jsx("span",{className:"font-medium",children:E.label})]},E.id))})]}),u==="overview"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(O,{title:"Patients totaux",value:T.totalPatients,icon:a.jsx(Vs,{className:"h-6 w-6 text-blue-600"})}),a.jsx(O,{title:"Injections réalisées",value:T.totalInjections,icon:a.jsx(ss,{className:"h-6 w-6 text-green-600"})}),a.jsx(O,{title:"Contrôles effectués",value:T.totalFollowUps,icon:a.jsx(gr,{className:"h-6 w-6 text-purple-600"})}),a.jsx(O,{title:"Taux de succès",value:`${T.successRate}%`,subtitle:"Objectifs atteints",icon:a.jsx(_h,{className:"h-6 w-6 text-yellow-600"})}),a.jsx(O,{title:"Âge moyen",value:`${T.averageAge} ans`,icon:a.jsx(Vs,{className:"h-6 w-6 text-purple-600"})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Répartition par sexe"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:T.genderStats.female}),a.jsx("div",{className:"text-sm text-gray-500",children:"Femmes"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:T.genderStats.male}),a.jsx("div",{className:"text-sm text-gray-500",children:"Hommes"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:T.genderStats.other}),a.jsx("div",{className:"text-sm text-gray-500",children:"Autre"})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{onClick:()=>V([T],"rapport_general"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(vs,{className:"h-4 w-4"}),a.jsx("span",{children:"Exporter CSV"})]})})]}),u==="products"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Utilisation des produits"}),a.jsxs("button",{onClick:()=>V(S,"rapport_produits"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(vs,{className:"h-4 w-4"}),a.jsx("span",{children:"Exporter CSV"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Produit"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Injections"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dosage total (UI)"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dosage moyen (UI)"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(E=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:E.product}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.injections}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.totalDosage}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.averageDosage})]},E.product))})]})})]}),u==="diagnosis"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Répartition par diagnostic"}),a.jsxs("button",{onClick:()=>V(N,"rapport_diagnostics"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(vs,{className:"h-4 w-4"}),a.jsx("span",{children:"Exporter CSV"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Diagnostic"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Patients"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Injections"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Moy. injections/patient"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(E=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:E.diagnosis}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.patients}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.injections}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.averageInjectionsPerPatient})]},E.diagnosis))})]})})]}),u==="muscles"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Utilisation des muscles"}),a.jsxs("button",{onClick:()=>V(R,"rapport_muscles"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(vs,{className:"h-4 w-4"}),a.jsx("span",{children:"Exporter CSV"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Muscle"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Région"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Injections"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dosage total (UI)"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dosage moyen (UI)"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map(E=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:E.muscle}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.region}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.injections}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.totalDosage}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.averageDosage})]},E.muscle))})]})})]}),u==="events"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Événements post-injection"}),a.jsxs("button",{onClick:()=>V(A,"rapport_evenements"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(vs,{className:"h-4 w-4"}),a.jsx("span",{children:"Exporter CSV"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Événement"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Occurrences"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Pourcentage"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(E=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:E.event}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:E.occurrences}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:[E.percentage,"%"]})]},E.event))})]})})]}),u==="demographics"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Répartition par sexe"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{children:"Femmes"}),a.jsx("span",{className:"font-medium",children:T.genderStats.female})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{children:"Hommes"}),a.jsx("span",{className:"font-medium",children:T.genderStats.male})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{children:"Autre"}),a.jsx("span",{className:"font-medium",children:T.genderStats.other})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Statistiques d'âge"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{children:"Âge moyen"}),a.jsxs("span",{className:"font-medium",children:[T.averageAge," ans"]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{children:"Patients totaux"}),a.jsx("span",{className:"font-medium",children:T.totalPatients})]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{onClick:()=>V([{femmes:T.genderStats.female,hommes:T.genderStats.male,autre:T.genderStats.other,age_moyen:T.averageAge,total_patients:T.totalPatients}],"rapport_demographie"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(vs,{className:"h-4 w-4"}),a.jsx("span",{children:"Exporter CSV"})]})})]})]})},Sk=()=>{const{configuration:t,updateConfiguration:e}=gt(),[n,r]=Y.useState("diagnoses");Y.useState(null);const[s,i]=Y.useState(""),[o,c]=Y.useState({name:"",region:"",side:"both"}),u=()=>{s.trim()&&(e({diagnoses:[...t.diagnoses,s.trim()]}),i(""))},d=A=>{e({diagnoses:t.diagnoses.filter(O=>O!==A)})},f=()=>{s.trim()&&(e({products:[...t.products,s.trim()]}),i(""))},g=A=>{e({products:t.products.filter(O=>O!==A)})},y=()=>{s.trim()&&(e({regions:[...t.regions,s.trim()]}),i(""))},j=A=>{e({regions:t.regions.filter(O=>O!==A)})},k=()=>{s.trim()&&(e({guidanceTypes:[...t.guidanceTypes,s.trim()]}),i(""))},C=A=>{e({guidanceTypes:t.guidanceTypes.filter(O=>O!==A)})},V=()=>{if(o.name.trim()&&o.region.trim()){const A={...o,id:Date.now().toString(),name:o.name.trim(),region:o.region.trim()};e({muscles:[...t.muscles,A]}),c({name:"",region:"",side:"both"})}},T=A=>{e({muscles:t.muscles.filter(O=>O.id!==A)})},S=()=>{s.trim()&&(e({postInjectionEvents:[...t.postInjectionEvents,s.trim()]}),i(""))},N=A=>{e({postInjectionEvents:t.postInjectionEvents.filter(O=>O!==A)})},R=[{id:"diagnoses",label:"Diagnostics"},{id:"muscles",label:"Muscles"},{id:"regions",label:"Régions"},{id:"products",label:"Produits"},{id:"guidance",label:"Types de guidage"},{id:"events",label:"Événements post-injection"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Paramètres"}),a.jsx("p",{className:"text-gray-600",children:"Configuration des listes et paramètres système"})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"-mb-px flex space-x-8",children:R.map(A=>a.jsx("button",{onClick:()=>r(A.id),className:`py-2 px-1 border-b-2 font-medium text-sm ${n===A.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:A.label},A.id))})}),n==="diagnoses"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Diagnostics disponibles"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:s,onChange:A=>i(A.target.value),placeholder:"Nouveau diagnostic...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:A=>A.key==="Enter"&&u()}),a.jsxs("button",{onClick:u,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Ajouter"})]})]}),a.jsx("div",{className:"space-y-2",children:t.diagnoses.map(A=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md",children:[a.jsx("span",{className:"text-gray-900",children:A}),a.jsx("button",{onClick:()=>d(A),className:"text-red-600 hover:text-red-800",children:a.jsx(wn,{className:"h-4 w-4"})})]},A))})]})]}),n==="muscles"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Muscles disponibles"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx("input",{type:"text",value:o.name,onChange:A=>c(O=>({...O,name:A.target.value})),placeholder:"Nom du muscle...",className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.jsxs("select",{value:o.region,onChange:A=>c(O=>({...O,region:A.target.value})),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Sélectionner région"}),t.regions.map(A=>a.jsx("option",{value:A,children:A},A))]}),a.jsxs("select",{value:o.side,onChange:A=>c(O=>({...O,side:A.target.value})),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"both",children:"Bilatéral"}),a.jsx("option",{value:"left",children:"Gauche uniquement"}),a.jsx("option",{value:"right",children:"Droit uniquement"})]}),a.jsxs("button",{onClick:V,className:"flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Ajouter"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Muscle"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Région"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Côté"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.muscles.map(A=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:A.name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A.region}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A.side==="both"?"Bilatéral":A.side==="left"?"Gauche":"Droit"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsx("button",{onClick:()=>T(A.id),className:"text-red-600 hover:text-red-800",children:a.jsx(wn,{className:"h-4 w-4"})})})]},A.id))})]})})]})]}),n==="regions"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Régions anatomiques"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:s,onChange:A=>i(A.target.value),placeholder:"Nouvelle région...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:A=>A.key==="Enter"&&y()}),a.jsxs("button",{onClick:y,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Ajouter"})]})]}),a.jsx("div",{className:"space-y-2",children:t.regions.map(A=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md",children:[a.jsx("span",{className:"text-gray-900",children:A}),a.jsx("button",{onClick:()=>j(A),className:"text-red-600 hover:text-red-800",children:a.jsx(wn,{className:"h-4 w-4"})})]},A))})]})]}),n==="products"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Produits disponibles"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:s,onChange:A=>i(A.target.value),placeholder:"Nouveau produit...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:A=>A.key==="Enter"&&f()}),a.jsxs("button",{onClick:f,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Ajouter"})]})]}),a.jsx("div",{className:"space-y-2",children:t.products.map(A=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md",children:[a.jsx("span",{className:"text-gray-900",children:A}),a.jsx("button",{onClick:()=>g(A),className:"text-red-600 hover:text-red-800",children:a.jsx(wn,{className:"h-4 w-4"})})]},A))})]})]}),n==="guidance"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Types de guidage"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:s,onChange:A=>i(A.target.value),placeholder:"Nouveau type de guidage...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:A=>A.key==="Enter"&&k()}),a.jsxs("button",{onClick:k,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Ajouter"})]})]}),a.jsx("div",{className:"space-y-2",children:t.guidanceTypes.map(A=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md",children:[a.jsx("span",{className:"text-gray-900",children:A}),a.jsx("button",{onClick:()=>C(A),className:"text-red-600 hover:text-red-800",children:a.jsx(wn,{className:"h-4 w-4"})})]},A))})]})]}),n==="events"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Événements post-injection"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("input",{type:"text",value:s,onChange:A=>i(A.target.value),placeholder:"Nouvel événement...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:A=>A.key==="Enter"&&S()}),a.jsxs("button",{onClick:S,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Ajouter"})]})]}),a.jsx("div",{className:"space-y-2",children:t.postInjectionEvents.map(A=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-md",children:[a.jsx("span",{className:"text-gray-900",children:A}),a.jsx("button",{onClick:()=>N(A),className:"text-red-600 hover:text-red-800",children:a.jsx(wn,{className:"h-4 w-4"})})]},A))})]})]})]})},jk=()=>{const{addUser:t}=gt(),[e,n]=Y.useState(!1),[r,s]=Y.useState({name:"",email:"",password:"",confirmPassword:"",role:"doctor"}),i=c=>{if(c.preventDefault(),r.password!==r.confirmPassword){alert("Les mots de passe ne correspondent pas");return}if(r.password.length<6){alert("Le mot de passe doit contenir au moins 6 caractères");return}t({name:r.name,email:r.email,role:r.role}),s({name:"",email:"",password:"",confirmPassword:"",role:"doctor"}),n(!1)},o=c=>{const{name:u,value:d}=c.target;s(f=>({...f,[u]:d}))};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des utilisateurs"}),a.jsx("p",{className:"text-gray-600",children:"Créer et gérer les comptes médecins"})]}),a.jsxs("button",{onClick:()=>n(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[a.jsx(Kt,{className:"h-4 w-4"}),a.jsx("span",{children:"Nouveau médecin"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Comptes existants"})}),a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-md",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(gl,{className:"h-8 w-8 text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Dr. Admin"}),a.jsx("p",{className:"text-sm text-gray-500",children:"admin@medical.com"})]})]}),a.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:"Administrateur"})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-md",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(gl,{className:"h-8 w-8 text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Dr. Martin"}),a.jsx("p",{className:"text-sm text-gray-500",children:"doctor@medical.com"})]})]}),a.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:"Médecin"})]})]})})]}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Créer un compte médecin"})}),a.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nom complet *"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx(gl,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"text",name:"name",required:!0,value:r.name,onChange:o,className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dr. Nom Prénom"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email *"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx(Mw,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"email",name:"email",required:!0,value:r.email,onChange:o,className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"email@medical.com"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mot de passe *"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx(wh,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"password",name:"password",required:!0,minLength:6,value:r.password,onChange:o,className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Minimum 6 caractères"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirmer le mot de passe *"}),a.jsxs("div",{className:"mt-1 relative",children:[a.jsx(wh,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),a.jsx("input",{type:"password",name:"confirmPassword",required:!0,value:r.confirmPassword,onChange:o,className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Répéter le mot de passe"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Rôle"}),a.jsxs("select",{name:"role",value:r.role,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"doctor",children:"Médecin"}),a.jsx("option",{value:"admin",children:"Administrateur"})]})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200",children:"Annuler"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",children:[a.jsx(Hc,{className:"h-4 w-4 mr-2 inline"}),"Créer le compte"]})]})]})]})})]})},Ak=()=>{const{user:t}=gt(),[e,n]=Y.useState("dashboard");if(!t)return a.jsx(gk,{});const r=()=>{switch(e){case"dashboard":return a.jsx(Wy,{});case"patients":return a.jsx("div",{className:"space-y-6",children:a.jsx(Ek,{})});case"appointments":return a.jsx(Ik,{});case"injections":return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{onClick:()=>n("injection-form"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Nouvelle injection"}),a.jsx("button",{onClick:()=>n("injection-list"),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Historique"})]}),e==="injections"&&a.jsx(Gy,{})]});case"injection-form":return a.jsx(Tk,{});case"injection-list":return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("button",{onClick:()=>n("injections"),className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:a.jsx("span",{children:"← Retour"})})}),a.jsx(Gy,{})]});case"follow-ups":return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex space-x-4",children:[a.jsx("button",{onClick:()=>n("follow-up-form"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Nouveau contrôle"}),a.jsx("button",{onClick:()=>n("follow-up-list"),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Historique"})]}),e==="follow-ups"&&a.jsx(Ky,{})]});case"follow-up-form":return a.jsx(Nk,{});case"follow-up-list":return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("button",{onClick:()=>n("follow-ups"),className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:a.jsx("span",{children:"← Retour"})})}),a.jsx(Ky,{})]});case"reports":return a.jsx(bk,{});case"settings":return a.jsx(Sk,{});case"user-management":return a.jsx(jk,{});default:return a.jsx(Wy,{})}};return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsx(yk,{}),a.jsxs("div",{className:"flex",children:[a.jsx(vk,{activeTab:e,onTabChange:n}),a.jsx("main",{className:"flex-1 p-6",children:r()})]})]})},kk=()=>a.jsx(sk,{children:a.jsx(Ak,{})});ax(document.getElementById("root")).render(a.jsx(Y.StrictMode,{children:a.jsx(kk,{})}));
